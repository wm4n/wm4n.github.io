<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Android Clean Architecture - ä»ç„¶å¥½ç”¨çš„æ¶æ§‹</title>
    <url>/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>å°å”¯åŠ å…¥ç•¶å‰çš„å…¬å¸å¾Œï¼Œä¸»è¦è² è²¬ä¸€æ¬¾ Android App çš„é–‹ç™¼ä»¥åŠç¶­è­·ï¼Œé‚£æ˜¯ä¸€æ¬¾ç›¸ç•¶æœ‰æ­·å²å¹´ä»£çš„ç”¢å“ï¼Œä»‹é¢æ˜¯è€å¼çš„é¢¨æ ¼ã€ä½¿ç”¨äº†è¨±å¤š deprecated çš„æŠ€è¡“ã€é€£å…§éƒ¨å•†å‹™é‚è¼¯ä¹Ÿéƒ½å¹¾ä¹å·²ç¶“ä¸å¯è€ƒäº†ï¼Œè¦ä¸æ˜¯ Google è¦æ±‚æ¯å¹´çš„æ›´æ–° Android Target SDK ç‰ˆæœ¬ï¼Œç›¸ä¿¡æœ‰è¨±å¤šéƒ¨ä»½æ‡‰è©²æ˜¯æœƒæ›´è€èˆŠã€‚å°å”¯é€²å…¬å¸æ²’å¤šä¹…å¾Œï¼Œæ©Ÿç·£å·§åˆå…§éƒ¨è¨­è¨ˆå¸«èˆ‡ä¼åŠƒæœ‰å° App æ”¹ç‰ˆçš„éœ€æ±‚ï¼Œæƒ³å°‡ç”¢å“æ”¹é€ æˆä¸€å€‹ä»‹é¢æ›´ç¾ä»£åŒ–ã€è³‡è¨Šæ¶æ§‹æ›´æœ‰æ¢ç†ã€ä»¥åŠç‚ºå°‡ä¾†è¦æ¨å‡ºçš„æ–°æœå‹™äº‹å…ˆé‹ªè·¯ï¼Œæ‰€ä»¥å°å”¯ä¹Ÿè¶æ­¤æ©Ÿæœƒï¼Œé‡å° App çš„è»Ÿé«”æ¶æ§‹é€²è¡Œäº†ä¸€æ¬¡å¾¹åº•çš„æ‰“æ‰é‡ç·´ã€‚<br><br/></p>
<h2 id="æ”¹ç‰ˆä¹‹å‰"><a href="#æ”¹ç‰ˆä¹‹å‰" class="headerlink" title="æ”¹ç‰ˆä¹‹å‰"></a>æ”¹ç‰ˆä¹‹å‰</h2><p>åŸå§‹ç‰ˆæœ¬çš„ Appï¼Œæ˜¯ä¸€æ¬¾é›†æ‰€æœ‰éœ€æ±‚æ–¼ä¸€èº«çš„é¾ç„¶å¤§ç‰©ï¼Œå…§å«å°‘èªªä¸Šç™¾ç¨®ä»¥ä¸Šçš„å¤§å°åŠŸèƒ½ï¼Œä½†æœ¬èº«å¯ä»¥èªªæ˜¯å¹¾ä¹æ²’æœ‰ç¨‹å¼æ¶æ§‹å¯è¨€ã€‚è©¦æƒ³ç•¶å¹´é€™æ¬¾ç”¢å“æ˜¯æ€éº¼é–‹å§‹çš„ï¼ˆä»¥ä¸‹å‡è¨­é€™æ¬¾ç”¢å“æ˜¯ä¸€å€‹é€šè¨ŠéŒ„ Appï¼‰ï¼š</p>
<p>2010å¹´ï¼Œç”¢å“ä¼åŠƒï¼šã€Œå—¨ï½ å…¬å¸æ‰“ç®—å°‡ç›®å‰ç·šä¸Šé‚£æ¬¾é€šè¨ŠéŒ„æœå‹™ï¼Œä¸Šæ¶åˆ°ç•¶å‰æ­£åœ¨æµè¡Œçš„æ‰‹æ©Ÿå¹³å°ï¼ˆAndroid &amp; iOSï¼‰ï¼Œæˆ‘å€‘æ‰“ç®—å…ˆåšè¯çµ¡äººçš„åŸºæœ¬åŠŸèƒ½â€¦ã€</p>
<p>ä¸€å¹´å¾Œï¼Œç”¢å“ä¼åŠƒï¼šã€Œä¹‹å‰ä¸Šæ¶çš„é‚£æ¬¾ Appï¼Œåæ‡‰ä¸éŒ¯ï¼Œæˆ‘å€‘æ‰“ç®—å°‡å®ƒèˆ‡ Facebook åšæ•´åˆâ€¦ã€</p>
<p>åŠå¹´å¾Œï¼Œç”¢å“ä¼åŠƒï¼šã€ŒåŠå¹´å‰ Facebook çš„æ•´åˆé —å—å¥½è©•ï¼Œæ‰€ä»¥æˆ‘å€‘å°‡å¦ä¸€å€‹é€šè¨ŠéŒ„æœå‹™åšæ•´åˆâ€¦ã€</p>
<p>â€¦<br><br/></p>
<p>æ¥è‘—ï¼Œæ›´å¤šçš„åŠŸèƒ½ä¸æ–·ä¸Šæ¶ï¼Œå³æ™‚ç·šä¸Šç‹€æ…‹ã€è¯çµ¡äººç›¸ç°¿ã€Instagram æ•´åˆï¼Œéœ€æ±‚ä¸€å€‹æ¥ä¸€å€‹çš„ä¾†</p>
<p>æœ€çµ‚ï¼Œé€™æ¬¾é€šè¨ŠéŒ„ App å°±è®Šæˆé€™æ¨£ï¼š</p>
<img src="/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/architecture1.svg" class="" title="Software Architecture History">
<br/>
<br/>

<p>åŠŸèƒ½éœ€æ±‚ä¸€å€‹æ¥ä¸€å€‹ï¼Œç•¶åˆçš„é–‹ç™¼äººå“¡å°±æ˜¯ä¸€å€‹å€‹ç–ŠåŠ ä¸Šå»ï¼Œä¸Šå±¤çš„åŠŸèƒ½é–‹ç™¼æ™‚ï¼Œç›´æ¥æˆ–é–“æ¥çš„ä½¿ç”¨åˆ°ä¸‹å±¤çš„åŠŸèƒ½ã€æœå‹™ã€æˆ–ä»‹é¢ç­‰ï¼Œé€ æˆå¼·çƒˆçš„è€¦åˆï¼Œå¦‚ä¸‹åœ–ï¼š</p>
<img src="/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/architecture2.svg" class="" title="Software Architecture Coupling">
<br/>
<br/>

<p>åœ–ç‰‡ä¸­ï¼Œè¯çµ¡äººçš„ç·šä¸Šç‹€æ…‹ä¾è³´ä¹‹å‰ Facebook æ•´åˆçš„ç¨‹å¼ï¼ŒFacebook åˆä¾è³´ä¸‹å±¤è¯çµ¡äººçš„åŸºæœ¬åŠŸèƒ½ï¼Œæ¯å€‹åŠŸèƒ½éƒ½æ˜¯å¦‚æ­¤çš„ç’°ç’°ç›¸æ‰£ï¼Œæ¯ä¸€æ¬¡ä¿®æ”¹ï¼Œéƒ½éœ€è¦ç¢ºå®šå°ä¸åŒåŠŸèƒ½çš„å½±éŸ¿ç¯„åœã€‚åˆ°æœ€å¾Œï¼ŒåŠŸèƒ½è¶Šåšè¶Šå¤šï¼›ç›¸ä¾æ€§å°±è¶Šä¸²è¶Šå¤§ï¼›å¾Œé¢æ¥æ‰‹çš„äººä¹Ÿè¶Šä¾†è¶Šç—›è‹¦ã€‚å¦‚æœæŸå¤©éœ€è¦æ‹”é™¤æŸå€‹åŠŸèƒ½ï¼Œæœƒæ‹‰å‡ºä¸€ä¸²ä¸²çš„ç›¸ä¾æ€§ï¼Œè®“æ•´å€‹éç¨‹å¹¾ä¹æ˜¯é›£ä»¥é ä¼°å·¥æ™‚ä»¥åŠé¢¨éšªç¨‹åº¦ã€‚ä¹Ÿå› å¦‚æ­¤ï¼Œç¨‹å¼ç¢¼ä¸­æœ‰éœ€å¤šçœ‹ä¼¼æ²’ç”¨åˆ°çš„ç¨‹å¼ç¢¼ï¼Œèª°ä¹Ÿä¸æ•¢ç§»é™¤ï¼Œå› ç‚ºå®ƒçš„ç¢ºæœ‰è¢«å¼•ç”¨ï¼Œä½†ä¸€å †å¼•ç”¨é»åˆç„¡æ³•ç¢ºèªåˆ°åº•å“ªäº›æ˜¯æœ‰ç”¨ï¼Œå“ªäº›æ˜¯ç„¡ç”¨çš„ã€‚æ­·å²æ‚ ä¹…çš„ç¨‹å¼ç¢¼ä¸­é€”å·²ç¶“ä¸çŸ¥é“ç¶“éå¹¾æ‰‹äº†ï¼Œè¨±å¤šçš„ç•¶åˆçš„åˆç†è¡Œç‚ºï¼Œç¾åœ¨å·²ç¶“è®Šæˆæ­·å²åŒ…è¢±ï¼Œåˆ°æ­¤åœ°æ­¥ï¼Œæ•´å€‹ App é‡æ–°è¨­è¨ˆå·²ç¶“æ˜¯å‹¢åœ¨å¿…è¡Œäº†ï¼</p>
<h2 id="ç†æƒ³æ¶æ§‹"><a href="#ç†æƒ³æ¶æ§‹" class="headerlink" title="ç†æƒ³æ¶æ§‹"></a>ç†æƒ³æ¶æ§‹</h2><p>è‡ªå¾æ”¹ç‰ˆè¦åŠƒç¢ºå®šå¾Œï¼Œå°å”¯å°±åœ¨å››è™•å°‹æ‰¾åˆé©çš„æ¶æ§‹ï¼Œæœ€å¾Œæ˜¯é¸ç”¨ <a href="https://github.com/android10">Frnando Cejasï¼ˆAndroid10ï¼‰</a> çš„ <a href="https://github.com/android10/Android-CleanArchitecture">Android Clean Architecture</a>ï¼ˆä»¥ä¸‹ç¨± Android10 æ¶æ§‹ï¼‰ã€‚å› ç‚ºæ˜¯å¹¾å¹´å‰é¸çš„æ¶æ§‹ï¼Œæ‰€ä»¥å°å”¯æ˜¯ç”¨ Java ç‰ˆçš„ï¼Œä½œè€…ä¹Ÿæœ‰ç§»æ¤ Kotlin ç‰ˆæœ¬ã€‚</p>
<p>Android10 æ¶æ§‹æœ‰å¹¾å€‹é‡é»åŠŸèƒ½ï¼Œå°æ–¼æ”¹é€ æ¶æ§‹ä¸Šæœ‰å¾ˆå¤§çš„å½±éŸ¿ï¼š</p>
<ol>
<li><p>æ˜ç¢ºçš„ç›¸ä¾æ€§è¨­è¨ˆ</p>
<p>é¦–å…ˆï¼Œé€™æ¶æ§‹ä¸Šçš„ç›¸ä¾æ€§è¨­è¨ˆä¸Šéå¸¸çš„ç°¡å–®ï¼š</p>
<img src="/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/architecture5.png" class="" title="Dependencies">

<ul>
<li><p>Entities æ˜¯å•†å‹™é‚è¼¯ä¸Šçš„æœ€åŸºç¤å…ƒä»¶ï¼Œä»¥é€šè¨ŠéŒ„é€™å€‹ App ä¾†èªªï¼ŒEntities å®šç¾©äº†è¯çµ¡äººçš„æ ¼å¼ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ POJO æ ¼å¼ï¼Œå¯ç”± Clean Architecture ä¸­çš„ Domain çœ‹å¾—å‡ºä¾†ï¼Œé€™æ˜¯å€‹ç´” Java libraryï¼Œé€£å° Android éƒ½æ²’æœ‰ç›¸ä¾ï¼Œåœ¨ App ä¸­æ‰€æœ‰è¡Œç‚ºéƒ½æ˜¯é‡å° Entities ä¾†åšæ“ä½œã€‚</p>
</li>
<li><p>æ¥è‘— Use cases å®šç¾©äº† Entities å¯ä»¥æœ‰ä»€éº¼æ¨£å¼çš„æ“ä½œï¼Œä¾‹å¦‚å–å¾—è¯çµ¡äººåˆ—è¡¨ã€è¯çµ¡äººè©³ç´°è³‡è¨Šã€æ–°å¢ã€åˆªé™¤ç­‰æ“ä½œã€‚</p>
</li>
<li><p>Presenter å‰‡æ˜¯å¯¦ä½œäº† App ä¸­çš„æ“ä½œé‚è¼¯ï¼Œä¸¦æŠŠ UI èˆ‡ uses cases ä¸²æ¥èµ·ä¾†ï¼Œå®ƒæœ¬èº«ä¸é™åˆ¶å°æ‡‰çš„ UI è¦å¦‚ä½•å‘ˆç¾ï¼Œåªè¦ç¬¦åˆ presenter å®šç¾©çš„è¦æ ¼ã€‚</p>
</li>
<li><p>æœ€å¾Œï¼ŒUI å¯¦ä½œäº†ç•«é¢è©²å¦‚ä½•å‘ˆç¾çµ¦ä½¿ç”¨è€…ï¼Œå®ƒå¿…é ˆç¬¦åˆ presenter å®šç¾©çš„è¦æ ¼ï¼Œä½†ä¸é™å®šæ–¹å¼ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯ Activityã€Fragmentã€Dialogã€ç”šè‡³æ˜¯ console ï¼ˆä¹Ÿè¨± debug ç”¨ï¼‰éƒ½èƒ½ä½¿ç”¨ã€‚</p>
<br/>
</li>
</ul>
</li>
<li><p>å·¥ä½œåˆ†æ˜çš„æ¶æ§‹</p>
<p>åœ¨ Android10 çš„ Clean Architecture è¦åŠƒäº†ä¸‰å€‹æ¨¡çµ„ï¼Œåˆ†åˆ¥æ˜¯ï¼š</p>
<img src="/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/architecture3.png" class="" title="Domain, Data and Presentation">

<ul>
<li><p>Domain åŒ…å«äº†æ‰€æœ‰å•†å‹™é‚è¼¯ä¸Šçš„åŸºç¤å…ƒä»¶èˆ‡äº’å‹•è¡Œç‚ºçš„å®šç¾©ï¼Œä¹Ÿå°±æ˜¯ Entitiesã€è³‡æ–™å±¤çš„ä»‹é¢æ¥å£ï¼Œä»¥åŠæä¾›çµ¦ Presentation æ¨¡çµ„çš„ Use casesã€‚å¸¸è¦‹çš„èª¤è§£æ˜¯ï¼Œé€™å€‹æ¨¡çµ„ä¸¦ä¸é™åˆ¶è³‡æ–™å±¤é¢è©²å¦‚ä½•å¯¦ä½œï¼Œä¹Ÿä¸ç®¡ Uses cases æœƒè¢«èª°ä½¿ç”¨ï¼Œå¦‚ä½•ä½¿ç”¨ã€‚</p>
</li>
<li><p>Data å¯¦éš›è™•ç†è³‡æ–™çš„ä¾†æºï¼Œè³‡æ–™è©²å¾å“ªè£¡ä¾†ã€è©²å¦‚ä½•è™•ç†ã€æ˜¯å¦è©²å¿«å–ç­‰ç­‰ã€‚åªè¦æœ€å¾Œå›å‚³çš„æ ¼å¼ç¬¦åˆ Domain çš„å®šç¾©ï¼Œè³‡æ–™å‰‡æ˜¯å¯ä»¥å¾å„å¼ä¾†æºè€Œä¾†ï¼Œåƒæ˜¯é›²ç«¯ã€è³‡æ–™åº«ã€æª”æ¡ˆã€å¿«å–ã€ç”šè‡³æ˜¯æ¨¡æ“¬æ•¸æ“šã€‚</p>
</li>
<li><p>Presentation è² è²¬å°‡ Uses cases çš„åŠŸèƒ½ï¼Œè½‰ç‚ºä»‹é¢æä¾›çµ¦ä½¿ç”¨è€…ã€‚</p>
<br/>
</li>
</ul>
</li>
<li><p>æ˜“æ›¿æ›çš„ presentation æ¨¡çµ„</p>
<p>Android10 çš„ Clean Architecture åœ¨ Presentation ä¸­ä½¿ç”¨çš„æ˜¯ MVPï¼š</p>
<img src="/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/architecture4.png" class="" title="What" alt="s MVP">

<p>å¦‚<a href="https://fernandocejas.com/blog/engineering/2014-09-03-architecting-android-the-clean-way/#presentation-layer">åŸä½œè€…æ‰€æ</a>ï¼ŒPresentation å±¤æ‰€ä½¿ç”¨çš„æ¶æ§‹ä¸æ‹˜ï¼Œå¯ä»¥æ˜¯ MVPï¼Œä¹Ÿå¯æ˜¯ MVC æˆ– MVVMï¼Œå”¯ä¸€ä¸€è‡´çš„åœ°æ–¹åªæœ‰æ˜¯éƒ½é€é Domain å±¤çš„ Use cases ä¾†èˆ‡è³‡æ–™åšäº’å‹•ã€‚</p>
<br/>
</li>
<li><p>reactive çš„è³‡æ–™æµå‘</p>
<p>Clean Architecture ä½¿ç”¨ RxJava ä¾†è¯ç¹«æ‰€æœ‰è³‡æ–™çš„æµå‹•ï¼Œæ‰€æœ‰ä¾†è‡ª data å±¤çš„è³‡æ–™éƒ½æ˜¯ä½¿ç”¨ <a href="http://reactivex.io/RxJava/javadoc/io/reactivex/Observer.html">Observer</a> åŒ…è£éã€‚RxJava æä¾›äº†ç›¸ç•¶å¤šä¾¿æ·çš„æ“ä½œï¼Œåƒæ˜¯ä¹‹å‰æéçš„ï¼Œ<a href="../RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/">åˆ©ç”¨ RxJava ä¾†æŠŠå¤šå€‹ API çµ„æˆä¸€å€‹çµæœ</a>ï¼Œæˆ–æ˜¯ç›£æ¸¬è³‡æ–™æ˜¯å¦æœ‰æ›´æ–°ï¼Œä¸¦åšå³æ™‚çš„ç•«é¢è™•ç†ã€‚</p>
<br/>

</li>
</ol>
<h2 id="æ›´æ–°çµæœ"><a href="#æ›´æ–°çµæœ" class="headerlink" title="æ›´æ–°çµæœ"></a>æ›´æ–°çµæœ</h2><p>åˆ©ç”¨ Clean Architecture é‡æ•´å¾Œï¼ŒåŸæœ¬é€šè¨ŠéŒ„çš„ App é‡æ§‹æ–°çš„æ¨£å¼ï¼š</p>
<img src="/Android-Clean-Architecture-%E4%BB%8D%E7%84%B6%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9E%B6%E6%A7%8B/architecture6.svg" class="" title="New architecture">
<br/>

<p>åŸæœ¬å †ç–Šçš„åŠŸèƒ½ï¼Œç¶“éé‡æ–°è¨­è¨ˆå¾Œï¼ŒDomain èˆ‡ Data çš„éƒ¨åˆ†è¢«å–å‡ºä¾†ï¼Œå‰©ä¸‹çš„å‰‡ä»¥å‚ç›´çš„æ–¹å¼æ’åœ¨ Domain å±¤ä¸Šï¼ŒåŸæœ¬ç›¸äº’å¼•ç”¨çš„ç›¸ä¾æ€§ï¼Œè®Šæˆåªå‘ä¸‹ç›¸ä¾ï¼ŒåŠŸèƒ½ä¹‹é–“çš„ä¾è³´ï¼Œä¹Ÿè®Šæˆéœ€é€é Domain é–“æ¥æä¾›ã€‚å¦‚æ­¤ä¸€ä¾†ï¼Œå„åŠŸèƒ½é–“çš„ä»‹é¢ä¹Ÿå¾—ä»¥è¢«æŠ½è±¡å‡ºä¾†ã€‚æ–°çš„æ¶æ§‹è®“åŸæœ¬çš„ App è®Šå¾—ï¼š</p>
<ol>
<li><p>ç›¸ä¾æ€§å¤§å¹…é™ä½ï¼Œå„åŠŸèƒ½ä»‹é¢è¢«æŠ½è±¡å¾Œï¼Œæ›´å®¹æ˜“é–‹ç™¼ã€ç¶­è­·èˆ‡æ¸¬è©¦ã€‚</p>
</li>
<li><p>Presentationã€Domain è·Ÿ Data åˆ‡åˆ†å¾Œï¼Œåˆ†å·¥æ–¹å¼ä¹Ÿæ›´å¤šå…ƒï¼Œå¾åŸæœ¬æŒ‰åŠŸèƒ½åˆ†å·¥çš„æ–¹å¼ï¼Œä¹‹å¾Œä¹Ÿèƒ½ä»¥ä¸åŒéšå±¤åˆ†å·¥ï¼Œæœ‰é»é¡ä¼¼å‰ç«¯èˆ‡å¾Œç«¯çš„åˆ†å·¥ã€‚</p>
</li>
<li><p>èˆ‡ä¼åŠƒè¦æ ¼æ›´å®¹æ˜“ç›¸äº’æ‡‰å°ã€‚Domain å±¤å…§çš„ Entities èˆ‡ Use cases å°æ‡‰äº†è¦æ ¼ä¸Šçš„å…ƒä»¶èˆ‡è¡Œç‚ºæ“ä½œã€‚</p>
</li>
</ol>
<p>æ–°æ¶æ§‹èŠ±äº†å°å”¯åœ˜éšŠå°‡è¿‘ä¸€å¹´çš„æ™‚é–“ï¼Œæ‰æŠŠæ‰€æœ‰åŠŸèƒ½é™¸çºŒç§»æ¤ï¼Œä¸­é€”é‚„ä¸æ–·æ”¶åˆ°éœ€æ±‚è®Šæ›´ï¼Œä½†é è‘— Clean Architecture æ¶æ§‹ä¸Šçš„å½ˆæ€§ï¼Œç§»æ¤ä¸Šæ¸›å°‘äº†å¾ˆå¤šå·¥æ™‚çš„æµªè²»ã€‚ä¾‹å¦‚éç¨‹ä¸­ï¼Œæœ‰ä¸€è®Šæ›´æ˜¯å°‡æ‰€åŸæœ¬ç›´æ¥é€é Retrofit ä½¿ç”¨ç·šä¸Š API çš„å­˜å–æœå‹™ï¼Œæ”¹ç”±é€é SDK ä¾†å­˜å–è³‡æ–™ï¼Œåœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œåªéœ€è¦ä¿®æ”¹ Data å±¤ä¸­å¦‚ä½•å­˜å–è³‡æ–™çš„æ–¹å¼ï¼ŒDomain èˆ‡ Presentation å…©å±¤å®Œå…¨ä¸éœ€è¦è®Šå‹•ã€‚é€™æ­£æ˜¯ Clean Architecture çš„å„ªå‹¢æ‰€åœ¨ï¼Œé›–ç„¶å‰›é–‹å§‹è³‡è¨Šæ¶æ§‹è¼ƒè¤‡é›œï¼Œä½†æ˜¯ç­‰å°ˆæ¡ˆæˆé•·åˆ°ä¸€å®šéšæ®µï¼Œæ‰€æœ‰è¾›è‹¦éƒ½æ˜¯é²æ—©èƒ½å›æ”¶çš„ï½<br><br/></p>
<p><strong>ç›¸é—œé€£çµï¼š</strong><a href="https://github.com/wm4n/Android-CleanArchitecture"><i class="fab fa-github"></i> Demo å°ˆæ¡ˆ</a><br><br/></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="fas fa-layer-group"></i> ç¨‹å¼æ¶æ§‹å°±æ˜¯æœ€é‡è¦åœ°ï½ -------------</p>
        </div>
    
</div>
<br/>
]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android, ç¨‹å¼æ¶æ§‹</tag>
      </tags>
  </entry>
  <entry>
    <title>Android Room Database ç«‹é¦¬ä¸Šæ‰‹å°±çœ‹é€™ç¯‡</title>
    <url>/Android-Room%20Database-%E7%AB%8B%E9%A6%AC%E4%B8%8A%E6%89%8B%E5%B0%B1%E7%9C%8B%E9%80%99%E7%AF%87/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>è‡ªå¾åœ˜éšŠé‡æ–°æ‰“é€ æ–° App é–‹å§‹ï¼Œå°å”¯å°±å››è™•æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç”¨çš„æ–°æŠ€è¡“ï¼ŒAndroid Jetpack ä¸­çš„ Room å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼ˆè©±èªªé‚£æ™‚å€™å¥½åƒé‚„ä¸æ˜¯ Part of Jetpackï¼‰ã€‚Room æ˜¯ Google å®˜æ–¹å‰å¹¾å¹´æ¨å‡ºä¾†çš„æŠ€è¡“ï¼Œå®˜æ–¹ä¹Ÿå»ºè­°é–‹ç™¼è€…ä½¿ç”¨ Room è€Œä¸ç›´æ¥ä½¿ç”¨ SQLite APIsã€‚å°å”¯çš„åœ˜éšŠç•¶ä¸‹å°±é–‹å§‹ä½¿ç”¨ Room ä¾†å–ä»£åŸæœ¬çš„ SQLite ç¨‹å¼ç¢¼ï¼Œç•¶ç„¶é€”ä¸­ä¸€å®šé‡åˆ°äº†ä¸å°‘å¤§å°å•é¡Œï¼Œä¹Ÿæ˜¯å°å”¯ç´€éŒ„é€™å¹¾ç¯‡çš„ä¸»å› ä¹‹ä¸€ï¼Œå¸Œæœ›é¿å…å†æœ‰äººæµªè²»æ™‚é–“åœ¨é€™äº›å•é¡Œä¸Šã€‚</p>
<div class="note success">
            <p>ï¼ˆå¦‚ä½•å¾ç¾æœ‰çš„ db æª”ä¾†å»ºç«‹åœ¨ 2.2 ç‰ˆ Room å·²æœ‰æ”¯æ´ï¼Œå¯æŸ¥çœ‹é€™ç¯‡<a href="https://developer.android.com/training/data-storage/room/prepopulate">å®˜æ–¹æ–‡ç« </a>ã€‚ç•¶åˆå°å”¯åœ˜éšŠä½¿ç”¨æ™‚å¯é‚„æ²’æœ‰ï¼Œé‚£æ™‚æ˜¯ä½¿ç”¨ <a href="https://github.com/humazed/RoomAsset">humazed/RoomAsset</a>ã€‚</p>
          </div>

<h2 id="å»ºç«‹-Room-DB"><a href="#å»ºç«‹-Room-DB" class="headerlink" title="å»ºç«‹ Room DB"></a>å»ºç«‹ Room DB</h2><p>è¦ä½¿ç”¨ Roomï¼Œé ˆå…ˆå®šç¾© database ä¸­è¦åŒ…å«å“ªäº› tableï¼Œè£¡é¢æœ‰å“ªäº›å‹•ä½œå¯ä»¥åŸ·è¡Œç­‰ï¼Œä¾‹ï¼š</p>
<figure class="highlight java"><figcaption><span>AppDatabase.java</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">@Database(entities = &#123;SearchHistoryEntity.class&#125;, version = 1)</span></span><br><span class="line"><span class="meta">@TypeConverters(&#123;RoomConverter.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AppDatabase</span> <span class="keyword">extends</span> <span class="title">RoomDatabase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> SearchHistoryDao <span class="title">searchHistoryDao</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Database(entities = &#123;SearchHistoryEntity.class&#125;, version = 1)</code> å®šç¾©é€™å€‹ database å…§å«æœ‰ä»€éº¼ tableï¼Œå’Œ table ä¸­æœ‰ä»€éº¼æ¬„ä½ã€‚</p>
<p><code>@TypeConverters(&#123;RoomConverter.class&#125;)</code> å®šç¾©ç•¶ Room é‡åˆ°ä¸èƒ½è­˜åˆ¥çš„é¡å‹ï¼Œè©²è¦å¦‚ä½•åšè½‰æ›ã€‚</p>
<p><code>SearchHistoryDao</code> å®šç¾© database æ”¯æ´ä»€éº¼é¡å‹çš„ database å‹•ä½œï¼Œåƒæ˜¯æ–°å¢ã€åˆªé™¤ã€è®€å–ï¼Œé€šå¸¸ä¸€å€‹å‹•ä½œå°±æ˜¯ä¸€å€‹ sqlite statementã€‚<br><br/></p>
<h2 id="å®šç¾©-Entity-è³‡æ–™"><a href="#å®šç¾©-Entity-è³‡æ–™" class="headerlink" title="å®šç¾© Entity è³‡æ–™"></a>å®šç¾© Entity è³‡æ–™</h2><p>Entity å°‡ç›¸é—œçš„è³‡æ–™æ¬„ä½åˆä½µåœ¨ä¸€èµ·ï¼Œè¦æ¯”æ“¬çš„è©±å¯ä»¥çœ‹åš sqlite ä¸­çš„ table row ã€‚å…ˆä¾†çœ‹ <code>SearchHistoryEntity.java</code>ï¼Œé€™å€‹ entity å®šç¾©äº†æœå°‹ç´€éŒ„çš„è³‡æ–™ï¼Œå…§å®¹å¾ˆç›´è¦ºçš„ã€‚é€™é‚Šæœ‰ç‰¹åœ°èˆ‰å‡ºä½¿ç”¨ä¸‰å€‹é sqlite primitive çš„æ¬„ä½ï¼š</p>
<figure class="highlight java"><figcaption><span>SearchHistoryEntity.java</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity(tableName = &quot;search_history&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchHistoryEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">TYPE</span> </span>&#123;</span><br><span class="line">    TYPE_ONE,</span><br><span class="line">    TYPE_TWO,</span><br><span class="line">    TYPE_THREE,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åƒæ˜¯ table ä¸­çš„ _id æ¬„ä½</span></span><br><span class="line">  <span class="meta">@PrimaryKey(autoGenerate = true)</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> uid;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// enum é¡å‹ï¼Œéœ€é€é Room converter ä¾†è½‰æ›ï¼Œå¾Œé¢æœƒæ¥å—</span></span><br><span class="line">  <span class="meta">@ColumnInfo(name = &quot;type&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> TYPE type;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸€èˆ¬ Stringï¼Œæ²’ä»€éº¼ç‰¹åˆ¥çš„</span></span><br><span class="line">  <span class="meta">@ColumnInfo(name = &quot;display_text&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String displayText;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€é JSON dictionary ä¾†æŠŠæ–‡å­—è·Ÿ Map äº’ç›¸è½‰æ›</span></span><br><span class="line">  <span class="meta">@ColumnInfo(name = &quot;query_string&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, String&gt; queryString;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ISO 8601 çš„æ—¥æœŸæ ¼å¼</span></span><br><span class="line">  <span class="meta">@ColumnInfo(name = &quot;date&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String date;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">SearchHistoryEntity</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">      TYPE type,</span></span></span><br><span class="line"><span class="function"><span class="params">      String displayText,</span></span></span><br><span class="line"><span class="function"><span class="params">      Map&lt;String, String&gt; queryString,</span></span></span><br><span class="line"><span class="function"><span class="params">      String date)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = type;</span><br><span class="line">    <span class="keyword">this</span>.displayText = displayText;</span><br><span class="line">    <span class="keyword">this</span>.queryString = queryString;</span><br><span class="line">    <span class="keyword">this</span>.date = date;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Getters and setters are required for Room to work.</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getUid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> uid;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUid</span><span class="params">(<span class="keyword">int</span> uid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.uid = uid;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> TYPE <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> type;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(TYPE type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = type;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDisplayText</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> displayText;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDisplayText</span><span class="params">(String displayText)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.displayText = displayText;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getQueryString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> queryString;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQueryString</span><span class="params">(Map&lt;String, String&gt; queryString)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.queryString = <span class="keyword">new</span> HashMap&lt;&gt;(queryString);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> date;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDate</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.date = date;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>

<h2 id="DAO-å®šç¾©è³‡æ–™æ“ä½œæ–¹å¼"><a href="#DAO-å®šç¾©è³‡æ–™æ“ä½œæ–¹å¼" class="headerlink" title="DAO å®šç¾©è³‡æ–™æ“ä½œæ–¹å¼"></a>DAO å®šç¾©è³‡æ–™æ“ä½œæ–¹å¼</h2><p>æœ‰äº†è³‡æ–™æ ¼å¼èˆ‡è½‰æ›æ–¹å¼ï¼Œæ¥è‘—éœ€è¦çš„å°±æ˜¯å®šç¾© DAO (Data Access Object)ï¼Œé€™æ­¥å°‡åŸæœ¬ sqlite ä¸­æœƒä½¿ç”¨çš„ sqlite statement è½‰ç‚º APIã€‚ä¾ç…§ Room çš„æ–¹å¼ï¼Œåªéœ€æŠŠ sqlite statement æ”¾åœ¨ annotation ä¸Šï¼š</p>
<figure class="highlight java"><figcaption><span>SearchHistoryDao.java</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SearchHistoryDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å–å¾—æ‰€æœ‰ Search History ç´€éŒ„ï¼Œä¾æ™‚é–“å…ˆå¾Œé †åºæ’åº</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Query(&quot;SELECT * FROM search_history order by timestamp desc&quot;)</span></span><br><span class="line">  Flowable&lt;List&lt;SearchHistoryEntity&gt;&gt; getAll();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å–å¾—æŸå¹¾ç­† Search History ç´€éŒ„ï¼Œä¾æ™‚é–“å…ˆå¾Œé †åºæ’åº</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Query(&quot;SELECT * FROM search_history WHERE uid IN (:ids) order by timestamp desc&quot;)</span></span><br><span class="line">  Flowable&lt;List&lt;SearchHistoryEntity&gt;&gt; getByIds(<span class="keyword">int</span>[] ids);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å–å¾—æŸç‰¹å®šé¡å‹çš„ Search History ç´€éŒ„ï¼Œä¾æ™‚é–“å…ˆå¾Œé †åºæ’åº</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Query(&quot;SELECT * FROM search_history WHERE type = :type order by timestamp desc&quot;)</span></span><br><span class="line">  Flowable&lt;List&lt;SearchHistoryEntity&gt;&gt; getByType(SearchHistoryEntity.TYPE type);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å–å¾—æŸç‰¹å®šé¡å‹çš„ Search History ç´€éŒ„ï¼ŒæŒ‡å®šæœ€å¤šå–å¾—çš„ç­†æ•¸ï¼Œä¾æ™‚é–“å…ˆå¾Œé †åºæ’åº</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Query(&quot;SELECT * FROM search_history WHERE type = :type order by timestamp desc LIMIT :limit&quot;)</span></span><br><span class="line">  Flowable&lt;List&lt;SearchHistoryEntity&gt;&gt; getByTypeWithLimit(SearchHistoryEntity.TYPE type, <span class="keyword">int</span> limit);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ–°å¢ Search History è‡³ Room</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Insert</span></span><br><span class="line">  Long[] insertAll(SearchHistoryEntity... searchHistories);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åˆªé™¤æŸç­† Search History</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Delete</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(SearchHistoryEntity searchHistory)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åˆªé™¤æ‰€æœ‰ Search History</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Query(&quot;DELETE FROM search_history&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">clearTable</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>

<h2 id="ä½¿ç”¨-Converter-ä¾†äº’æ›è³‡æ–™é¡å‹"><a href="#ä½¿ç”¨-Converter-ä¾†äº’æ›è³‡æ–™é¡å‹" class="headerlink" title="ä½¿ç”¨ Converter ä¾†äº’æ›è³‡æ–™é¡å‹"></a>ä½¿ç”¨ Converter ä¾†äº’æ›è³‡æ–™é¡å‹</h2><p>å¦‚æœè³‡æ–™ä¸­æœ‰ä½¿ç”¨åˆ°ä¸€äº›éåŸºæœ¬çš„è³‡æ–™é¡å‹ï¼Œåƒæ˜¯ Textã€Integerã€Numericã€Blob ç­‰ï¼Œå°±éœ€è¦ç”¨ Converter å”åŠ©è½‰æ›ç¨‹å¼ä¸­çš„ç‰©ä»¶åˆ° Room DB çš„è³‡æ–™çµæ§‹ï¼ˆä¸Šè¿°çš„é‚£å¹¾ç¨®ï¼‰ï¼Œä¾‹å¦‚èªªï¼Œç¨‹å¼ä¸­å¯èƒ½ç›´æ¥ä½¿ç”¨ Date ç‰©ä»¶ï¼Œä½†å¦‚æœè¦å­˜åˆ° Room DB å°±éœ€è¦è½‰æ›ç‚ºåƒ 2021-02-22T18:01Z çš„ Stringã€‚</p>
<p>ä¾†çœ‹çœ‹ RoomConverter.java æ€éº¼æ¨£æŠŠ Map è½‰ Json å­˜å…¥ã€Enum ç‰©ä»¶è½‰ç‚º int  å­˜å…¥ã€é‚„æœ‰ Date ç‰©ä»¶è½‰ç‚º ISO 8601 String å­˜å…¥ï¼š</p>
<figure class="highlight java"><figcaption><span>RoomConverter.java</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoomConverter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ISO_OFFSET_DATE_TIME;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å°‡ Map è½‰ç‚º Jsonï¼Œä¸¦å­˜å…¥ Room</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@TypeConverter</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">mapToJson</span><span class="params">(Map&lt;String, String&gt; params)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> JSONObject(params).toString();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŠŠ Json å¾ Room è®€å–å‡ºï¼Œä¸¦è½‰æ›ç‚º Map çµ¦ App ä½¿ç”¨</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@TypeConverter</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, String&gt; <span class="title">jsonToMap</span><span class="params">(String json)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (TextUtils.isEmpty(json)) &#123;</span><br><span class="line">      <span class="keyword">return</span> Collections.emptyMap();</span><br><span class="line">    &#125;</span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    Type type = <span class="keyword">new</span> TypeToken&lt;Map&lt;String, String&gt;&gt;() &#123;&#125;.getType();</span><br><span class="line">    <span class="keyword">return</span> gson.fromJson(json, type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŠŠ App ä¸­çš„ Enum ç‰©ä»¶è½‰ç‚º Room å¯æœç”¨çš„æ ¼å¼</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@TypeConverter</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">searchHistoryTypeToInt</span><span class="params">(SearchHistoryEntity.TYPE type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> type.ordinal();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŠŠ Room çš„è³‡æ–™è½‰ç‚º App å¯è­˜å¾—çš„ Enum ç‰©ä»¶</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@TypeConverter</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> SearchHistoryEntity.<span class="function">TYPE <span class="title">intToSearchHistoryType</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> SearchHistoryEntity.TYPE.values()[type];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŠŠ Room çš„ ISO 8601 çš„æ—¥æœŸå­—ä¸²è½‰ç‚º OffsetDateTime ç‰©ä»¶</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@TypeConverter</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> OffsetDateTime <span class="title">toOffsetDateTime</span><span class="params">(String offsetDateTime)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!TextUtils.isEmpty(offsetDateTime)) &#123;</span><br><span class="line">      <span class="keyword">return</span> OffsetDateTime.from(dateTimeFormatter.parse(offsetDateTime));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŠŠ OffsetDateTime ç‰©ä»¶è½‰ç‚º Room å¯æœç”¨çš„ ISO 8601 çš„æ—¥æœŸå­—ä¸²</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@TypeConverter</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">fromOffsetDateTime</span><span class="params">(OffsetDateTime dateTime)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dateTimeFormatter.format(dateTime);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>

<h2 id="è¨­å®š-sqlite-trigger"><a href="#è¨­å®š-sqlite-trigger" class="headerlink" title="è¨­å®š sqlite trigger"></a>è¨­å®š sqlite trigger</h2><p>ä»¥å¾€ç”¨ sqlite æ™‚ï¼Œå¸¸æœƒå®šç¾©ä¸€äº›è‡ªå‹•åŒ– trigger ä¾†èª¿æ•´è³‡æ–™å…§å®¹ï¼Œä½†æ˜¯æ›ä½œ Room å¾Œï¼Œä½¿ç”¨çš„æ–¹æ³•å°±æœ‰é»ä¸å¤ªä¸€æ¨£ã€‚æ–°çš„æ–¹å¼è¦å®šç¾©åœ¨ <code>AppDatabase.java</code> ä¸­ï¼Œæ’å…¥ callback åœ¨ DB å»ºç«‹æ™‚ç²å–é€šçŸ¥ä¸¦å»ºç«‹ triggerï¼š</p>
<figure class="highlight java"><figcaption><span>AppDatabase.java</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">@Database(entities = &#123;SearchHistoryEntity.class&#125;, version = 1)</span></span><br><span class="line"><span class="meta">@TypeConverters(&#123;RoomConverter.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AppDatabase</span> <span class="keyword">extends</span> <span class="title">RoomDatabase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> SearchHistoryDao <span class="title">searchHistoryDao</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AppDatabase <span class="title">getAppDatabase</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">      RoomDatabase.Builder&lt;AppDatabase&gt; builder =</span><br><span class="line">          Room.databaseBuilder(context.getApplicationContext(), AppDatabase.class, <span class="string">&quot;userdata&quot;</span>);</span><br><span class="line">      builder.addCallback(callback);</span><br><span class="line">      sInstance = builder.build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sInstance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯åˆ©ç”¨ callback å–å¾— DB å»ºç«‹çš„æ™‚æ©Ÿï¼Œåœ¨å»ºç«‹æ™‚ä¸€ä½µå»ºç«‹ trigger</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Callback callback =</span><br><span class="line">      <span class="keyword">new</span> Callback() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(<span class="meta">@NonNull</span> SupportSQLiteDatabase db)</span> </span>&#123;</span><br><span class="line">          <span class="keyword">super</span>.onCreate(db);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// æœ€å¤šä¿ç•™ 200 ç­†æœå°‹ç´€éŒ„ï¼Œæ¯ç•¶æœ‰æ–°æœå°‹ç´€éŒ„æ–°å¢ï¼Œå°±åˆªé™¤ 200 ç­†å¾Œçš„è³‡æ–™</span></span><br><span class="line">          db.execSQL(</span><br><span class="line">              <span class="string">&quot;CREATE TRIGGER IF NOT EXISTS truncate_search_history AFTER INSERT ON search_history BEGIN &quot;</span></span><br><span class="line">                  + <span class="string">&quot;delete from search_history where timestamp &lt; &quot;</span></span><br><span class="line">                  + <span class="string">&quot;    (select timestamp from search_history order by timestamp desc limit 1 offset 200);&quot;</span></span><br><span class="line">                  + <span class="string">&quot;END;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(<span class="meta">@NonNull</span> SupportSQLiteDatabase db)</span> </span>&#123;</span><br><span class="line">          <span class="keyword">super</span>.onOpen(db);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>

<h2 id="å¿ƒå¾—"><a href="#å¿ƒå¾—" class="headerlink" title="å¿ƒå¾—"></a>å¿ƒå¾—</h2><p>å°å”¯åœ˜éšŠé–‹å§‹ä½¿ç”¨ Room æ™‚ï¼Œé‚£æ™‚æŠ€è¡“é‚„å¾ˆæ–°ï¼Œå¾ˆå¤šåŠŸèƒ½æ”¯æ´ä¸æ˜¯å¾ˆå®Œå–„ï¼Œåƒæ˜¯ä¸æ”¯æ´ prepolutate è³‡æ–™åº«ã€‚ä½†é€™äº›æ—¥å­ä¸‹ä¾†ï¼Œå¯ä»¥çœ‹åˆ° Room çš„æ”¯æ´åº¦è¶Šä¾†è¶Šå¥½ï¼Œä¸ä½†åŠ å…¥äº† Android Jetpackï¼Œæ›´æ–°ä¹Ÿå¾ˆé »ç¹ã€‚ä¸‹æ¬¡å°ˆæ¡ˆä¸Šå¦‚æœ‰éœ€è¦ï¼Œæ‡‰è©²é‚„æ˜¯æœƒæ¨è–¦åœ˜éšŠä½¿ç”¨ã€‚<br><br/></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-laugh-squint"></i> è©±èªªç‚ºä»€éº¼å«åš Roomï½ -------------</p>
        </div>
    
</div>
<br/>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android, Database, Room</tag>
      </tags>
  </entry>
  <entry>
    <title>Android å¦‚ä½•è¨­è¨ˆä½¿ç”¨ Adaptive Icon</title>
    <url>/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>Adaptive icon æ˜¯è‡ª Android 8 æ–°å¢çš„ App icon æŠ€è¡“ï¼Œæ”¯æ´ç›¸ç•¶å¤šæœ‰è¶£çš„ç‰¹æ•ˆï¼Œé›–ç„¶å®ƒå·²ç¶“ä¸Šå¸‚ä¸€æ®µæ™‚é–“ï¼Œä½†æ˜¯å¸‚é¢ä¸Šæ”¯æ´çš„ App ä»ç„¶ä¸å¤šï¼Œç•¶çœ‹åˆ°ä¸€å€‹ App icon ä¸å¤ªå°å‹æ™‚ï¼Œé‚£å¤§æ¦‚å°±æ˜¯æ²’æœª adaptive icon å»é‡èº«å®šåšã€‚å°å”¯çš„åœ˜éšŠé›–ç„¶å·²ç¶“ä¸æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œä½†æ˜¯æ¯éš”ä¸€é™£å­è«‹è¨­è¨ˆé‡ç•«æ–° icon æ™‚ï¼Œä¸€é–‹å§‹ç¸½æ˜¯æœƒæ”¶åˆ°ä¸ç¬¦åˆæ ¼å¼çš„åœ–æª”ï¼Œå°å”¯å†ä¸‰æ€è€ƒç‚ºä»€éº¼ï¼Œçµ‚æ–¼ç™¼ç¾é€™ä¸€åˆ‡æ‡‰è©²æ˜¯ Google çš„æ–‡ä»¶å•é¡Œ ğŸ˜‘ã€‚</p>
<p>æ¯æ¬¡å°å”¯é‡åˆ°ä¸åŒçš„è¨­è¨ˆï¼Œç¸½æ˜¯æŠŠ Android Developer ä¸Šé¢çš„ <a href="https://developer.android.com/guide/practices/ui_guidelines/icon_design_adaptive">adaptive icon</a> æ–‡ä»¶ä¸Ÿçµ¦è¨­è¨ˆï¼Œè«‹è¨­è¨ˆæä¾›åœ–æª”ï¼Œçµæœä¸æ˜¯æª”æ¡ˆæ±ç¼ºè¥¿å°‘ï¼Œå°±æ˜¯å¤§å°ä¸ç¬¦æ ¼å¼ï¼Œç›´åˆ°å¾Œä¾†ç™¼ç¾ï¼Œä¸€ä»½æ–‡ä»¶ï¼Œåå€‹è¨­è¨ˆå°±ç®—æ²’æœ‰åç¨®ï¼Œä¹Ÿæœ‰å…«ç¨®è§£è®€æ–¹å¼ï¼Œæ‰€ä»¥å°å”¯æ±ºå®šè‡ªå·±å¯«ä¸€ä»½è¶…ç°¡æ˜“ guideline çµ¦è‡ªå®¶è¨­è¨ˆã€‚<br><br/></p>
<h2 id="1-æº–å‚™-Adaptive-Icon"><a href="#1-æº–å‚™-Adaptive-Icon" class="headerlink" title="1. æº–å‚™ Adaptive Icon"></a>1. æº–å‚™ Adaptive Icon</h2><h3 id="1-1-è¨­è¨ˆæä¾›"><a href="#1-1-è¨­è¨ˆæä¾›" class="headerlink" title="1.1 è¨­è¨ˆæä¾›"></a>1.1 è¨­è¨ˆæä¾›</h3><p>æä¾›å…©å€‹ SVG æ ¼å¼çš„ 108dp x 108dp åœ–æª”ï¼Œè®“å·¥ç¨‹ä½¿ç”¨ File &gt; New &gt; Vector Asset åŒ¯å…¥ï¼Œåˆ†åˆ¥ç”¨æ–¼å‰æ™¯åœ–å±¤ã€èˆ‡èƒŒæ™¯åœ–å±¤ï¼š</p>
<p><strong>å‰æ™¯åœ–</strong> å‘½åç‚º <code>ic_launcher_foreground.xml</code> ï¼ˆè—è‰²èƒŒæ™¯è‰²å¯¦éš›ä¸Šç‚ºé€æ˜è‰²ï¼‰ <img src="/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/vector_foreground.png" class="" width="324" height="324" title="å‰æ™¯åœ–"> </p>
<p><strong>èƒŒæ™¯åœ–</strong> å‘½åç‚º <code>ic_launcher_background.xml</code>  <img src="/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/vector_background.png" class="" width="324" height="324" title="èƒŒæ™¯åœ–"> </p>
<p>å…©å¼µåœ–éœ€è¦æ³¨æ„çš„é‡é»ç‚ºï¼š</p>
<ol>
<li><p>å…©å¼µåœ–å¿…é ˆç‚º 108dp x 108dp å¤§å°çš„åœ–æª”ï¼Œè®“å·¥ç¨‹æ”¾åœ¨ <code>res/drawable</code> è³‡æ–™å¤¾å…§</p>
</li>
<li><p>å‰æ™¯åœ–é™¤äº†ä¸»é¡Œç‰©å¤–ï¼Œå…¶é¤˜èƒŒæ™¯ç‚ºé€æ˜è‰²ã€‚æ‰€æœ‰éœ€è¦è·Ÿè‘—ä¸»é¡Œç‰©ä¸€èµ·ç§»å‹•çš„ç‰¹æ•ˆï¼Œéƒ½å¿…é ˆæ”¾åœ¨å‰æ™¯åœ–å…§</p>
</li>
<li><p>èƒŒæ™¯åœ–ä½¿ç”¨ä¸é€æ˜è‰²ç‚ºèƒŒæ™¯è‰²ï¼Œä»»ä½•ä¸å¸Œæœ›è·Ÿä¸»é¡Œä¸€èµ·ç§»å‹•çš„å…§å®¹ï¼Œæ”¾åœ¨èƒŒæ™¯åœ–ä¸­</p>
</li>
<li><p>æœ€å¸¸è¢«å¿½ç•¥çš„ä¸€é»ã€‚å…©å¼µåœ–ä¸­ï¼Œ<strong>æ‰€æœ‰å¯è¦–ç‰©ä»¶ï¼Œå¿…é ˆæ”¾åœ¨ä¸­é–“çš„ 72dp x 72dp ä¸­</strong>ï¼Œä¹Ÿå°±æ˜¯ã€ä¸è¦æ”¾å…§å®¹ç‰©åœ¨å››é‚Šçš„ 18dp ä¸­ã€ï¼ˆè¦ä¸ç„¶é¡¯ç¤ºæ™‚å°±æœƒè¢«æˆªæ‰ï¼‰</p>
<img src="/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/adaptive_icon_margin.svg" class="" width="452" height="452" title="Adaptive Icon Margin">
<br/>

</li>
</ol>
<h3 id="1-2-å·¥ç¨‹æä¾›"><a href="#1-2-å·¥ç¨‹æä¾›" class="headerlink" title="1.2 å·¥ç¨‹æä¾›"></a>1.2 å·¥ç¨‹æä¾›</h3><p>åœ¨ <code>res/mipmap-anydpi-v26</code> è³‡æ–™å¤¾ä¸‹ï¼Œæº–å‚™å…©å€‹ xml æª”æ¡ˆï¼š</p>
<ol>
<li><p><code>ic_launcher.xml</code></p>
</li>
<li><p><code>ic_launcher_round.xml</code></p>
</li>
</ol>
<p>å…§å®¹éƒ½æ”¾å…¥ç›¸åŒçš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">adaptive-icon</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">background</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/ic_launcher_background&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">foreground</span> <span class="attr">android:drawable</span>=<span class="string">&quot;@drawable/ic_launcher_foreground&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">adaptive-icon</span>&gt;</span></span><br></pre></td></tr></table></figure>
<br/>

<p>Android ç³»çµ±æœƒè‡ªå‹•åœ¨ä¸åŒçš„ä½¿ç”¨è€…ä¸»é¡Œä½ˆæ™¯ä¸‹ï¼Œå¥—ä¸Šç›¸å°æ‡‰çš„é®ç½©ï¼š</p>
<img src="/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/adaptive_anim.gif" class="">

<h2 id="2-ç‚ºèˆŠç³»çµ±æº–å‚™-Icon"><a href="#2-ç‚ºèˆŠç³»çµ±æº–å‚™-Icon" class="headerlink" title="2. ç‚ºèˆŠç³»çµ±æº–å‚™ Icon"></a>2. ç‚ºèˆŠç³»çµ±æº–å‚™ Icon</h2><h3 id="2-1-æ–¹å½¢-Icon"><a href="#2-1-æ–¹å½¢-Icon" class="headerlink" title="2.1 æ–¹å½¢ Icon"></a>2.1 æ–¹å½¢ Icon</h3><p>è¨­è¨ˆæä¾› 5 å¼µå¤§å°åˆ†åˆ¥ç‚º <code>192px x 192px</code>ã€<code>144px x 144px</code>ã€<code>96px x 96px</code>ã€<code>72px x 72px</code>ã€<code>48px x 48px</code> çš„æ–¹å½¢åœ–ï¼š</p>
<img src="/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/5_rect_icons.png" class=""> 

<p>è®“å·¥ç¨‹å°‡æ¯å¼µåœ–æ”¾å…¥å°æ‡‰çš„è³‡æ–™å¤¾ä¸­ï¼š</p>
<p><code>192px x 192px</code> &gt; res/mipmap-xxxhdpi/ic_launcher.png</p>
<p><code>144px x 144px</code> &gt; res/mipmap-xxhdpi/ic_launcher.png</p>
<p><code>96px x 96px</code> &gt; res/mipmap-xhdpi/ic_launcher.png</p>
<p><code>72px x 72px</code> &gt; res/mipmap-xhdpi/ic_launcher.png</p>
<p><code>48px x 48px</code> &gt; res/mipmap-xhdpi/ic_launcher.png<br><br/></p>
<h3 id="2-2-åœ“å½¢-Icon"><a href="#2-2-åœ“å½¢-Icon" class="headerlink" title="2.2 åœ“å½¢ Icon"></a>2.2 åœ“å½¢ Icon</h3><p>å¦‚æ–¹å½¢ iconï¼Œè¨­è¨ˆæä¾› 5 å¼µå¤§å°åˆ†åˆ¥ç‚º <code>192px x 192px</code>ã€<code>144px x 144px</code>ã€<code>96px x 96px</code>ã€<code>72px x 72px</code>ã€<code>48px x 48px</code> çš„åœ“å½¢åœ–ï¼ˆåœ“è§’ç”¨é€æ˜è™•ç†ï¼‰ï¼š</p>
<img src="/Android-%E5%A6%82%E4%BD%95%E8%A8%AD%E8%A8%88%E4%BD%BF%E7%94%A8-Adaptive-Icon/5_rect_icons.png" class=""> 

<p>è®“å·¥ç¨‹å°‡æ¯å¼µåœ–æ”¾å…¥å°æ‡‰çš„è³‡æ–™å¤¾ä¸­ï¼š</p>
<p><code>192px x 192px</code> &gt; res/mipmap-xxxhdpi/ic_launcher_round.png</p>
<p><code>144px x 144px</code> &gt; res/mipmap-xxhdpi/ic_launcher_round.png</p>
<p><code>96px x 96px</code> &gt; res/mipmap-xhdpi/ic_launcher_round.png</p>
<p><code>72px x 72px</code> &gt; res/mipmap-xhdpi/ic_launcher_round.png</p>
<p><code>48px x 48px</code> &gt; res/mipmap-xhdpi/ic_launcher_round.png<br><br/></p>
<h2 id="å·¥ç¨‹éƒ¨ç½²"><a href="#å·¥ç¨‹éƒ¨ç½²" class="headerlink" title="å·¥ç¨‹éƒ¨ç½²"></a>å·¥ç¨‹éƒ¨ç½²</h2><p>å·¥ç¨‹éœ€åœ¨ App çš„ AndroidManifest.xml ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">  <span class="attr">...</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">...</span>&gt;</span></span><br></pre></td></tr></table></figure>
<br/>

<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="fas fa-icons"></i> ä¸å¤ªç‚ºäººæ‰€çŸ¥çš„ Adaptive Icon -------------</p>
        </div>
    
</div>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Android ç‰¹æ•ˆï¼šRemoteViews çš„æ‡‰ç”¨å’Œæ»¿æ»¿çš„å‘</title>
    <url>/Android-%E7%89%B9%E6%95%88%EF%BC%9ARemoteViews-%E7%9A%84%E6%87%89%E7%94%A8%E5%92%8C%E6%BB%BF%E6%BB%BF%E7%9A%84%E5%9D%91/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>å¦‚ä½•è®“ç³»çµ± UI ç•«å‡ºå®¢è£½åŒ–çš„ Viewï¼Œæ˜¯å°å”¯åœ˜éšŠæœ€è¿‘ä¸€ç›´åœ¨å¯¦é©—çš„ç©æ„ã€‚è¦åœ¨ Android ä¸Šé¢åšåˆ°ï¼Œå°±è¦ä½¿ç”¨ <a href="https://developer.android.com/reference/android/widget/RemoteViews">RemoteViews</a>ï¼Œé€šå¸¸ç¬¬ä¸€æ¬¡æ¥è§¸åˆ°çš„é–‹ç™¼è€…ï¼Œéƒ½æ˜¯ç¶“é Google æœå°‹å¦‚ä½•å¯¦ä½œæŸæ¨£æŸæ¨£åŠŸèƒ½ï¼Œæ‰é–“æ¥æ‰¾åˆ° RemoteViewsï¼Œç„¶å¾Œå°±é–‹å§‹ç…§è‘—æœå°‹çµæœå»åšï¼Œæ¥è‘—å°±é‡åˆ°è¨±è¨±å¤šå¤šå•é¡Œã€è¸©äº†å¾ˆå¤šå‘ï¼Œç„¶å¾Œå°±æ˜¯æ›´å¤šçš„ Google æœå°‹ï¼Œä¸æ–·çš„å¾ªç’°ã€‚å°å”¯çš„åœ˜éšŠä¹Ÿæ˜¯é€™æ¨£èµ°éä¾†ï¼Œæ‰€ä»¥ç‰¹åœ°æŠŠä¸€äº›ç¶“é©—è¨˜éŒ„ä¸‹ä¾†ã€‚<br><br/></p>
<h2 id="å®¢è£½åŒ–é€šçŸ¥è¨Šæ¯"><a href="#å®¢è£½åŒ–é€šçŸ¥è¨Šæ¯" class="headerlink" title="å®¢è£½åŒ–é€šçŸ¥è¨Šæ¯"></a>å®¢è£½åŒ–é€šçŸ¥è¨Šæ¯</h2><p>å°å”¯ä¸€é–‹å§‹ä¹Ÿæ˜¯ç‚ºäº†æ‰¾å¦‚ä½•å¯¦ä½œã€Œå®¢è£½åŒ–æ¨æ’­è¨Šæ¯çš„ UI æ¨£å¼ã€ï¼Œæ‰€ä»¥æ‰¾åˆ°äº† RemoteViewsï¼Œç›®æ¨™æ˜¯åœ¨æ”¶åˆ°æ¨æ’­è¨Šæ¯å¾Œï¼Œé¡¯ç¤ºä¸€å€‹æ¥å—æˆ–æ‹’çµ•ä¾†é›»çš„é€šçŸ¥ã€‚ç…§è‘—æœå°‹çµæœï¼Œå°å”¯çµ„å‡ºäº†é æœŸçš„ç•«é¢ï¼š</p>
<img src="/Android-%E7%89%B9%E6%95%88%EF%BC%9ARemoteViews-%E7%9A%84%E6%87%89%E7%94%A8%E5%92%8C%E6%BB%BF%E6%BB%BF%E7%9A%84%E5%9D%91/screen1.png" class="" width="320">

<p>å¦‚åœ–ç‰‡æ‰€ç¤ºï¼Œé»é¸ [Answer] å¯ä»¥æ¥é€šä¾†é›»ï¼Œ[Decline] å‰‡æ˜¯æ›æ–·ä¾†é›»ï¼Œå…©å€‹æŒ‰éˆ•éƒ½å¯ç›´æ¥é‹ä½œï¼Œè€Œä¸ç”¨é€éå¦ä¸€å€‹ä¾†é›»ä»‹é¢å»åšæ¥é€šæˆ–æ›æ–·ï¼Œé€™å°±æ˜¯ä¸€å€‹å…¸å‹å®¢è£½åŒ–é€šçŸ¥è¨Šæ¯çš„ä¸€å€‹ä¾‹å­ï¼Œè¦åšé€™ç¨®æ•ˆæœçš„é€šçŸ¥ï¼Œéœ€è¦æº–å‚™å¹¾æ¨£æ±è¥¿ï¼š</p>
<h3 id="1-é€šçŸ¥è¨Šæ¯é »é“"><a href="#1-é€šçŸ¥è¨Šæ¯é »é“" class="headerlink" title="1. é€šçŸ¥è¨Šæ¯é »é“"></a>1. é€šçŸ¥è¨Šæ¯é »é“</h3><p>   é¦–å…ˆï¼Œéœ€è¦ä¸€å€‹ç”¨ä¾†ç™¼é€é€šçŸ¥è¨Šæ¯çš„é »é“ï¼ˆ<a href="https://developer.android.com/training/notify-user/channels">Notification Channel</a>ï¼‰ã€‚å¾ Android 8 é–‹å§‹ï¼Œæ‰€æœ‰é€šçŸ¥è¨Šæ¯éƒ½è¦æœ‰ä¸€å€‹å°æ‡‰çš„ç™¼é€é »é“ï¼Œé€™äº›é »é“æœƒå‡ºç¾åœ¨ç³»çµ±è¨­å®šä¸­çš„ [App &amp; notifications] å…§ï¼Œå„åˆ¥çš„ App é€šçŸ¥è¨­å®šä¸­ï¼š</p>
   <img src="/Android-%E7%89%B9%E6%95%88%EF%BC%9ARemoteViews-%E7%9A%84%E6%87%89%E7%94%A8%E5%92%8C%E6%BB%BF%E6%BB%BF%E7%9A%84%E5%9D%91/screen2.png" class="" width="320">

<p>   é€éé€™ä»‹é¢ï¼Œä½¿ç”¨è€…å¯ä»¥å€‹åˆ¥å»é–‹é—œæŸå€‹é€šçŸ¥è¨Šæ¯ï¼Œæ‡‰è©²æ˜¯èªªå¯ä»¥æœ‰é™åº¦åœ°å»æ§åˆ¶è‡ªå·±å¦‚ä½•ã€Œè¢«ã€è¨Šæ¯é€šçŸ¥ã€‚ä½†å°å”¯è¦ºå¾—ï¼Œé€™è¨­è¨ˆé›–ç„¶ç«‹æ„è‰¯å¥½ï¼Œä½†æ˜¯ä¸€ä¾†æœƒè½å¯¦ä½¿ç”¨çš„é–‹ç™¼è€…ä¸å¤šï¼ˆèª°å®¶çš„ä¼åŠƒè¦æ ¼æœƒå¯«åˆ°é€™å€‹ï¼Ÿï¼‰ï¼ŒäºŒæ˜¯çŸ¥é“å¦‚ä½•é€²å…¥èª¿æ•´çš„ä½¿ç”¨è€…é‚£çœŸæ˜¯å°‘ä¹‹åˆå°‘ï¼Œå…©å€‹æ¯”ç‡ç›¸ä¹˜ä¸‹ï¼Œé€ æˆäº†é€™å€‹è¨­è¨ˆå¯¦éš›ä¸Šä¸å¤ªå…·æœ‰å¤ªå¤§æ„ç¾©ã€‚<br>   <br/></p>
<h3 id="2-æº–å‚™ä¸€å€‹-RemoteViews"><a href="#2-æº–å‚™ä¸€å€‹-RemoteViews" class="headerlink" title="2. æº–å‚™ä¸€å€‹ RemoteViews"></a>2. æº–å‚™ä¸€å€‹ RemoteViews</h3><p>   å®ƒå¯ä»¥é€éä¸€èˆ¬ inflate XML çš„æ–¹å¼ä¾†å»ºç«‹å‡ºä¾†ï¼Œã€Œå¤§å¤šæ•¸ã€è¦å‰‡å¦‚åŒä¸€èˆ¬åœ¨ App ä¸­ä½¿ç”¨ View ä¸€è‡´ï¼Œæ³¨æ„é€™è£¡å¯«å¤§å¤šæ•¸ï¼Œè¡¨ç¤ºå…¶ä¸­æœ‰å…ˆä¸ä¸€æ¨£çš„é™åˆ¶ï¼Œä¾‹å¦‚ï¼š<br>   <br/></p>
   <div class="note warning">
            <p>ä¸€è™Ÿå‘ï¼ä¸æ˜¯æ‰€æœ‰ Android View/ViewGroup éƒ½å¯ä»¥ä½¿ç”¨åœ¨ RemoteViews å…§ï¼</p>
          </div>
   <br/>

<p>   ä½¿ç”¨ä¸æ”¯æ´çš„ View/ViewGroupï¼Œé€šçŸ¥æœƒè·³ä¸å‡ºä¾†ï¼Œä½†æ²’æœ‰å¼·åˆ¶é—œé–‰æç¤ºï¼Œéœ€è¦çœ‹èƒŒæ™¯ log æ‰çŸ¥é“ç™¼ç”Ÿä»€éº¼äº‹ ğŸ˜†ã€‚<a href="https://developer.android.com/guide/topics/appwidgets/index.html#CreatingLayout">&gt;&gt; æ”¯æ´çš„ View/ViewGroup æ¸…å–®å¯ä»¥çœ‹é€™ &lt;&lt;</a><br>   <br/></p>
   <div class="note warning">
            <p>äºŒè™Ÿå‘ï¼XML layout ä¸­ä¸èƒ½ä½¿ç”¨ App theme çš„åƒæ•¸ï¼</p>
          </div>
   <br/>

<p>   å¦‚æœä½¿ç”¨åˆ° App theme ä¸­çš„åƒæ•¸ï¼ˆe.g. background å¼•ç”¨åˆ° theme å…§å®¹ <code>android:background=&quot;?attr/colorPrimary&quot;</code>ï¼‰ï¼Œé€šçŸ¥ä¹Ÿæ˜¯æœƒè·³ä¸å‡ºä¾†ï¼Œä½†æ²’æœ‰å¼·åˆ¶é—œé–‰æç¤ºï¼Œçœ‹èƒŒæ™¯ log æœƒç™¼ç¾å ±éŒ¯èªª view ç„¡æ³•è¢«å»ºç«‹ï¼Œå¦‚ä¸‹ï¼š<br>   <br/></p>
   <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">E StatusBar: android.view.InflateException: Binary XML file line #2: Binary XML file line #2: Error inflating class android.widget.RelativeLayout</span><br><span class="line">E StatusBar: Caused by: android.view.InflateException: Binary XML file line #2: Error inflating class android.widget.RelativeLayout</span><br><span class="line">E StatusBar: Caused by: java.lang.reflect.InvocationTargetException</span><br><span class="line">E StatusBar: 	at java.lang.reflect.Constructor.newInstance0(Native Method)</span><br><span class="line">E StatusBar: 	at java.lang.reflect.Constructor.newInstance(Constructor.java:343)</span><br><span class="line">   </span><br></pre></td></tr></table></figure>
   <br/>

<p>   é€™æ˜¯å¯é æœŸçš„ï¼Œå› ç‚ºå…¶ä»– process ç„¡å¾å¾—çŸ¥ App theme çš„è¨­å®šç‚ºä½•ã€‚é›–ç„¶ä¸èƒ½ç”¨ themeï¼Œä½†æ˜¯ä¸€èˆ¬çš„ <code>resources_name-qualifier</code> ä»æ˜¯å¯ä»¥ä½¿ç”¨ï¼ˆä¹Ÿæ˜¯åˆç†å¯é æœŸï¼Œç•¢ç«Ÿæˆ‘å€‘é‚„æ˜¯è¦ç”¨ qualifier ä¾†è¨­å®šå¯¬é«˜ç­‰çš„è¨­å®šï¼‰ã€‚é€™ä¹Ÿé–“æ¥åœ°è®“å°å”¯é‡åˆ°äº†ç¬¬ä¸‰å€‹å‘ï¼š<br>   <br/></p>
   <div class="note warning">
            <p>ä¸‰è™Ÿå‘ï¼å³ä½¿çš„ App ä¸æ”¯æ´é»‘æš—æ¨¡å¼ï¼Œæˆ‘å€‘é‚„æ˜¯è¦ç‚º RemoteViews æº–å‚™é»‘æš—æ¨¡å¼ã€‚</p>
          </div>
   <br/>

<p>   æ—¢ç„¶è·‘åœ¨ä»–äººçš„ process ä¸­ï¼ŒæŒ‰ç…§äººå®¶çš„è¦çŸ©ä¾†é¡¯ç¤ºå‘ˆç¾ä¹Ÿæ˜¯æ‡‰è©²çš„ï¼Œè¨­å®š <code>-night</code> è³‡æºä¾†ä¾ç…§ç›®å‰çš„æ¨¡å¼ä¾†å‘ˆç¾ï¼Œæ‰ä¸æœƒé€ æˆåœ¨é»‘æš—æ¨¡å¼ä¸­é¡¯ç¤ºç™½åº•æˆ–ä¸€èˆ¬æ¨¡å¼ä¸­é¡¯ç¤ºé»‘åº•çš„å°·å°¬çª˜å¢ƒï¼Œåƒä¸‹é¢é€™å¼µç•«é¢ï¼Œé»‘è‰²çš„å®¢è£½åŒ–è¨Šæ¯åœ¨ç™½è‰²ä½ˆæ™¯ä¸Šï¼š<br>   <br/></p>
   <img src="/Android-%E7%89%B9%E6%95%88%EF%BC%9ARemoteViews-%E7%9A%84%E6%87%89%E7%94%A8%E5%92%8C%E6%BB%BF%E6%BB%BF%E7%9A%84%E5%9D%91/screen3.png" class="" width="320">
   <br/>

<p>   ä»¥ä¸‹æ˜¯ XML å…¨æ–‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:background</span>=<span class="string">&quot;@color/custom_notification_background&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:padding</span>=<span class="string">&quot;16dp&quot;</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/icon&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentTop</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentStart</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/avatar&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;48dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;48dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentTop</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentEnd</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/title&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:ellipsize</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fontFamily</span>=<span class="string">&quot;sans-serif&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:maxLines</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textColor</span>=<span class="string">&quot;@color/custom_notification_text&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentTop</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/icon&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_toStartOf</span>=<span class="string">&quot;@id/avatar&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/text&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:ellipsize</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fontFamily</span>=<span class="string">&quot;sans-serif&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:maxLines</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textColor</span>=<span class="string">&quot;@color/custom_notification_text&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_below</span>=<span class="string">&quot;@id/title&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_toEndOf</span>=<span class="string">&quot;@id/icon&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentStart</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_below</span>=<span class="string">&quot;@id/text&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentStart</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_alignParentEnd</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:id</span>=<span class="string">&quot;@+id/button_decline&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_decline&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:fontFamily</span>=<span class="string">&quot;sans-serif&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:text</span>=<span class="string">&quot;Decline&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:textColor</span>=<span class="string">&quot;@color/white&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:id</span>=<span class="string">&quot;@+id/button_accept&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_accept&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:fontFamily</span>=<span class="string">&quot;sans-serif&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:text</span>=<span class="string">&quot;Answer&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:textColor</span>=<span class="string">&quot;@color/white&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-æº–å‚™æŒ‰éˆ•è¡Œç‚º"><a href="#3-æº–å‚™æŒ‰éˆ•è¡Œç‚º" class="headerlink" title="3. æº–å‚™æŒ‰éˆ•è¡Œç‚º"></a>3. æº–å‚™æŒ‰éˆ•è¡Œç‚º</h3><p>   é€éå®¢è£½åŒ–çš„é€šçŸ¥è¨Šæ¯ï¼Œä½¿ç”¨è€…æœ‰ä¸‰å€‹å‹•ä½œå¯ä»¥åŸ·è¡Œï¼Œé»é¸ [Answer]ã€é»é¸ [Decline]ã€æˆ–æ˜¯é»é¸è¨Šæ¯æœ¬èº«ï¼Œæ‰€ä»¥å°å”¯é€™ä¸‰å€‹å‹•ä½œæº–å‚™äº†ä¸‰å€‹ <a href="https://developer.android.com/reference/android/app/PendingIntent">PendingIntent</a>ï¼Œå·²æ­£å¼ç·šä¸Šç”¢å“ä¾†çœ‹ï¼Œä¸‰å€‹å‹•ä½œæ‡‰è©²åˆ†åˆ¥å°æ‡‰åˆ°æ¥é€šé›»è©±ã€æ›æ–·é›»è©±ã€å’Œé€²å…¥ä¾†é›»ä»‹é¢ï¼Œè®“ä½¿ç”¨è€…çœ‹æ›´å¤šè¨Šæ¯ï¼Œå†æ±ºå®šæ˜¯å¦è¦æ¥é€šé›»è©±ã€‚ä»¥ä¸‹æ˜¯å°å”¯å»ºç«‹é€šçŸ¥è¨Šæ¯çš„ç¨‹å¼ç¢¼èˆ‡æ¯å€‹æ­¥é©Ÿå°æ‡‰è¨»è§£ï¼š</p>
   <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">showCustomHeadsUpNotification</span><span class="params">(context: <span class="type">Context</span>, message: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">val</span> notificationManager =</span><br><span class="line">    context.getSystemService(Context.NOTIFICATION_SERVICE) <span class="keyword">as</span> NotificationManager</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. ç‚º Android 8+ æº–å‚™é€šçŸ¥é »é“</span></span><br><span class="line">  <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) &#123;</span><br><span class="line">    <span class="keyword">val</span> channel = NotificationChannel(</span><br><span class="line">      HEADS_UP_CHANNEL_ID,</span><br><span class="line">      HEADS_UP_CHANNEL_NAME,</span><br><span class="line">      NotificationManager.IMPORTANCE_HIGH</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¨­å®šé€šçŸ¥é »é“</span></span><br><span class="line">    channel.enableLights(<span class="literal">true</span>)</span><br><span class="line">    channel.enableVibration(<span class="literal">true</span>)</span><br><span class="line">    notificationManager.createNotificationChannel(channel)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. æº–å‚™ä¸€å€‹ RemoteViewsï¼Œä¹‹å¾Œç”¨åœ¨ setCustomHeadsUpContentView</span></span><br><span class="line">  <span class="keyword">val</span> headsUpRemoteView = RemoteViews(context.packageName, R.layout.heads_up_notification).apply <span class="symbol">RemoteViews@</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è¨­å®š RemoteView ä¸Šé¢é¡¯ç¤ºçš„è³‡è¨Š</span></span><br><span class="line">    setImageViewResource(R.id.icon, R.drawable.ic_round_call_24)</span><br><span class="line">    setImageViewResource(R.id.avatar, R.drawable.mom_avatar)</span><br><span class="line">    setTextViewText(R.id.title, context.getString(R.string.app_name))</span><br><span class="line">    setTextViewText(R.id.text, message)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.1 é»é¸ [Answer] æŒ‰éˆ•å¾Œï¼Œè¦åŸ·è¡Œçš„å‹•ä½œ</span></span><br><span class="line">    Intent().apply &#123;</span><br><span class="line">      flags = Intent.FLAG_ACTIVITY_SINGLE_TOP or Intent.FLAG_ACTIVITY_CLEAR_TOP</span><br><span class="line">      <span class="comment">// å±•ç¤º PendingIntent ç”¨ï¼å…ˆå°å» MainActivity ä¸¦é¡¯ç¤ºæŒ‡å®šè¨Šæ¯ </span></span><br><span class="line">      setClass(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">      putExtra(SNACK_BAR_MESSAGE, <span class="string">&quot;Answer call clicked&quot;</span>)</span><br><span class="line">      putExtra(TAG_NOTIFICATION_ID, HEADS_UP_NOTIFICATION_ID)</span><br><span class="line">      <span class="comment">// ç‚º [Answer] æŒ‰éˆ•è¨­å®š PendingIntent</span></span><br><span class="line">      <span class="keyword">this</span><span class="symbol">@RemoteViews</span>.setOnClickPendingIntent(</span><br><span class="line">        R.id.button_accept,</span><br><span class="line">        PendingIntent.getActivity(context, <span class="number">5001</span>, <span class="keyword">this</span>, PendingIntent.FLAG_UPDATE_CURRENT)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.2 é»é¸ [Decline] æŒ‰éˆ•å¾Œï¼Œè¦åŸ·è¡Œçš„å‹•ä½œ</span></span><br><span class="line">    Intent().apply &#123;</span><br><span class="line">      flags = Intent.FLAG_ACTIVITY_SINGLE_TOP or Intent.FLAG_ACTIVITY_CLEAR_TOP</span><br><span class="line">      <span class="comment">// å±•ç¤º PendingIntent ç”¨ï¼å…ˆå°å» MainActivity ä¸¦é¡¯ç¤ºæŒ‡å®šè¨Šæ¯ </span></span><br><span class="line">      setClass(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">      putExtra(SNACK_BAR_MESSAGE, <span class="string">&quot;Decline call clicked&quot;</span>)</span><br><span class="line">      putExtra(TAG_NOTIFICATION_ID, HEADS_UP_NOTIFICATION_ID)</span><br><span class="line">      <span class="comment">// ç‚º [Decline] æŒ‰éˆ•è¨­å®š PendingIntent</span></span><br><span class="line">      <span class="keyword">this</span><span class="symbol">@RemoteViews</span>.setOnClickPendingIntent(</span><br><span class="line">        R.id.button_decline,</span><br><span class="line">        PendingIntent.getActivity(context, <span class="number">5002</span>, <span class="keyword">this</span>, PendingIntent.FLAG_UPDATE_CURRENT)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.3 é»é¸ notification æœ¬èº«å¾Œï¼Œè¦åŸ·è¡Œçš„å‹•ä½œ</span></span><br><span class="line">  <span class="keyword">val</span> pendingIntent = Intent().let &#123;</span><br><span class="line">    it.flags = Intent.FLAG_ACTIVITY_SINGLE_TOP or Intent.FLAG_ACTIVITY_CLEAR_TOP</span><br><span class="line">    it.setClass(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">    it.putExtra(SNACK_BAR_MESSAGE, <span class="string">&quot;Notification clicked&quot;</span>)</span><br><span class="line">    it.putExtra(TAG_NOTIFICATION_ID, HEADS_UP_NOTIFICATION_ID)</span><br><span class="line">    PendingIntent.getActivity(context, <span class="number">5003</span>, it, PendingIntent.FLAG_UPDATE_CURRENT)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. è¨­å®šé€šçŸ¥è¨Šæ¯ï¼ˆé€™é‚Šæ³¨æ„ setStyle æ¨£å¼ï¼ŒæŸäº›æ¨£å¼æœƒæˆªæ‰ RemoteViewï¼‰</span></span><br><span class="line">  <span class="keyword">val</span> notification = NotificationCompat.Builder(context, HEADS_UP_CHANNEL_ID).let &#123;</span><br><span class="line">    it.setStyle(NotificationCompat.BigTextStyle())</span><br><span class="line">    NotificationCompat.Style</span><br><span class="line">    it.priority = NotificationCompat.PRIORITY_HIGH</span><br><span class="line">    it.color = ContextCompat.getColor(context, R.color.custom_notification_text)</span><br><span class="line">    it.setSmallIcon(R.drawable.ic_round_call_24)</span><br><span class="line">    it.setContentTitle(message)</span><br><span class="line">    it.setContentText(<span class="string">&quot;Tap to enter the dialing screen...&quot;</span>)</span><br><span class="line">    it.setCategory(NotificationCompat.CATEGORY_CALL)</span><br><span class="line">    it.setDefaults(NotificationCompat.DEFAULT_ALL)</span><br><span class="line">    it.setVibrate(longArrayOf(<span class="number">1000</span>, <span class="number">1000</span>))</span><br><span class="line">    it.setOngoing(<span class="literal">true</span>)</span><br><span class="line">    it.setAutoCancel(<span class="literal">false</span>)</span><br><span class="line">    it.setVisibility(NotificationCompat.VISIBILITY_PUBLIC)</span><br><span class="line">    it.setCustomHeadsUpContentView(headsUpRemoteView)</span><br><span class="line">    it.setFullScreenIntent(pendingIntent, <span class="literal">true</span>)</span><br><span class="line">    it.setContentIntent(pendingIntent)</span><br><span class="line">    it.build()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5. ä¸€åˆ‡å°±ç·’ï¼Œç™¼é€é€šçŸ¥</span></span><br><span class="line">  notificationManager.notify(</span><br><span class="line">    HEADS_UP_NOTIFICATION_ID,</span><br><span class="line">    notification</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-è¨­å®šé€šçŸ¥è¨Šæ¯"><a href="#4-è¨­å®šé€šçŸ¥è¨Šæ¯" class="headerlink" title="4. è¨­å®šé€šçŸ¥è¨Šæ¯"></a>4. è¨­å®šé€šçŸ¥è¨Šæ¯</h3><p>   æœ‰äº† RemoteViews å’Œ PendingIntent å®šç¾©çš„å‹•ä½œå¾Œï¼Œå°±å¯ä»¥ç”¨ <code>NotificationCompat.Builder</code> ä¾†æŠŠä¸€åˆ‡éƒ½æ¥èµ·ä¾†ï¼Œé€™é‚Šè¦æ³¨æ„ä½¿ç”¨çš„ styleï¼š<br>   <br/></p>
   <div class="note warning">
            <p>å››è™Ÿå‘ï¼æ…é¸ style æ¨£å¼ï¼Œè¦ä¸ç„¶ RemoteViews ç•«é¢å¾ˆå¯èƒ½è¢«æˆªæ‰ ğŸ˜­</p>
          </div>
   <br/>

<p>   å°å”¯é€™é‚Šé¸æ“‡çš„æ˜¯ <code>BigTextStyle</code>ï¼Œå› ç‚ºåœ¨çœ¾å¤šç¾æˆ Style ä¸­ï¼Œåªæœ‰é€™å€‹å‰›å¥½é©ç”¨ï¼Œåˆä¸æœƒæˆªæ‰ RemoteViews ç•«é¢ã€‚å…¶ä»–åƒæ˜¯ <code>DecoratedCustomViewStyle</code>ï¼Œå¯¦é©—ç™¼ç¾æœƒæŠŠ heads-up é€šçŸ¥çš„åº•éƒ¨çµ¦æˆªæ‰ï¼Œ<code>BigPictureStyle</code>ã€<code>InboxStyle</code>ã€<code>MessagingStyle</code> çš„æ‡‰ç”¨å‰‡ç›¸å°ä¸é©åˆä¾†é›»é€šçŸ¥ã€‚<br>   <br/></p>
<h3 id="5-ä¸€åˆ‡å°±ç·’ï¼Œç™¼é€é€šçŸ¥"><a href="#5-ä¸€åˆ‡å°±ç·’ï¼Œç™¼é€é€šçŸ¥" class="headerlink" title="5. ä¸€åˆ‡å°±ç·’ï¼Œç™¼é€é€šçŸ¥"></a>5. ä¸€åˆ‡å°±ç·’ï¼Œç™¼é€é€šçŸ¥</h3><p>   è¨˜å¾—å°‡ notification ID è¨˜éŒ„ä¸‹ä¾†ï¼Œä¹‹å¾Œå‹•ä½œåŸ·è¡Œå¾Œï¼Œè¦é‡å°ç´€éŒ„çš„ notification ID å»åš cancel çš„å‹•ä½œï¼Œå¦å‰‡ ongoing notification æœƒä¸€ç›´å­˜åœ¨æ–¼é€šçŸ¥åˆ—è£¡é¢ã€‚<br>   <br/></p>
<h2 id="æ›´å¤šé™åˆ¶"><a href="#æ›´å¤šé™åˆ¶" class="headerlink" title="æ›´å¤šé™åˆ¶"></a>æ›´å¤šé™åˆ¶</h2><p>RemoteViews å…¶å¯¦åœ¨ä¸åŒå» ç‰Œçš„æ‰‹æ©Ÿä¸Šï¼Œè¡Œç‚ºæˆ–é¡¯ç¤ºéƒ½æœƒæœ‰ä¸ç›¡ç›¸åŒçš„æ•ˆæœï¼Œåœ¨ä½¿ç”¨ä¸Šï¼Œéœ€è¦å¤šå¤šæ¸¬è©¦ä¸åŒå» ç‰Œï¼Œç”šè‡³ä¸åŒå‹è™Ÿçš„æ‰‹æ©Ÿã€‚èˆ‰ä¾‹ä¾†èªªï¼Œåœ¨å°ç±³æ‰‹æ©Ÿä¸Šï¼Œå°å”¯åœ˜éšŠå°±é‡åˆ°äº† heads-up çš„ç•«é¢è¢«æˆªæ‰ã€‚ç„¡å¥ˆæ˜¯ Android æ‰‹æ©Ÿå» ç‰Œã€å‹è™Ÿå¤šåˆ°æ•¸ä¸æ¸…ï¼Œå¯¦åœ¨è¦é©—ä¹Ÿé©—ä¸å®Œå•Šï½ï½ ğŸ˜­<br><br/></p>
<p><strong>ç›¸é—œé€£çµï¼š</strong><a href="https://github.com/wm4n/android-effect-demo"><i class="fab fa-github"></i> Demo å°ˆæ¡ˆ</a>, <a href="https://developer.android.com/guide/topics/appwidgets/index.html#CreatingLayout"><i class="fab fa-android"></i> RemoteViewes æ”¯æ´çš„å…ƒä»¶</a><br><br/></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-question-circle"></i> æœ‰æ¯” RemoteViews æ›´å¥½çš„é¸æ“‡å—ï¼Ÿ -------------</p>
        </div>
    
</div>
<br/>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Android ç‰¹æ•ˆï¼šå‹•æ…‹è®Šæ›´æ¨™ç±¤å…ƒä»¶(TabLayout)</title>
    <url>/Android-%E7%89%B9%E6%95%88%EF%BC%9A%E5%8B%95%E6%85%8B%E8%AE%8A%E6%9B%B4%E6%A8%99%E7%B1%A4%E5%85%83%E4%BB%B6-TabLayout/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>é›»è…¦å‰ï¼Œå°å”¯ä¸æ–·åœ°èª¿æ•´ç¨‹å¼ç¢¼ï¼Œé‡è¤‡ç·¨è­¯ï¼Œæª¢æŸ¥æ¨¡æ“¬å™¨ä¸Šçš„çµæœï¼Œä¸€æ•´å€‹ä¸Šåˆå°å”¯ä¸€ç›´åœ¨è©¦ä¸€å€‹ Android æ¨™ç±¤å…ƒä»¶çš„ç‰¹æ•ˆï¼ˆTab ç‰¹æ•ˆï¼‰- å‹•æ…‹æ–°å¢æ–°çš„æ¨™ç±¤é ï¼ŒåŠç§»é™¤ç¾æœ‰çš„æ¨™ç±¤é ã€‚é€™å•é¡Œå·²ç¶“å›°æ“¾å°å”¯ä¸€æ®µæ™‚é–“äº†ï¼ŒåŸæœ¬ä»¥ç‚ºæ˜¯å€‹å¾ˆç°¡å–®çš„æ•ˆæœï¼Œä¸€å€‹ä¸Šåˆçµ•å°å¯ä»¥æå®šï¼Œä½†å»åœ¨æœ€å¾Œä¸€æ­¥ï¼Œæ€éº¼è©¦æ•ˆæœéƒ½ä¸æ­£ç¢ºï¼Œæ¨™ç±¤é é›–ç„¶å¯ä»¥æ–°å¢æˆ–ç§»é™¤ï¼Œä½†æ¨™ç±¤é çš„å…§å®¹å»æ€ªæ€ªåœ°ã€‚<br><br/></p>
<h2 id="ç°¡å–®ã€æˆ–ä¸ç°¡å–®"><a href="#ç°¡å–®ã€æˆ–ä¸ç°¡å–®" class="headerlink" title="ç°¡å–®ã€æˆ–ä¸ç°¡å–®"></a>ç°¡å–®ã€æˆ–ä¸ç°¡å–®</h2><p>å°å”¯è¦æ±‚çš„è¦æ ¼å¾ˆç°¡å–®ï¼Œæº–å‚™ä¸€å€‹æ¨™ç±¤å…ƒä»¶ï¼Œé€éç¨‹å¼çš„æ–¹å¼ï¼Œå¯éš¨æ„æ·»åŠ æ–°æ¨™ç±¤é ï¼Œæˆ–ç§»é™¤ç¾æœ‰æ¨™ç±¤é ï¼ˆé™¤éåªå‰©ä¸‹ä¸€å€‹æ¨™ç±¤é ï¼‰ã€‚è¦æ ¼è½èµ·ä¾†å¾ˆç°¡å–®ï¼Œå°å”¯å¿ƒè£¡ç›¤é»è‘—ï¼šã€Œéœ€è¦ TabLayoutã€ViewPagerã€FragmentPagerAdapterâ€¦ã€ã€‚åœ˜éšŠä»¥å¾€ä½¿ç”¨æ¨™ç±¤å…ƒä»¶ï¼Œå¸¸å¸¸éƒ½æ˜¯å›ºå®šæ•¸é‡çš„æ¨™ç±¤é ï¼Œåªéœ€é€é FragmentPagerAdapter å®šç¾©æ¨™ç±¤é æ•¸é‡ã€æ¨™ç±¤åç¨±ã€å…§å®¹ç­‰ï¼Œå°±èƒ½é¡¯ç¤ºé æœŸçš„æ•ˆæœï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdatableTabAdapter</span></span>(fm: FragmentManager): FragmentPagerAdapter(</span><br><span class="line">  fm,</span><br><span class="line">  BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT</span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getCount</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span> <span class="comment">// ä¸‰å€‹æ¨™ç±¤é </span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItem</span><span class="params">(position: <span class="type">Int</span>)</span></span>: Fragment &#123;</span><br><span class="line">    <span class="comment">// å›å‚³æŒ‡å®šä½ç½®çš„æ¨™ç±¤é  Fragment</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†å¦‚æœè¦èƒ½æ”¯æ´æ–°å¢åˆªé™¤ï¼Œå°±ç¨å¾®è¤‡é›œä¸€é»ï¼Œä½†åªè¦æŠŠå›ºå®šæ¨™ç±¤é çš„å¯«æ³•ï¼Œæ”¹ç‚ºé€é MutableList ä¾†æ§åˆ¶æ¨™ç±¤é çš„æ•¸é‡ï¼Œæ‡‰è©²ä¹Ÿä¸æœƒå¤ªè¤‡é›œå§ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdatableTabAdapter</span></span>(fm: FragmentManager): FragmentPagerAdapter(</span><br><span class="line">  fm,</span><br><span class="line">  BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT</span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">val</span> tabs: MutableList&lt;<span class="built_in">Int</span>&gt; = mutableListOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getCount</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> tabs.size</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItem</span><span class="params">(position: <span class="type">Int</span>)</span></span>: Fragment &#123;</span><br><span class="line">    <span class="comment">// å›å‚³æŒ‡å®šä½ç½®çš„æ¨™ç±¤é  Fragment</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getPageTitle</span><span class="params">(position: <span class="type">Int</span>)</span></span>: CharSequence? &#123;</span><br><span class="line">    <span class="keyword">return</span> tabs[position].toString()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemId</span><span class="params">(position: <span class="type">Int</span>)</span></span>: <span class="built_in">Long</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> tabs[position].toLong()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çµæœå»ä¸å¦‚é æœŸ ğŸ˜«ï¼š</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/dKKFvtnAWHE" frameborder="0" loading="lazy" allowfullscreen></iframe></div>
<br/>

<h2 id="æ„æƒ³ä¸åˆ°çš„è§£æ±ºæ–¹æ¡ˆ"><a href="#æ„æƒ³ä¸åˆ°çš„è§£æ±ºæ–¹æ¡ˆ" class="headerlink" title="æ„æƒ³ä¸åˆ°çš„è§£æ±ºæ–¹æ¡ˆ"></a>æ„æƒ³ä¸åˆ°çš„è§£æ±ºæ–¹æ¡ˆ</h2><p>ä¸Šè¿°åšæ³•æ˜¯ï¼Œåªè¦åœ¨æ¨™ç±¤é ä¸Šé»é¸äº†æ–°å¢ç¬¦è™Ÿï¼Œå°±æœƒåœ¨å³é‚ŠåŠ ä¸€å€‹æ–°çš„æ¨™ç±¤é ã€‚åä¹‹ï¼Œé»é¸ç§»é™¤ç¬¦è™Ÿå‰‡ç§»é™¤æœ€å·¦é‚Šçš„æ¨™ç±¤é ï¼Œä½†æ€çŸ¥ç§»é™¤æ¨™ç±¤é å¾Œï¼Œå»å‡ºç¾äº†æ¨™ç±¤æ··äº‚çš„ç‹€æ…‹ï¼Œé€™æ˜¯å› ç‚º FragmentPagerAdapter ä¿å­˜äº†æ¨™ç±¤é ï¼Œä¸¦æ²’æœ‰åœ¨æ¯æ¬¡æ–°å¢ç§»é™¤å¾Œéƒ½é‡å»ºæ¨™ç±¤é ï¼Œå³ä½¿ä½¿ç”¨äº† <code>notifyDataSetChanged()</code> çµæœä¹Ÿæ˜¯ä¸€æ¨£ã€‚</p>
<p>ç¶“éä¸€å€‹ä¸Šåˆçš„åŠªåŠ›ï¼Œå°å”¯çµ‚æ–¼æ‰¾åˆ°äº†é—œéµåŸå› ï¼Œå°±æ˜¯åœ¨ PagerAdapter å…§çš„ getItemPositionï¼Œä»¥ä¸‹æ˜¯ PagerAdapter çš„å…§å®¹åŠèªªæ˜æ–‡ä»¶ï¼š</p>
<figure class="highlight java"><figcaption><span>PagerAdapter.java</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Called when the host view is attempting to determine if an item&#x27;s position</span></span><br><span class="line"><span class="comment"> * has changed. Returns &#123;<span class="doctag">@link</span> #POSITION_UNCHANGED&#125; if the position of the given</span></span><br><span class="line"><span class="comment"> * item has not changed or &#123;<span class="doctag">@link</span> #POSITION_NONE&#125; if the item is no longer present</span></span><br><span class="line"><span class="comment"> * in the adapter.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;The default implementation assumes that items will never</span></span><br><span class="line"><span class="comment"> * change position and always returns &#123;<span class="doctag">@link</span> #POSITION_UNCHANGED&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> object Object representing an item, previously returned by a call to</span></span><br><span class="line"><span class="comment"> *               &#123;<span class="doctag">@link</span> #instantiateItem(View, int)&#125;.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> object&#x27;s new position index from [0, &#123;<span class="doctag">@link</span> #getCount()&#125;),</span></span><br><span class="line"><span class="comment"> *         &#123;<span class="doctag">@link</span> #POSITION_UNCHANGED&#125; if the object&#x27;s position has not changed,</span></span><br><span class="line"><span class="comment"> *         or &#123;<span class="doctag">@link</span> #POSITION_NONE&#125; if the item is no longer present.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemPosition</span><span class="params">(<span class="meta">@NonNull</span> Object object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> POSITION_UNCHANGED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸä¾† PagerAdapter çš„é è¨­æ˜¯ POSITION_UNCHANGEDï¼Œé€™ä¹Ÿæ˜¯å‘Šè¨´è‡ªå·±ï¼Œé€™å€‹ä½ç½®ä¸Šçš„å…§å®¹æ²’æœ‰è®Šå–”ã€‚å°å”¯ç«‹åˆ»åœ¨ UpdatableTabAdapter class ä¸­è¦†è“‹é€™å€‹ functionï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemPosition</span><span class="params">(`<span class="keyword">object</span>`: <span class="type">Any</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> PagerAdapter.POSITION_NONE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡æ–°ç·¨è­¯ï¼Œæª¢æŸ¥æ¨¡æ“¬å™¨ï¼çµæœçœŸå¦‚é æœŸï¼Œä»»å‹™é”æˆï½ ğŸ‰ğŸ‰ğŸ‰<br><br/></p>
<p><strong>ç›¸é—œé€£çµï¼š</strong><a href="https://github.com/wm4n/android-effect-demo"><i class="fab fa-github"></i> Demo å°ˆæ¡ˆ</a><br><br/></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-question-circle"></i> ä¸‹æ¬¡æ”¹ç”¨ ViewPager2 å§ï½ -------------</p>
        </div>
    
</div>
<br/>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>Android ç‰¹æ•ˆï¼šåº•éƒ¨æ»‘å‡ºè¦–çª—</title>
    <url>/Android-%E7%89%B9%E6%95%88%EF%BC%9A%E5%BA%95%E9%83%A8%E6%BB%91%E5%87%BA%E8%A6%96%E7%AA%97/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>å°å”¯çš„è€é—†ï¼Œä»Šå¤©æ‹¿äº†è‡ªå·±çš„ iPhone æ‰‹æ©Ÿéä¾†ï¼Œå•é“ï¼šã€Œå¹«æˆ‘çœ‹çœ‹ï¼Œé€™æ˜¯æ€éº¼åšçš„ã€‚ã€å°å”¯æ¢éé ­å»ï¼Œè€é—†æ‰‹æ©Ÿä¸Šé–‹è‘— LINEï¼Œä¸€ç¯‡å°è©±è¦–çª—å…§ï¼Œå…¶ä¸­ä¸€å‰‡å°è©±å…§å®¹æ˜¯å€‹é€£çµ <code>line://app/1557539795-mrYlWQp7</code>ã€‚è€é—†é»äº†é€£çµï¼Œapp åº•éƒ¨è·³å‡ºä¸€å€‹ç¹ªåœ–å€ï¼Œçœ‹èµ·ä¾† LINE å¾ˆä¸æ­ï¼Œä¸åƒæ˜¯åŸç”Ÿçš„åŠŸèƒ½ï¼Œæ¥è‘—çœ‹è‘—è€é—†åœ¨ç¹ªåœ–å€ç•«äº†ç•«ï¼Œé»é¸é€å‡ºï¼Œå‰›ç•«å®Œçš„ä½œå“å°±è²¼åˆ°äº†å°è©±è¦–çª—å…§ ğŸ˜¦</p>
<img src="/Android-%E7%89%B9%E6%95%88%EF%BC%9A%E5%BA%95%E9%83%A8%E6%BB%91%E5%87%BA%E8%A6%96%E7%AA%97/screen.jpg" class="iPhone screen" width="400">
<br/>

<p>äº‹å¾Œä¸Šç¶²æŸ¥è©¢å¾Œï¼Œå°å”¯æ‰çŸ¥é“é€™æŠ€è¡“å«åš LIFFï¼Œä¸€å¥è©±ä¾†è§£é‡‹å°±æ˜¯è®“é–‹ç™¼è€…èƒ½é€é WebView èˆ‡ JavaScript ç­‰æŠ€è¡“èˆ‡ LINE app åšäº’å‹•ï¼Œç•¶ç„¶å¯¦éš›èƒŒå¾Œæœ‰æ›´å¤šæŠ€è¡“æˆåˆ†è®“äº’å‹•ä¸Šæ›´ä¾¿åˆ©èˆ‡å®‰å…¨ã€‚<br><br/></p>
<h2 id="å¦‚ä½•å¾åº•éƒ¨è·³å‡ºè¦–çª—"><a href="#å¦‚ä½•å¾åº•éƒ¨è·³å‡ºè¦–çª—" class="headerlink" title="å¦‚ä½•å¾åº•éƒ¨è·³å‡ºè¦–çª—"></a>å¦‚ä½•å¾åº•éƒ¨è·³å‡ºè¦–çª—</h2><p>åº•éƒ¨è·³å‡ºè¦–çª—ï¼Œé€™å€‹çœ‹ä¼¼ iOS é è¨­é¡¯ç¤ºé¸å–®çš„æ–¹å¼ï¼Œåœ¨ Android ä¸Šè¦å¦‚ä½•å¯¦ç¾å‘¢ï¼ŸğŸ¤” é€™æ‡‰è©²ä¸æ˜¯é è¨­ Dialog å°±èƒ½ç›´æ¥åšåˆ°çš„æ•ˆæœï¼Œå°å”¯é€™é‚Šé¸æ“‡ä½¿ç”¨ DialogFragmentï¼š</p>
<figure class="highlight kotlin"><figcaption><span>BottomDialogFragment.kt</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BottomDialogFragment</span> : <span class="type">DialogFragment</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> _binding : BottomDialogFragmentBinding? = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">val</span> binding <span class="keyword">get</span>() = _binding!!</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">    setStyle(</span><br><span class="line">      STYLE_NORMAL,</span><br><span class="line">      R.style.BottomDialogFragment</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    inflater: <span class="type">LayoutInflater</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">    container: <span class="type">ViewGroup</span>?,</span></span></span><br><span class="line"><span class="function"><span class="params">    savedInstanceState: <span class="type">Bundle</span>?</span></span></span><br><span class="line"><span class="function"><span class="params">  )</span></span>: View? &#123;</span><br><span class="line">    _binding = BottomDialogFragmentBinding.inflate(inflater, container, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">return</span> _binding?.viewRoot</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onViewCreated</span><span class="params">(view: <span class="type">View</span>, savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onViewCreated(view, savedInstanceState)</span><br><span class="line">    _binding?.webView?.loadUrl(<span class="string">&quot;https://wm4n.github.io&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroyView</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onDestroyView()</span><br><span class="line">    _binding = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>

<h3 id="Layout-æ¨£å¼"><a href="#Layout-æ¨£å¼" class="headerlink" title="Layout æ¨£å¼"></a>Layout æ¨£å¼</h3><p>ä»¥ä¸Šç¨‹å¼ç¢¼æ‡‰è©²å°±æ˜¯ DialogFragment çš„æ¨™æº–åšæ³•ï¼Œç¶²è·¯ä¸Šå¾ˆå¤šåŸºæœ¬ç¯„ä¾‹éƒ½æ˜¯é€™æ¨£ï¼Œå…¶ä¸­æœ‰å¹¾å€‹å°åœ°æ–¹ï¼Œç¶“éå°å”¯ç‰¹åˆ¥ä¿®æ”¹ï¼Œä»¥é”æˆé æœŸçš„æ•ˆæœã€‚</p>
<p>é¦–å…ˆï¼Œlayout çš„æ¨£å¼ï¼Œä¹Ÿå°±æ˜¯ <code>BottomDialogFragmentBinding</code> çš„å¯¦ä½œï¼ˆå› ç‚ºæ˜¯ DataBindingï¼Œæ‰€ä»¥å¯¦éš› xml åç¨±ç‚º bottom_dialog_fragment)ï¼š</p>
<figure class="highlight xml"><figcaption><span>bottom_dialog_fragment.xml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/view_root&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@android:color/transparent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.cardview.widget.CardView</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:id</span>=<span class="string">&quot;@+id/card_view&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_height</span>=<span class="string">&quot;350dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:elevation</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;12dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:cardBackgroundColor</span>=<span class="string">&quot;?colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:cardElevation</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:contentPaddingTop</span>=<span class="string">&quot;1dp&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">WebView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/web_view&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.cardview.widget.CardView</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é€™åœ¨ç•«é¢çš„ä¸‹æ–¹ï¼Œæ”¾ä¸€å€‹ CardViewï¼Œè£¡é¢åŒ…è‘—ä¸€å€‹ WebViewï¼Œç¯„ä¾‹ä½¿ç”¨ 350dp ä¾†ç•¶åº•éƒ¨é«˜åº¦ä¾†æ¨¡æ“¬ï¼Œå¯¦éš›ä¸Šæ‡‰è©²è¦æ˜¯ä¸€å€‹å¯æ§çš„åƒæ•¸ï¼Œå¦‚ä¸‹åœ–ï¼š</p>
<img src="/Android-%E7%89%B9%E6%95%88%EF%BC%9A%E5%BA%95%E9%83%A8%E6%BB%91%E5%87%BA%E8%A6%96%E7%AA%97/layout.png" class="layout">
<br/>

<h3 id="Style-æ¨£å¼"><a href="#Style-æ¨£å¼" class="headerlink" title="Style æ¨£å¼"></a>Style æ¨£å¼</h3><p>Style æ¨£å¼å¯èªªæ˜¯é€™æ•ˆæœçš„é‡é»ï¼Œä¹Ÿæ˜¯å°å”¯èŠ±è²»æœ€å¤šçš„æ™‚é–“åœ¨å˜—è©¦çš„éƒ¨åˆ†ï¼Œç¶²è·¯ä¸Šè³‡æºå¾ˆå°‘ï¼Œå®˜æ–¹æ–‡ä»¶èªªæ˜ä¹Ÿå¾ˆä¸å®¹æ˜“æ‡‚ï¼ŒåŠ ä¸Šå„å€‹è¨­å®šéœ€äº’ç›¸æ­é…ï¼Œçµ„åˆèµ·ä¾†æ•¸é‡å¯çœŸæ˜¯ä¸å°‘ï¼Œä»¥ä¸‹æ˜¯åœ¨ onCreate ä¸­å…ˆæŒ‡å®š style æ¨£å¼ï¼š</p>
<figure class="highlight kotlin"><figcaption><span>onCreate</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">  <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">  setStyle(</span><br><span class="line">    STYLE_NORMAL,</span><br><span class="line">    R.style.BottomDialogFragment</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–åœ¨ styles.xml ä¸­å®šç¾©å¯¦éš›çš„æ¨£å¼è¨­å®šï¼š</p>
<figure class="highlight xml"><figcaption><span>styles.xml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;BottomDialogFragment&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;android:Theme.Translucent.NoTitleBar&quot;</span>&gt;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:windowAnimationStyle&quot;</span>&gt;</span>@style/BottomDialogFragmentAnimation<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:windowTranslucentStatus&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:statusBarColor&quot;</span>&gt;</span>@android:color/transparent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:windowDrawsSystemBarBackgrounds&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;BottomDialogFragmentAnimation&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;@android:style/Animation.Activity&quot;</span>&gt;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:windowEnterAnimation&quot;</span>&gt;</span>@anim/slide_in_from_bottom<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:windowExitAnimation&quot;</span>&gt;</span>@anim/slide_out_to_bottom<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šæ˜¯å°å”¯æ¸¬è©¦éï¼Œæœ€å°‘ style æ¨£å¼è¨­å®šå…§ï¼Œå¯é”æˆæŒ‡å®šæ•ˆæœçš„ï¼Œæ¯è¡Œèªªæ˜å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>parent ç¹¼æ‰¿ <code>android:Theme.Translucent.NoTitleBar</code>ï¼Œç¢ºä¿ä½¿ç”¨é€æ˜èƒŒæ™¯æ™‚ï¼ŒåŒæ™‚ä¿ç•™ status bar (status äº‹æƒ…æ³ä¿ç•™ï¼Œå¦‚æœæœ¬èº« App ä¸­éš±è— status barï¼Œé€™é‚Šå¯ä»¥ä½¿ç”¨ <code>android:Theme.Translucent.NoTitleBar.Fullscreen</code>)</p>
</li>
<li><p><code>windowTranslucentStatus</code>ã€<code>statusBarColor</code>ã€<code>windowDrawsSystemBarBackgrounds</code> æ­é…ä¸€èµ·ä½¿ç”¨ï¼Œä¸‰å€‹è¨­å®šè®“ DialogFragment çš„ status bar è®Šæˆå®Œå…¨é€æ˜ï¼Œé€™è®“å‘ä¸Šç§»å‹•çš„å‹•ç•«æ•ˆæœä¸æœƒå‡ºç¾æ®˜å½±</p>
</li>
<li><p>slide å‹•ç•«åªæ˜¯å–®ç´”çš„ translation å¦‚ä¸‹</p>
 <figure class="highlight xml"><figcaption><span>slide_in_from_bottom.xml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:duration</span>=<span class="string">&quot;@android:integer/config_mediumAnimTime&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:interpolator</span>=<span class="string">&quot;@android:interpolator/linear&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromYDelta</span>=<span class="string">&quot;50%p&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toYDelta</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight xml"><figcaption><span>slide_out_to_bottom.xml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:duration</span>=<span class="string">&quot;@android:integer/config_mediumAnimTime&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:interpolator</span>=<span class="string">&quot;@android:interpolator/linear&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromYDelta</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toYDelta</span>=<span class="string">&quot;50%p&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<br/>

</li>
</ol>
<h2 id="åŸ·è¡Œèˆ‡é©—è­‰"><a href="#åŸ·è¡Œèˆ‡é©—è­‰" class="headerlink" title="åŸ·è¡Œèˆ‡é©—è­‰"></a>åŸ·è¡Œèˆ‡é©—è­‰</h2><p>æœ€å¾Œï¼Œè¦ä½¿ç”¨ DialogFragment ä¹Ÿæ˜¯ç›¸ç•¶å®¹æ˜“ï¼š</p>
<figure class="highlight kotlin"><figcaption><span>MainActivity.kt</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> f = BottomDialogFragment()</span><br><span class="line">f.show(supportFragmentManager, <span class="string">&quot;BottomDialogFragment&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/n1Fh-ZnZ7u8" frameborder="0" loading="lazy" allowfullscreen></iframe></div>
<br/>

<p><strong>ç›¸é—œé€£çµï¼š</strong><a href="https://github.com/wm4n/android-effect-demo"><i class="fab fa-github"></i> Demo å°ˆæ¡ˆ</a><br><br/></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-question-circle"></i> æˆ‘ä¸æ‡‚ styles.xml çš„è¨­å®šå•Šï½ -------------</p>
        </div>
    
</div>
<br/>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>App å‘½åèˆ‡å–å£è™Ÿçš„å“²å­¸</title>
    <url>/App-%E5%91%BD%E5%90%8D%E8%88%87%E5%8F%96%E5%8F%A3%E8%99%9F%E7%9A%84%E5%93%B2%E5%AD%B8/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>åœ¨ 2006ï¼Œä½œå®¶è‰¾çˆ¾ç‰¹èˆ‡å¥§æœ¬æµ·é»˜æ•™æˆï¼Œé€™å…©ä½é€²è¡Œäº†ä¸€é …æœ‰è¶£çš„å¯¦é©—ï¼Œä»–å€‘åˆ†æäº†ç´ç´„è­‰äº¤æ‰€å’Œç¾åœ‹è­‰äº¤æ‰€åœ¨ 1990 - 2004 å¹´é–“ï¼Œæ–°æ›ç‰Œä¸Šå¸‚çš„å…¬å¸è‚¡ç¥¨ã€‚å¯¦é©—ç™¼ç¾ï¼Œä¸€é–“å…¬å¸è‚¡ç¥¨çš„å‰›ä¸Šå¸‚åƒ¹æ ¼ï¼Œç«Ÿç„¶è·Ÿå®ƒä¸Šå¸‚çš„åç¨±ä»£è™Ÿæœ‰ç›¸é—œæ€§ã€‚å„˜ç®¡è‚¡ç¥¨çš„åƒ¹æ ¼å›é€æ¼¸å›æ­¸å¸‚å ´æ©Ÿåˆ¶ï¼Œä½†åç¨±è¼ƒå®¹æ˜“ç™¼éŸ³çš„å…¬å¸ï¼Œè‚¡åƒ¹è¡¨ç¾å„ªæ–¼é‚£äº›è¼ƒé›£ç™¼éŸ³çš„å…¬å¸ã€‚ä¾‹ï¼Œè‚¡ç¥¨ä»£è™Ÿ KAR åœ¨å‰›ä¸Šå¸‚çš„åŒæœŸï¼Œå°±å„ªæ–¼ä»£è™Ÿ RDO çš„è‚¡åƒ¹ï¼Œå‰è€…å¤§éƒ¨åˆ†æœ‰è‹±æ–‡åŸºç¤çš„äººï¼Œæ‡‰è©²éƒ½èƒ½å¾ˆç›´è¦ºåœ°å”¸å‡ºï¼Œä½†ç›¸å°å¾Œè€…ï¼Œå¤§å¤šæ•¸äººéƒ½æœƒå…ˆæ€è€ƒä¸€ä¸‹å®ƒçš„å”¸æ³•ã€‚<br><br/> </p>
<img src="/App-%E5%91%BD%E5%90%8D%E8%88%87%E5%8F%96%E5%8F%A3%E8%99%9F%E7%9A%84%E5%93%B2%E5%AD%B8/F1.large.jpg" class="ç´ç´„è­‰äº¤æ‰€ï¼Œè‚¡åƒ¹èˆ‡ä»£è™Ÿ">
<p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:grey;font-size: 11pt">ç´ç´„è­‰äº¤æ‰€ï¼Œè‚¡ç¥¨ä»£è™Ÿæ˜¯å¦æ˜“è®€èˆ‡ä¸Šå¸‚å¾Œçš„ä¸€å¤©ã€ä¸€é€±ã€å…­å€‹æœˆã€èˆ‡ä¸€å¹´å¾Œçš„è‚¡åƒ¹é—œä¿‚åœ–ï¼ˆAlter &amp; Oppenheimer, 2006ï¼‰</span><br><br/></p>
<img src="/App-%E5%91%BD%E5%90%8D%E8%88%87%E5%8F%96%E5%8F%A3%E8%99%9F%E7%9A%84%E5%93%B2%E5%AD%B8/F2.large.jpg" class="ç¾åœ‹è­‰äº¤æ‰€ï¼Œè‚¡åƒ¹èˆ‡ä»£è™Ÿ">
<p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:grey;font-size: 11pt">ç¾åœ‹è­‰äº¤æ‰€ï¼Œè‚¡ç¥¨ä»£è™Ÿæ˜¯å¦æ˜“è®€èˆ‡ä¸Šå¸‚å¾Œçš„ä¸€å¤©ã€ä¸€é€±ã€å…­å€‹æœˆã€èˆ‡ä¸€å¹´å¾Œçš„è‚¡åƒ¹é—œä¿‚åœ– ï¼ˆAlter &amp; Oppenheimer, 2006ï¼‰</span></p>
<p>ç”±ä»¥ä¸Šè­‰æ“šä¾†çœ‹ï¼Œäººå€‘åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæ™‚æ™‚åœ°å—åˆ°å…¶ä»–äººç‚ºç’°å¢ƒæ‰€å½±éŸ¿ã€‚<br><br/></p>
<h2 id="å¤§å¸«çš„å·¨ä½œ"><a href="#å¤§å¸«çš„å·¨ä½œ" class="headerlink" title="å¤§å¸«çš„å·¨ä½œ"></a>å¤§å¸«çš„å·¨ä½œ</h2><p>ç¾…ä¼¯ç‰¹Â·å¸­çˆ¾è¿ªå°¼æ˜¯è¡Œç‚ºå¿ƒç†å­¸çš„å¤§å¸«ï¼Œä»–æœ‰ä¸€æœ¬ã€Œé‹ªæ¢—åŠ›ã€çš„æ›¸ï¼Œå…¶ä¸­è¬›åˆ°ä¸€é»ï¼šå‘½åå…¶å¯¦ä¹Ÿæ˜¯ã€Œé‹ªæ¢—ã€çš„ä¸€ç¨®æ–¹å¼ï¼Œå…¶ä¸­ä»¥ã€Œè¼•é¬†ã€çš„æ–¹å¼å‘½åï¼Œå°±æœƒèµ·ç›¸ç•¶çš„ä½œç”¨ã€‚ä½œè€…èˆ‰ä¾‹ï¼Œåœ¨æ•¸é–“æœ‰åçš„å¾‹å¸«äº‹å‹™æ‰€ä¸­ï¼Œå§“åè¼ƒå¥½ç™¼éŸ³çš„å¾‹å¸«ï¼Œå—åˆ°çš„å§”è¨—ä¹Ÿæ˜¯é«˜æ–¼å§“åè¼ƒä¸æ˜“ç™¼éŸ³çš„å¾‹å¸«ã€‚å¯è¦‹äººå€‘çš„ç¬¬ä¸€ç›´è¦ºï¼Œé™¤äº†å¤–è§€å¤–ï¼Œè¼•é¬†å®¹æ˜“ç™¼éŸ³ï¼Œä¹Ÿå°ä½¿ç”¨è€…æœ‰ç›¸ç•¶çš„å¸å¼•æ•ˆæœï¼ˆäººé¡å¤§è…¦æ‡¶æƒ°çš„ç‰¹æ€§ ğŸ˜…ï¼‰ã€‚</p>
<p>åŒç†å¯ä»¥ç”¨åœ¨ App çš„å‘½åï¼Œåœ¨ä½¿ç”¨è€…é‚„æ²’ä½¿ç”¨åˆ°ç”¢å“ï¼Œå…‰åªè¦çœ‹åˆ° App Store æˆ– Play Store çš„ App åï¼Œå°±æœ‰å¯èƒ½å½±éŸ¿ä»–å€‘çš„æŠ‰æ“‡ã€‚<br><br/></p>
<h2 id="äººåŠ›éŠ€è¡Œçš„å‘½åèˆ‡å£è™Ÿ"><a href="#äººåŠ›éŠ€è¡Œçš„å‘½åèˆ‡å£è™Ÿ" class="headerlink" title="äººåŠ›éŠ€è¡Œçš„å‘½åèˆ‡å£è™Ÿ"></a>äººåŠ›éŠ€è¡Œçš„å‘½åèˆ‡å£è™Ÿ</h2><p>è€çš®æœ€è¿‘ç™¼ç¾å°ç£çš„æ•¸é–“äººåŠ›éŠ€è¡Œï¼Œç´›ç´›å°å…¶ç”¢å“ App é€²è¡Œäº†æ”¹ç‰ˆï¼Œè€çš®å°‡å„é–“çš„ç”¢å“å‘½åèˆ‡å£è™Ÿæ‹¿å‡ºï¼Œäº¤äº’æ¯”ä¸€æ¯”ï¼Œæ‰¾åˆ°äº†å…¶ä¸­ä¸€äº›æœ‰è¶£çš„é»ï¼š</p>
<img src="/App-%E5%91%BD%E5%90%8D%E8%88%87%E5%8F%96%E5%8F%A3%E8%99%9F%E7%9A%84%E5%93%B2%E5%AD%B8/1130_1.png" class="screenshot">

<ol>
<li><p>é¦–å…ˆï¼Œä»¥ã€Œè¼•é¬†é‹ªæ¢—ã€çš„æ–¹å¼ä¾†çœ‹ï¼Œã€Œ518ç†Šç­ - æ‰¾å·¥ä½œå¾ˆç°¡å–®ï¼ã€æ˜¯æ‰€ä»¥ app ä¸­åšå¾—æœ€å¥½çš„ï¼Œå…¶ä¸€æ˜¯åç¨±çŸ­è€Œç°¡æ½”ï¼Œä½¿ç”¨è€…å¯ä»¥åœ¨ä¸€å¥è©±ä¸­è®€å®Œï¼Œå®ƒä¸åƒå‰å¹¾å€‹ appï¼Œåç¨±åŠ å£è™Ÿéƒ½ç„¡æ³•é¡¯ç¤ºå®Œå…¨ã€‚å…¶äºŒæ˜¯ä¸­æ–‡ç‰¹æœ‰çš„æŠ¼éŸ»ï¼Œã€Œç­ã€èˆ‡ã€Œå–®ã€éƒ½æœ‰çµå°¾ã€Œã„¢ã€çš„éŸ³ï¼Œå”¸èµ·ä¾†å°±æ˜¯é †ï¼ˆå¯¦éš›å”¸å”¸å°±çŸ¥é“ï½ï¼‰ï¼Œæœ‰ç¨®å¤æ™‚ç‚ºäº†ä½¿è¨Šæ¯ç†å¿µçš„å‚³æ’­ï¼Œå°‡è¨Šæ¯ç·¨æˆæ­Œæ›²ç”¨å”±æ›´æœ‰æ•ˆæœã€‚  </p>
</li>
<li><p>æ‰¾å·¥ä½œæ˜¯ä½¿ç”¨è€…çš„ç›®çš„ï¼Œä¹Ÿæ˜¯ä»–å€‘ä¸‹è¼‰ app çš„ä¸»å› ï¼Œåœ¨å·¥ä½œèˆ‡æœªä¾†çš„ä¸ç¢ºå®šå› ç´ ä¸‹ï¼Œã€Œæ‰¾å·¥ä½œå¾ˆç°¡å–®ï¼ã€çš„å£è™Ÿï¼Œè®“ä½¿ç”¨è€…æ¸…æ¥šçš„äº†è§£åˆ°ä½¿ç”¨é€™æ¬¾ App èƒ½å¸¶çµ¦çš„å¥½è™•æ˜¯ä»€éº¼ï¼Ÿå°±æ˜¯èƒ½å¿«é»æ‰¾åˆ°å·¥ä½œå•Šï½ï¼Œå¯¦åœ¨åœ°è¬›å‡ºäº†ä½¿ç”¨è€…å¿ƒåº•æƒ³çš„ã€‚ç›¸æ¯”å…¶ä»–å¹¾æ¬¾ï¼Œå£è™Ÿå¤§å¤šæ˜¯æ¨éŠ·è‡ªå·±çš„åŠŸèƒ½ï¼Œåœ¨äººæ€§åŒ–è¨­è¨ˆä¸Šï¼Œ518 ä¼¼ä¹åˆç•¥å‹ä¸€ç±Œã€‚  </p>
</li>
<li><p>å®šç¾©ç”¢æ¥­çš„ç¬¬ä¸€ï¼Œåœ¨è¡ŒéŠ·ä¸Šç›¸ç•¶çš„é‡è¦ï¼Œå› ç‚ºæ²’äººè¨˜å¾—ç¬¬äºŒï¼Œåªæœ‰ç¬¬ä¸€åæœƒè¢«è¨˜å¾—ã€‚åœ¨æ‰€æœ‰ app ä¸­ï¼Œåªæœ‰ 104 çš„ã€Œå·¥ä½œæ©Ÿæœƒæœ€å¤šã€ã€å°é›ä¸Šå·¥çš„ã€Œå…¨å°æœ€å¤§çš„å­¸ç”Ÿæ‰“å·¥APPã€æœ‰å°‡è‡ªå·±å®šä½ç‚ºç¬¬ä¸€ã€‚å…¶ä¸­å°é›ä¸Šå·¥å²å®³çš„åœ°æ–¹æ˜¯ï¼Œå®ƒçŸ¥é“è‡ªå·±ç”¢å“åœ¨è·ç¼ºæ•¸é‡ä¸Šç„¡æ³•èˆ‡ç”¢æ¥­é¾é ­ 104 ç›¸æ¯”ï¼Œæ‰€ä»¥å°±å®šç¾©äº†è‡ªå·±çš„ç¬¬ä¸€ï¼Œä¹Ÿå°±æ˜¯å­¸ç”Ÿæ‰“å·¥ä¸­ç¬¬ä¸€ï¼ŒçœŸæ˜¯ç›¸ç•¶å²å®³çš„å£è™Ÿã€‚æ¥è‘—æ˜¯ã€Œå…¨å°æœ€å¤§ã€å››å€‹å­—ï¼Œé€™æ˜ç¢ºåˆ»ç•«è‡ªå·±çš„é ˜å®šç¯„åœï¼Œç›¸æ¯”åªæ˜¯å–®å–®æè¿°ã€Œå·¥ä½œæ©Ÿæœƒæœ€å¤šã€ï¼Œã€Œå…¨å°æœ€å¤§ã€è®“ä½¿ç”¨è€…æ›´èƒ½è¯æƒ³ï¼Œè€Œè¯æƒ³å°±æ˜¯å½±éŸ¿åŠ›çš„é—œéµã€‚  </p>
<br/>

</li>
</ol>
<p>æœ‰ä»€éº¼æƒ³æ³•å‘Šè¨´è€çš®ï¼Œè«‹åœ¨ä¸‹æ–¹ç•™è¨€å–”ï½  </p>
<hr>
<p><strong>ç›¸é—œé€£çµï¼š</strong></p>
<p><a href="https://www.pnas.org/content/103/24/9369">Adam L. Alter, Daniel M. Oppenheimer, (2006), Predicting short-term stock fluctuations by using processing fluency</a>  </p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-meh-rolling-eyes"></i> æˆ‘ä¹Ÿè¦ä¸€å€‹å¥½åå­—å•Š -------------</p>
        </div>
    
</div>
]]></content>
      <categories>
        <category>è€çš®çš„æ•…äº‹</category>
        <category>è®€æ›¸å¿ƒå¾—</category>
      </categories>
      <tags>
        <tag>App, è¡ŒéŠ·, è®€æ›¸å¿ƒå¾—</tag>
      </tags>
  </entry>
  <entry>
    <title>RxJava ç‰¹æ•ˆï¼šAPI æ­é… zip çš„å¦™ç”¨</title>
    <url>/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>å°å”¯å…¬å¸çš„é–€å£è§’è½ï¼Œæ”¾æœ‰å¹¾å¼µå°æ¡Œå­ï¼Œå°å”¯æ­£èˆ‡å¦ä¸€ä½è² è²¬ API ä»‹é¢é–‹ç™¼çš„åŒäº‹ï¼Œåœ¨å…¶ä¸­ä¸€å¼µæ¡Œä¸Šè¨è«–è¦å¦‚ä½•ç‚ºæ—¢æœ‰ API è¨­è¨ˆæ–°çš„ API æ¥å£ã€‚ä»¥å°å”¯è² è²¬çš„æ‰‹æ©Ÿ App å‰ç«¯è§’è‰²ï¼Œç•¶ç„¶æ˜¯å¸Œæœ›è¶Šç°¡å–®è¶Šå¥½ï¼Œä¸€å€‹ç•«é¢ä¸€æ”¯ API æ˜¯å° App æœ€ç°¡å–®çš„æ–¹å¼ï¼Œé€²å…¥ç•«é¢æ™‚ä½¿ç”¨ API æ›´æ–°è³‡æ–™ã€é‡æ•´ä»‹é¢ï¼Œä½†æ˜¯ API åŒäº‹å»æœ‰å…¶ä»–è€ƒé‡ï¼Œå› ç‚ºæ¶æ§‹å•é¡Œï¼Œä»–ç„¡æ³•æŠŠæ¯å€‹åŠŸèƒ½ç•«é¢ï¼Œéƒ½ä¾ç…§å°å”¯çš„æœŸå¾…å»è¨­è¨ˆä»‹é¢ã€‚æœ€å¾Œçµæœæ˜¯æœ‰æ•¸å€‹ç•«é¢ï¼Œéœ€è¦ä½¿ç”¨è¶…éä¸€æ”¯ API å»å°‡è³‡æ–™æ•´åˆèµ·ä¾†ã€‚é€™å°æ–¼åŸæœ¬å°±åœ¨ä½¿ç”¨ <a href="https://github.com/ReactiveX/RxJava">RxJava</a> çš„å°å”¯åœ˜éšŠï¼Œè…¦ä¸­å†’å‡ºä¸€å€‹ä¹‹å‰çœ‹éçš„ <a href="http://reactivex.io/documentation/operators/zip.html">operator - Zip</a>ã€‚<br><br/></p>
<h2 id="åœ¨æ²’æœ‰çš„-ReactiveX-ä¹‹å‰"><a href="#åœ¨æ²’æœ‰çš„-ReactiveX-ä¹‹å‰" class="headerlink" title="åœ¨æ²’æœ‰çš„ ReactiveX ä¹‹å‰"></a>åœ¨æ²’æœ‰çš„ ReactiveX ä¹‹å‰</h2><p>ç•¶ä¸€å€‹ç•«é¢å°æ‡‰ä¸€æ”¯ APIï¼Œæµç¨‹æ˜¯ç›¸ç•¶å–®ç´”ï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/1api.svg" class="" title="1 API &#x2F; screen">
<br/>

<p>ä½†æ˜¯ç•¶ä¸€å€‹ç•«é¢æœ‰éœ€è¦å…©æ”¯æˆ–ä»¥ä¸Š API æ‰èƒ½å‘ˆç¾å…§å®¹ï¼Œå°±ã€Œç¨å¾®ã€æœ‰é»è¤‡é›œäº†ï¼Œæœ‰å¤šç¨®çµ„åˆéƒ½å¯ä»¥é”åˆ°ç›®çš„ï¼Œé€šå¸¸æœƒè¦–ç‹€æ³ä½¿ç”¨ã€‚</p>
<h3 id="ç›¸ä¾æ€§é«˜çš„-API-çµ„åˆ"><a href="#ç›¸ä¾æ€§é«˜çš„-API-çµ„åˆ" class="headerlink" title="ç›¸ä¾æ€§é«˜çš„ API çµ„åˆ"></a>ç›¸ä¾æ€§é«˜çš„ API çµ„åˆ</h3><p>åœ¨æœ‰å¼·çƒˆç›¸ä¾æ€§ä¸‹çš„ç‹€æ³ï¼Œç•¶ä¸€æ”¯ API å¤±æ•—ï¼Œæ¥ä¸‹ä¾†çš„éƒ½æœƒè®Šæˆæ¯«ç„¡æ„ç¾©ï¼Œé€™æ™‚å¯ä»¥è®“ä¸€æ”¯ API æ¥è‘—å¦ä¸€æ”¯ï¼Œç•¶ç¬¬ä¸€æ”¯çµæœå›ä¾†å¾Œï¼Œå…ˆè™•ç†çµæœï¼Œå†æ±ºå®šæ˜¯å¦è¦åŸ·è¡Œç¬¬äºŒæ”¯ APIã€‚é€™å°±æœ‰å…©ç¨®å¯èƒ½çš„çµ„åˆï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_1.svg" class="" title="2 API &#x2F; screen flow #1">
<br/>

<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_2.svg" class="" title="2 API &#x2F; screen flow #2">
<br/>

<h3 id="æœ€é‡è¦çš„å…ˆé¡¯ç¤º"><a href="#æœ€é‡è¦çš„å…ˆé¡¯ç¤º" class="headerlink" title="æœ€é‡è¦çš„å…ˆé¡¯ç¤º"></a>æœ€é‡è¦çš„å…ˆé¡¯ç¤º</h3><p>ç•¶ç¬¬äºŒæ”¯ API åªæ˜¯å–®ç´”çš„é™„åŠ è³‡è¨Šæ™‚ï¼Œé€™æ™‚ä½¿ç”¨è€…å…ˆçœ‹åˆ°ç¬¬ä¸€æ”¯ API è³‡è¨Šæ¯”è¼ƒé‡è¦ï¼Œå°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è®Šå½¢ã€‚é€™è®“ç¬¬ä¸€æ”¯çµæœå›ä¾†å¾Œï¼Œå°±ç«‹åˆ»æ¸²æŸ“ï¼Œç­‰ç¬¬äºŒæ”¯ API å›ä¾†ï¼Œå†æ¸²æŸ“ç¬¬äºŒæ”¯çµæœï¼Œå³ä½¿å¾Œé¢çš„ API å¤±æ•—ï¼Œå°ä½¿ç”¨è€…çš„å½±éŸ¿ä¹Ÿè¼ƒå°ï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_3.svg" class="" title="2 API &#x2F; screen flow #3">
<br/>

<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_4.svg" class="" title="2 API &#x2F; screen flow #4">
<br/>

<h3 id="å¤§å®¶éƒ½é‡è¦ï¼Œä¸”ç„¡ç›¸ä¾æ€§"><a href="#å¤§å®¶éƒ½é‡è¦ï¼Œä¸”ç„¡ç›¸ä¾æ€§" class="headerlink" title="å¤§å®¶éƒ½é‡è¦ï¼Œä¸”ç„¡ç›¸ä¾æ€§"></a>å¤§å®¶éƒ½é‡è¦ï¼Œä¸”ç„¡ç›¸ä¾æ€§</h3><p>ç•¶ API èª°å…ˆèª°å¾Œçš„é †åºä¸é‡è¦ï¼Œè€Œä¸”æ²’æœ‰ç›¸ä¾æ€§æ™‚ï¼Œç·šæ€§åŒæ­¥ç™¼é€ä¸”ç­‰å¾…çµæœéƒ½å›ä¾†å¾Œï¼Œå†æ¸²æŸ“ç•«é¢ï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_5.svg" class="" title="2 API &#x2F; screen flow #5">
<br/>

<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_6.svg" class="" title="2 API &#x2F; screen flow #6">
<br/>

<h3 id="éåŒæ­¥é€²è¡Œ"><a href="#éåŒæ­¥é€²è¡Œ" class="headerlink" title="éåŒæ­¥é€²è¡Œ"></a>éåŒæ­¥é€²è¡Œ</h3><p>éåŒæ­¥é€²è¡Œä¹Ÿæ˜¯å¸¸ç”¨çš„æ–¹å¼ä¹‹ä¸€ï¼Œå¦‚æœ API ç„¡ç›¸ä¾æ€§ï¼Œæˆ–è€…è³‡æ–™é †åºä¸é‡è¦ï¼Œä¹Ÿå¯ä»¥éåŒæ­¥ç™¼é€ APIï¼Œå“ªå€‹å…ˆå›ä¾†å°±å…ˆæ¸²æŸ“å“ªå€‹ã€‚ç¼ºé»ä¹Ÿæ˜¯å¸¸å¸¸æœƒçœ‹åˆ°ç•«é¢å…ˆé•·å‡ºä¸€éƒ¨åˆ†ï¼Œæ¥è‘—é¦¬ä¸Šåœ¨è·³å‡ºå‰©ä¸‹çš„éƒ¨åˆ†ï¼Œè‡³æ–¼å“ªéƒ¨åˆ†å…ˆï¼Œå“ªå€‹å¾Œå‡ºä¾†ï¼Œå‰‡ç„¡æ³•é æ¸¬ï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_parallel2.svg" class="" title="2 API &#x2F; screen flow #7">
<br/>

<p>ç•¶è³‡æ–™å…§å®¹å¿…é ˆä¸€åŒé¡¯ç¤ºï¼Œé‚£å°±å¾—ç­‰å¾…çµæœéƒ½å›ä¾†å¾Œæ‰æ¸²æŸ“ï¼Œé€™æ˜¯å°å”¯å…¬å¸å…§å¸¸è¦‹çš„ç”¨æ³•ï¼Œå„ªé»æ˜¯ä¸æœƒçœ‹åˆ°ç•«é¢åˆ†åˆ¥è·³å‡ºä¾†ï¼Œç¼ºé»æ˜¯ä¸å¤ªå®¹æ˜“å¯¦ä½œï¼Œå¸¸å¸¸çœ‹åˆ°æœ‰å¯«éŒ¯äº‚çš„ç‹€æ³ï¼ˆä¸æœƒç”¨åˆæ„›ç”¨ï¼Œç‚ºä»€éº¼ä¸ä¹¾è„†ä½¿ç”¨åŒæ­¥æ–¹å¼ï¼Œä¸€å€‹æ¥ä¸€å€‹ï¼‰ï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_parallel.svg" class="" title="2 API &#x2F; screen flow #8">
<br/>

<h2 id="ReactiveX-çš„å‡ºç¾"><a href="#ReactiveX-çš„å‡ºç¾" class="headerlink" title="ReactiveX çš„å‡ºç¾"></a>ReactiveX çš„å‡ºç¾</h2><p>è‡ªå¾å°å”¯åœ˜éšŠä½¿ç”¨ RxJava zip å¾Œï¼Œä¹‹å‰ä¸å®¹æ˜“å¯¦ä½œçš„éåŒæ­¥å¯«æ³•ï¼Œçªç„¶è®Šæˆç„¡é›£åº¦ï¼Œzip çš„ç‰¹æ€§æ˜¯å°‡å¤šå€‹è³‡æ–™ä¾†æºï¼Œåªåœ¨æ‰€æœ‰ä¾†æºéƒ½æ¥æ”¶åˆ°è³‡æ–™å¾Œï¼Œæ‰ä¸€èµ·ç™¼é€šçŸ¥è™•ç†ã€‚ä¸‹æ–¹çš„åœ–å¯ä»¥çœ‹æˆï¼Œç™½åœˆæ˜¯ API ä¸€è™Ÿå›å‚³çš„çµæœï¼Œé»ƒè‰²å€’ä¸‰è§’æ˜¯ API äºŒè™Ÿå›å‚³çš„çµæœï¼Œé»ƒè‰²åœˆå‰‡æ˜¯å…©å€‹ API åˆä½µå¾Œçš„çµæœï¼Œä¹Ÿå°±é æœŸé”æˆçš„æ•ˆæœï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/rxjava-zip.png" class="" title="RxJava zip operator">
<br/>

<p>ä½¿ç”¨ zip å¾Œæµç¨‹è®Šæˆå¦‚ä¸‹ï¼š</p>
<img src="/RxJava-%E7%89%B9%E6%95%88%EF%BC%9AAPI-%E6%90%AD%E9%85%8D-zip-%E7%9A%84%E5%A6%99%E7%94%A8/2api_zip.svg" class="" title="2 API &#x2F; zip operator">
<br/>

<p>ç¨‹å¼ç¢¼å¯«èµ·ä¾†å‡ºå¥‡çš„ç°¡å–®ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Single&lt;Result&gt; <span class="title">getScreenData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// éåŒæ­¥å‘¼å« API 1</span></span><br><span class="line">    Single&lt;ApiResult&gt; api_1_result = api1();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éåŒæ­¥å‘¼å« API 2</span></span><br><span class="line">    Single&lt;ApiResult&gt; api_2_result = api2();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾…å…©å€‹çµæœéƒ½å›ä¾†å¾Œï¼Œä½¿ç”¨ handleApiResult å°‡è³‡æ–™è½‰æ›æˆ UI å¯ä½¿ç”¨çš„ data model</span></span><br><span class="line">    <span class="keyword">return</span> Single.zip(api_1_result, api_2_result, <span class="keyword">this</span>::handleApiResult);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Result <span class="title">handleApiResult</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    ApiResult api_1_result,</span></span></span><br><span class="line"><span class="function"><span class="params">    ApiResult api_2_result)</span> </span>&#123;</span><br><span class="line">    Result result = <span class="keyword">new</span> Result();</span><br><span class="line">    <span class="comment">// æ¨¡æ“¬å°‡è³‡æ–™æ•´åˆ</span></span><br><span class="line">    result.setData1(api_1_result);</span><br><span class="line">    result.setData2(api_2_result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>
<br/>

<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="fas fa-laptop-code"></i> å¥½æƒ³ç²¾é€š RxJava å•Šï½ -------------</p>
        </div>
    
</div>
<br/>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>RxJava</tag>
      </tags>
  </entry>
  <entry>
    <title>git submodule çš„åˆ†æ”¯è¿½è¹¤</title>
    <url>/git-submodule-%E7%9A%84%E5%88%86%E6%94%AF%E8%BF%BD%E8%B9%A4/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>å°å”¯åœ¨ä¸€é–“è³‡è¨Šå…¬å¸æ“”ä»» Android è»Ÿé«”å·¥ç¨‹å¸«ï¼Œè² è²¬å…¬å¸å…§çš„ä¸»åŠ›ç”¢å“é–‹ç™¼ï¼Œé€™æ˜¯ä¸€é …åŠŸèƒ½è¤‡é›œçš„ç”¢å“ï¼Œå®ƒç´¯è¨ˆäº†æ•¸å¹´çš„ç¨‹å¼ç¢¼ã€å•†å‹™é‚è¼¯ã€å‡ºåŒ…ç¶“é©—ç­‰çš„åŠŸèƒ½èˆ‡ä¿®æ­£ã€‚æ•¸å¹´å¾Œï¼Œåœ˜éšŠä¸­æ­£åœ¨æ¨å‹•å…¨æ–° 2.0 çš„ç”¢å“ï¼Œä»¥åŠå…¬å¸å…¶ä»–æœå‹™ä¹Ÿå³å°‡æ¨å‡º Appã€‚ä¸å¯é¿å…çš„ï¼Œæœ‰è¨±å¤šç›¸ä¼¼åŠŸèƒ½ç›¸ç¹¼æ©«è·¨å„å€‹ç”¢å“ Appï¼Œé€™è®“å°å”¯è‡ªè¦ºå¿…é ˆæœ‰ä¸€å¥—æ›´å¥½çš„æ–¹å¼ç®¡ç†è‡ªå·±åœ˜éšŠçš„ç¨‹å¼ç¢¼ï¼Œæ”¹å–„ä¹‹å¾Œæ“´å……æ€§ã€ç¶­è­·æ€§ï¼Œå’Œä¿è­·åœ˜éšŠå·¥ç¨‹å¸«å€‘çš„è‚ï½</p>
<p>ä¸€å€‹å¾é ­æ‰“é€ çš„ç”¢å“ï¼ŒåŠŸèƒ½æ˜¯ä¸æ–·çš„ç–ŠåŠ ä¸Šå»ï¼Œé®®å°‘æœ‰åœ˜éšŠèƒ½çœŸçš„å¾é–‹é ­å°±æå¥½æ¶æ§‹è¨­è¨ˆï¼Œå°å”¯åœ˜éšŠçš„ç”¢å“ä¹Ÿä¸ä¾‹å¤–ã€‚é™¤äº†è‡ªèº«çš„æ ¸å¿ƒåŠŸèƒ½å¤–ï¼Œé‚„ä½¿ç”¨äº†åœ–éšŠä¹‹å‰é–‹ç™¼çš„åŠŸèƒ½ï¼Œä»¥åŠè¨±å¤šç¾æˆ github çš„æ¨¡çµ„ï¼Œæœ‰çš„å·²æä¾› gradle çš„å®‰è£èˆ‡ä½¿ç”¨ï¼Œæœ‰çš„å»åªæ˜¯å–®ç´”çš„ Java/Kotlin ç¨‹å¼ç¢¼ã€‚åœ¨åˆæœŸï¼Œæœ€ç›´æ¥æš´åŠ›çš„æ–¹å¼å°±æ˜¯ç›´æ¥æŠ“ä¸‹ä¾†ï¼Œå¡é€²ç•¶å‰çš„ App ä¸­ä½¿ç”¨ï¼Œç´¯ç©åˆ°ä»Šæ™‚ä»Šæ—¥ï¼Œå·²æœ‰æ•¸å€‹ç›¸åŒæ¨¡çµ„ï¼Œåˆ†åˆ¥çš„è¤‡è£½åˆ°æ•¸å€‹å°ˆæ¡ˆä¸Š ğŸ˜±</p>
<p>å°å”¯åœ˜éšŠæœ‰å¹¾å€‹é¸æ“‡ï¼š</p>
<ol>
<li>ç¶­æŒç¾ç‹€ï¼Œæ¯å€‹ App è¤‡è£½ä¸€ä»½ç¨‹å¼ç¢¼<ul>
<li><strong>å„ªé»</strong>ï¼šç¾æœ‰æ¶æ§‹ã€ä¸éœ€æ›´æ”¹ã€å„å€‹ App å·¥ç¨‹å½ˆæ€§è‡ªç”±ï¼Œæƒ³æ€éº¼æ”¹å°±æ€éº¼æ”¹</li>
<li><strong>ç¼ºé»</strong>ï¼šç¶­ä¸Šéå¸¸ä¸ä¾¿ï¼Œä¸€å€‹ä¿®æ­£éœ€è¦åŒæ­¥åˆ°æ‰€æœ‰ Appï¼Œä¹‹å¾Œå·¥ç¨‹å¸«è¦è¨˜å¾—å»æ‰‹å‹• merge æ›´æ–°çš„ç¨‹å¼ç¢¼</li>
</ul>
</li>
</ol>
<ol start="2">
<li>å°‡å¯æ¨¡çµ„åŒ–çš„ï¼Œæ”¹å¯«æˆ gradle<ul>
<li><strong>å„ªé»</strong>ï¼šä¸å¿…è¦å†åŒ…ä¸€ä»½ç¨‹å¼ç¢¼åˆ°å„å€‹ Appï¼Œä¹‹å¾Œå…¶ä»–å°ˆæ¡ˆè¦ä½¿ç”¨æœƒæ›´ä¾¿åˆ©ã€‚æ¨¡çµ„æ›´æ–°ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä»½ç¨‹å¼ç¢¼ï¼Œgradle ç‰ˆè™Ÿå‡ç´šä¾¿å¯æ›´æ–°ç¨‹å¼</li>
<li><strong>ç¼ºé»</strong>ï¼šä¹‹å¾Œå„å€‹ App è¦åšå®¢è£½åŒ–ï¼Œæœƒç›¸å°ä¸å®¹æ˜“</li>
</ul>
</li>
</ol>
<ol start="3">
<li>å°‡å¯æ¨¡çµ„åŒ–çš„ï¼Œæ”¹æˆ submodule<ul>
<li><strong>å„ªé»</strong>ï¼šæ¯å€‹æ¨¡çµ„åªéœ€è¦ç¶­è­·ä¸€ä»½ç¨‹å¼ç¢¼ï¼Œéœ€è¦æ›´æ–°æ™‚ï¼Œä½¿ç”¨ git å…§å»ºæ–¹å¼ï¼Œå³å¯åŒæ­¥æœ€æ–°çš„ç¨‹å¼ã€‚App ä¹Ÿæœ‰ä¸€å®šè‡ªç”±åº¦å»åšç”¢å“å®¢è£½åŒ–</li>
<li><strong>ç¼ºé»</strong>ï¼šé‚„æ˜¯ä»°è³´å„ App å» merge æ›´æ–°ï¼Œä½†ä¸ä¸€å®šéœ€è¦æ‰‹å‹•ï¼ˆé€é git åŒæ­¥ submodule å³å¯ï¼‰</li>
</ul>
</li>
</ol>
<p>æœ€å¾Œï¼Œå°å”¯åœ˜éšŠé¸æ“‡ submodule æ¨¡å¼å»é€²è¡Œï¼Œä»¥ä¸‹æ˜¯å°å”¯çš„æ‰‹ç¨¿ç´€éŒ„ï¼š</p>
<h2 id="å°‡å°ˆæ¡ˆåˆ‡åˆ†æˆ-submodule"><a href="#å°‡å°ˆæ¡ˆåˆ‡åˆ†æˆ-submodule" class="headerlink" title="å°‡å°ˆæ¡ˆåˆ‡åˆ†æˆ submodule"></a>å°‡å°ˆæ¡ˆåˆ‡åˆ†æˆ submodule</h2><p>ç›®å‰å°å”¯åœ˜éšŠè² è²¬çš„ç”¢å“ git æ¶æ§‹å¦‚ä¸‹ï¼Œä¸€å€‹å·¨å‹ git repoï¼Œå…§å®¹åŒ…å±±åŒ…æµ·ï¼Œå«ä¹‹å‰åœ˜éšŠé–‹ç™¼çš„åŠŸèƒ½æ¨¡çµ„ï¼Œä»¥åŠç¬¬ä¸‰æ–¹ github çš„åŠŸèƒ½æ¨¡çµ„ç­‰ï¼š</p>
<img src="/git-submodule-%E7%9A%84%E5%88%86%E6%94%AF%E8%BF%BD%E8%B9%A4/app_diagram_1.svg" class="" title="ç”¢å“æ¶æ§‹åœ– - ä¹‹å‰">

<p>é‡æ–°æ‰“é€ å¾Œï¼Œæ–°çš„ git æ¶æ§‹å¦‚ä¸‹ï¼Œå¯è¢«å¤šå€‹ç”¢å“å…±ç”¨çš„æ¨¡çµ„ï¼Œéƒ½æœƒæ‹‰æˆç¨ç«‹çš„ git repoï¼Œç”±ä¸€å€‹ä¸»è¦ git repo ä¾†æŠŠå…¶ä»–åŠŸèƒ½ï¼Œä»¥ submodule æ–¹å¼æ·»åŠ é€²ä¾†ï¼š</p>
<img src="/git-submodule-%E7%9A%84%E5%88%86%E6%94%AF%E8%BF%BD%E8%B9%A4/app_diagram_2.svg" class="" title="ç”¢å“æ¶æ§‹åœ– - ä¹‹å¾Œ">

<h3 id="åŠ å…¥-submodule-æŒ‡ä»¤"><a href="#åŠ å…¥-submodule-æŒ‡ä»¤" class="headerlink" title="åŠ å…¥ submodule æŒ‡ä»¤"></a>åŠ å…¥ submodule æŒ‡ä»¤</h3><p>ä»¥ä¸‹ç”¨å…¶ä¸­ä¸€å€‹åŠŸèƒ½ç‚ºç¯„ä¾‹ã€‚å°‡ function1 ä»¥ submodule æ–¹å¼åŠ å…¥ä¸» Appï¼š</p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ git submodule add https://github.com/wm4n/function1.gitfunction1</span><br><span class="line">æ­£è¤‡è£½åˆ° <span class="string">&#x27;/Users/[path]/app-host/function1&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 4, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (4/4), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 4 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">æ¥æ”¶ç‰©ä»¶ä¸­: 100% (4/4), å®Œæˆ.</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸ŠæŒ‡ä»¤æœƒå°‡ function1 repo å…§å®¹æŠ“åˆ° function1 ç›®éŒ„ä¸‹ï¼Œå¦‚æœå°å‡º .gitmodules æª”æ¡ˆï¼ˆä½¿ç”¨ <code>git submodule add</code> å¾Œè‡ªå‹•å»ºç«‹ï¼‰å…§å®¹ï¼Œæœƒç™¼ç¾ï¼š</p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ cat .gitmodules</span><br><span class="line">[submodule <span class="string">&quot;function1&quot;</span>]</span><br><span class="line">	path = function1</span><br><span class="line">	url = https://github.com/wm4n/function1.git</span><br></pre></td></tr></table></figure>

<h3 id="ä¸Šå‚³æ·»åŠ çš„-submodule"><a href="#ä¸Šå‚³æ·»åŠ çš„-submodule" class="headerlink" title="ä¸Šå‚³æ·»åŠ çš„ submodule"></a>ä¸Šå‚³æ·»åŠ çš„ submodule</h3><p>ç…§å¹³å¸¸ git ä½¿ç”¨çš„æ–¹å¼ï¼Œå°‡æ·»åŠ å¥½çš„ submodule è¨­å®šï¼Œä¸Šå‚³è‡³ github</p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ git add .gitmodules</span><br><span class="line"></span><br><span class="line">â¯ git add function1</span><br><span class="line"></span><br><span class="line">â¯ git commit -m <span class="string">&quot;add function1 submodule&quot;</span></span><br><span class="line">[main 26d42dc] add function1 submodule</span><br><span class="line"> 2 files changed, 4 insertions(+)</span><br><span class="line"> create mode 100644 .gitmodules</span><br><span class="line"> create mode 160000 function1</span><br><span class="line"></span><br><span class="line">â¯ git push</span><br><span class="line">æšèˆ‰ç‰©ä»¶: 4, å®Œæˆ.</span><br><span class="line">ç‰©ä»¶è¨ˆæ•¸ä¸­: 100% (4/4), å®Œæˆ.</span><br><span class="line">ä½¿ç”¨ 4 å€‹åŸ·è¡Œç·’é€²è¡Œå£“ç¸®</span><br><span class="line">å£“ç¸®ç‰©ä»¶ä¸­: 100% (3/3), å®Œæˆ.</span><br><span class="line">å¯«å…¥ç‰©ä»¶ä¸­: 100% (3/3), 419 ä½å…ƒçµ„ | 419.00 KiB/s, å®Œæˆ.</span><br><span class="line">ç¸½å…± 3 (å·®ç•° 0)ï¼Œå¾©ç”¨ 0 (å·®ç•° 0)ï¼Œé‡ç”¨åŒ… 0</span><br><span class="line">To https://github.com/wm4n/app-host.git</span><br><span class="line">   278058e..26d42dc  main -&gt; main</span><br></pre></td></tr></table></figure>

<h3 id="æ›´æ–°-repo-å…§å®¹"><a href="#æ›´æ–°-repo-å…§å®¹" class="headerlink" title="æ›´æ–° repo å…§å®¹"></a>æ›´æ–° repo å…§å®¹</h3><p>ç•¶è¦åŒæ­¥ç·šä¸Šç¨‹å¼ç¢¼æ™‚ï¼Œä¸€èˆ¬æœƒç”¨ <code>git pull</code> ä¾†æŠ“å–æœ€æ–°å…§å®¹ï¼Œä½†æ”¹ç”¨ submodule æ–¹å¼å¾Œï¼Œæœƒç™¼ç¾ function1 ä¸æœƒåŒæ­¥ã€‚å¦‚æœè¦æ›´æ–°ï¼Œå‰‡å¿…é ˆé€²å…¥åˆ° function1 ç›®éŒ„ä¸‹å†æ¬¡åŸ·è¡Œ <code>git pull</code></p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ <span class="built_in">cd</span> function1</span><br><span class="line"></span><br><span class="line">â¯ git pull</span><br><span class="line">remote: Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">å±•é–‹ç‰©ä»¶ä¸­: 100% (3/3), 691 ä½å…ƒçµ„ | 138.00 KiB/s, å®Œæˆ.</span><br><span class="line">ä¾†è‡ª https://github.com/wm4n/function1</span><br><span class="line">   5f9ae22..e6843b4  main       -&gt; origin/main</span><br><span class="line">æ›´æ–° 5f9ae22..e6843b4</span><br><span class="line">Fast-forward</span><br><span class="line"> README.md | 2 +-</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br></pre></td></tr></table></figure>

<h3 id="ç•¶-submodule-æ•¸é‡æˆé•·å¾Œ"><a href="#ç•¶-submodule-æ•¸é‡æˆé•·å¾Œ" class="headerlink" title="ç•¶ submodule æ•¸é‡æˆé•·å¾Œ"></a>ç•¶ submodule æ•¸é‡æˆé•·å¾Œ</h3><p>å°å”¯åœ˜éšŠè² è²¬çš„ç”¢å“ï¼Œå¦‚ä»Šè¢«æ‹†è§£æˆ 5 å€‹ submodule å¾Œï¼Œç™¼ç¾ä»Šå¾Œå¦‚æœè¦æ›´æ–°ï¼Œå°±è¦é€²å…¥æ¯å€‹ submodule çš„ç›®éŒ„ï¼Œåˆ†åˆ¥åŸ·è¡Œ <code>git pull</code> æŒ‡ä»¤ï¼Œé€™è¡¨ç¤ºä¸€å€‹å°ˆæ¡ˆå¦‚æœæœ‰ X å€‹ submoduleï¼Œæ¯æ¬¡æ›´æ–°æœ€å¤šå°±æœƒæœ‰ X + 1 å€‹ <code>git pull</code>ã€‚é€™ä¸åƒ…è®“å°å”¯å—ä¸äº†ï¼Œåœ˜éšŠä¹Ÿå¸¸ç‚ºäº†å¿˜è¨˜è¦ç¢ºå¯¦åŸ·è¡Œï¼Œåè€Œé€ æˆè¨±å¤šå•é¡Œã€‚</p>
<p>ç‚ºäº†æ”¹å–„é€™å•é¡Œï¼Œå°å”¯åœ¨æ¨¡çµ„è¨­å®šæª”ä¸­ï¼Œ<strong>æŒ‡å®šè®“æ¨¡çµ„ submodule è¿½è¹¤æŸå€‹ç‰¹å®šçš„é ç«¯åˆ†æ”¯</strong></p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ cat .gitmodules</span><br><span class="line">[submodule <span class="string">&quot;function1&quot;</span>]</span><br><span class="line">	path = function1</span><br><span class="line">	url = https://wm4n@github.com/wm4n/function1.git</span><br><span class="line">	branch = main</span><br></pre></td></tr></table></figure>

<p>branch ä»£è¡¨é€™å€‹ submodule å°‡è¿½è¹¤æŒ‡å®šçš„é ç«¯åˆ†æ”¯ã€‚ä¹‹å¾Œï¼Œåœ˜éšŠåªè¦ä½¿ç”¨ <code>git submodule update --remote</code> æŒ‡ä»¤<strong>ä¸€æ¬¡</strong>ï¼Œæ‰€æœ‰çš„ submodule éƒ½æœƒä¾ç…§æŒ‡å®šçš„<strong>åˆ†æ”¯</strong>å»æŠ“æœ€æ–°çš„å…§å®¹ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ git submodule update --remote</span><br><span class="line">remote: Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">å±•é–‹ç‰©ä»¶ä¸­: 100% (3/3), 689 ä½å…ƒçµ„ | 344.00 KiB/s, å®Œæˆ.</span><br><span class="line">ä¾†è‡ª https://github.com/wm4n/function1</span><br><span class="line">   e6843b4..c7df259  main       -&gt; origin/main</span><br><span class="line">å­æ¨¡çµ„è·¯å¾‘ <span class="string">&#x27;function1&#x27;</span>ï¼šæª¢å‡º <span class="string">&#x27;c7df259c57f4c6143c4e29488399b13b9fb188c6&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä»¤äººåˆ†å¿ƒçš„-git-status"><a href="#ä»¤äººåˆ†å¿ƒçš„-git-status" class="headerlink" title="ä»¤äººåˆ†å¿ƒçš„ git status"></a>ä»¤äººåˆ†å¿ƒçš„ git status</h3><p>ä¸€åˆ‡è¨­å®šå¥½ï¼Œåˆ†æ”¯è¿½è¹¤åŠŸèƒ½æ»¿è¶³äº†åœ˜éšŠçš„éœ€æ±‚ï¼Œå¾æ­¤ä¹‹å¾Œï¼Œå¯é‡è¤‡ä½¿ç”¨çš„åŠŸèƒ½é †åˆ©åœ°æŠ½å‡ºæˆç¨ç«‹ git repoï¼Œä¸åŒ App ä¾ç…§å„è‡ªéœ€æ±‚ï¼Œæ·»åŠ è‡ªå·±éœ€è¦çš„ submoduleï¼Œç„¶å¾Œä¸€éµæ›´æ–°æ‰€æœ‰æ¨¡çµ„ä¹Ÿä¸å†æ˜¯å¤¢æƒ³ ğŸ¥³ã€‚ä¸€åˆ‡æ˜¯å¦‚æ­¤çš„ç¾å¥½ï¼Œç›´åˆ°åœ˜éšŠç™¼ç¾â€¦ ç¶“å¸¸ <code>git status</code>ï¼Œå°±æœƒå‡ºç¾ï¼š</p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ git status</span><br><span class="line">ä½æ–¼åˆ†æ”¯ main</span><br><span class="line">æ‚¨çš„åˆ†æ”¯èˆ‡ä¸Šæ¸¸åˆ†æ”¯ <span class="string">&#x27;origin/main&#x27;</span> ä¸€è‡´ã€‚</span><br><span class="line"></span><br><span class="line">å°šæœªæš«å­˜ä»¥å‚™æäº¤çš„è®Šæ›´ï¼š</span><br><span class="line">  ï¼ˆä½¿ç”¨ <span class="string">&quot;git add &lt;æª”æ¡ˆ&gt;...&quot;</span> æ›´æ–°è¦æäº¤çš„å…§å®¹ï¼‰</span><br><span class="line">  ï¼ˆä½¿ç”¨ <span class="string">&quot;git restore &lt;æª”æ¡ˆ&gt;...&quot;</span> æ¨æ£„å·¥ä½œå€çš„æ”¹å‹•ï¼‰</span><br><span class="line">	ä¿®æ”¹ï¼š     function1 (æ–°æäº¤)</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å°šæœªåŠ å…¥æäº¤ï¼ˆä½¿ç”¨ <span class="string">&quot;git add&quot;</span> å’Œ/æˆ– <span class="string">&quot;git commit -a&quot;</span>ï¼‰</span><br></pre></td></tr></table></figure>

<p>åœ¨ä½¿ç”¨åˆ†æ”¯è¿½è¹¤ä¹‹å‰ï¼Œå°å”¯çš„åœ˜éšŠç¸½æ˜¯æœƒåœ¨è·Ÿæ–°æ¨¡çµ„å¾Œï¼Œç·Šæ¥è‘—è·Ÿæ–°ä¸» App çš„æ¨¡çµ„ commit IDã€‚ä½¿ç”¨åˆ†æ”¯è¿½è¹¤å¾Œï¼Œé›–ç„¶ä¸å¿…è¦å†è·Ÿæ–°æ¨¡çµ„ commit IDï¼ˆå› ç‚º <code>git submodule update --remote</code> æŒ‡ä»¤æœƒè‡ªå‹•åŒæ­¥åˆ†æ”¯æœ€æ–°çš„ commit IDï¼‰ï¼Œä½† <code>git status</code> æŒ‡ä»¤é‚„æ˜¯æœƒæé†’æœ‰æ›´æ–°å°šæœªæäº¤ã€‚ä¹…è€Œä¹…ä¹‹ï¼Œåœ˜éšŠéƒ½è¦ºå¾—é€™è¨Šæ¯å¯¦åœ¨æƒ±äººå•Šï½ ğŸ˜–</p>
<p>å°å”¯è©¦äº†æ•¸å€‹æ–¹å¼å¾Œï¼ŒåŒ…æ‹¬æŠŠç›¸é—œæª”æ¡ˆéƒ½åŠ åˆ° <code>.gitignore</code>ï¼ˆæ­¤æ–¹æ³•ç„¡æ•ˆï¼‰ï¼Œæœ€å¾Œæ˜¯åœ¨æ¨¡çµ„è¨­å®šä¸­ï¼ŒåŠ ä¸Š <code>ignore = all</code>ï¼Œå°±æå®šäº†ï¼š</p>
<figure class="highlight bash"><figcaption><span>shell</span></figcaption><table><tr><td class="code"><pre><span class="line">â¯ cat .gitmodules</span><br><span class="line">[submodule <span class="string">&quot;function1&quot;</span>]</span><br><span class="line">	path = function1</span><br><span class="line">	url = https://wm4n@github.com/wm4n/function1.git</span><br><span class="line">	branch = main</span><br><span class="line">	ignore = all</span><br></pre></td></tr></table></figure>

<h3 id="å°-github-ä¸Šçš„ç¬¬ä¸‰æ–¹å°ˆæ¡ˆåšå®¢è£½åŒ–"><a href="#å°-github-ä¸Šçš„ç¬¬ä¸‰æ–¹å°ˆæ¡ˆåšå®¢è£½åŒ–" class="headerlink" title="å° github ä¸Šçš„ç¬¬ä¸‰æ–¹å°ˆæ¡ˆåšå®¢è£½åŒ–"></a>å° github ä¸Šçš„ç¬¬ä¸‰æ–¹å°ˆæ¡ˆåšå®¢è£½åŒ–</h3><p>æ²’å¤šä¹…å¾Œï¼Œå°å”¯åœ˜éšŠç™¼ç¾ï¼Œä»–å€‘æƒ³å° github ä¸Šçš„ç¬¬ä¸‰æ–¹å°ˆæ¡ˆåšå®¢è£½åŒ–ï¼Œä»¥ç¬¦åˆè¦æ ¼éœ€æ±‚ï¼Œä½†è¦å¦‚ä½•è¿½è¹¤ github å°ˆæ¡ˆåˆ†æ”¯çš„åŒæ™‚ï¼Œåˆåšå®¢è£½åŒ–å‘¢ï¼Ÿç•¢ç«Ÿç„¡æ³•å°ç¬¬ä¸‰æ–¹çš„å°ˆæ¡ˆåšä¿®æ”¹ï¼ˆé™¤éç¶“ç”± PR æµç¨‹ï¼Œä½†ä¸€èˆ¬ä¾†èªªä¸æœƒæ¥å—å®¢è£½åŒ–â€¦ï¼‰</p>
<p>å°å”¯åœ˜éšŠåˆ©ç”¨ github fork å°ˆæ¡ˆçš„æ–¹å¼ï¼Œè®“è‡ªå·±çš„å°ˆæ¡ˆè½‰è¿½è¹¤ fork çš„æ‹·è²ï¼Œåˆ©ç”¨ fork æ‹·è²ä¾†åšå®¢è£½åŒ–ï¼ŒåŒæ™‚åˆèƒ½<a href="https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/syncing-a-fork">ä¸æ–·å¾ upstream å°ˆæ¡ˆä¸­æ›´æ–°</a></p>
<hr>
<p>å¾æ­¤ä¹‹å¾Œï¼Œ<code>git status</code> ä¹Ÿä¸å†å›°æ“¾å°å”¯åœ˜éšŠäº† ğŸ¥³</p>
<p><strong>ç›¸é—œé€£çµï¼š</strong><a href="https://github.com/wm4n/app-host"><i class="fab fa-github"></i> Demo å°ˆæ¡ˆ</a></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="fab fa-git-alt"></i> git å°±æ˜¯é€™éº¼çš„é›£æï¼-------------</p>
        </div>
    
</div>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>ç‚ºä»€éº¼ RD çµ¦çš„ Android App Bundle é€£çµä¸èƒ½ç”¨ï¼</title>
    <url>/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>æ˜ŸæœŸä¸‰çš„ä¸‹åˆï¼Œè² è²¬å°å”¯åœ˜éšŠçš„ PMï¼ŒåŒ†å¿™çš„è·‘åˆ°å°å”¯çš„åº§ä½æ—ï¼Œå•åˆ°ï¼šã€Œå°å”¯ï½ ç‚ºä»€éº¼ä½ å‰›å‰›çµ¦æˆ‘çš„é€£çµä¸èƒ½ç”¨å•Šï¼ã€</p>
<p>å°å”¯å›å•é“ï¼šã€Œä»€éº¼å®‰è£é€£çµï¼Ÿã€</p>
<p>PMï¼šã€Œå°±æ˜¯é‚£å€‹æ–°ç‰ˆ App çš„å®‰è£é€£çµå•Šï½ã€èªªå®Œï¼Œçµ¦å°å”¯çœ‹ä»–æ‰‹æ©Ÿä¸Šçš„ç•«é¢ï¼š</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/BoxECeCH4sg" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>åŸä¾†è‡ªå¾å°å”¯åœ˜éšŠè½‰ç”¨ <a href="https://developer.android.com/platform/technology/app-bundle">Android App Bundle æŠ€è¡“</a> æ‰“åŒ…ç”¢å“å¾Œï¼Œç”±åŸæœ¬ç›´æ¥å‚³é€ APK ç™¼ä½ˆæ›´æ–°ï¼Œæ”¹ç‚ºä½¿ç”¨ <a href="https://play.google.com/console/about/internalappsharing/">Internal App Sharing</a> çš„æ–¹å¼ç™¼ä½ˆã€‚æ–°çš„ç™¼ä½ˆæ–¹å¼æœƒç”¢ç”Ÿä¸€å€‹å®‰è£ç”¨é€£çµï¼Œåœ¨æ‰‹æ©Ÿä¸Šé»æ“Šå¾Œï¼ŒGoogle Play æœƒè‡ªå‹•é–‹å•Ÿå®‰è£ç•«é¢ã€‚</p>
<p>é›–ç„¶è½èµ·ä¾†ç°¡å–®ç°¡å–®ï¼Œä½†æ˜¯ç”¨èµ·ä¾†çœŸæ˜¯å•é¡Œä¸æ–·ï¼Œå…¶ä¸­æœ€å¸¸è¦‹çš„å°±æ˜¯ä¸Šé¢é€™ç¨®ã€Œå…§éƒ¨æ‡‰ç”¨ç¨‹å¼åˆ†äº«åŠŸèƒ½å·²é—œé–‰ã€ï¼Œé€£çµé»é–‹å¾Œï¼Œè·³å‡ºä¸çŸ¥æ‰€è¬‚çš„è¨Šæ¯ ğŸ˜•ï¼ä¸ä½†è¨Šæ¯æ²’å¹«åŠ©ï¼Œä¸Šé¢çš„é€£çµæ›´æ˜¯æ²’å¹«åŠ©ï¼åªèƒ½èªª Google å·¥ç¨‹ã€æŠ€è¡“é‚è¼¯ä¸€æµï¼Œä½†äººæ€§åŒ–ä¸ŠçœŸæ˜¯æœ‰å¾…åŠ å¼· ğŸ¤–</p>
<h2 id="é–‹å•Ÿé—œéµé–‹é—œ"><a href="#é–‹å•Ÿé—œéµé–‹é—œ" class="headerlink" title="é–‹å•Ÿé—œéµé–‹é—œ"></a>é–‹å•Ÿé—œéµé–‹é—œ</h2><p>å…¶å¯¦ä¸Šè¿°çš„è¨Šæ¯ï¼Œåªæ˜¯æƒ³è¬›ä¸€ä»¶äº‹ï¼é€™ä½ PMï¼Œä½ æ²’æœ‰é–‹å•Ÿä¸€å€‹é—œéµé–‹é—œï¼</p>
<p>å°å”¯æ¥è‘—è§£é‡‹åˆ°ï¼Œè©²å¦‚ä½•é–‹å•Ÿï¼š</p>
<ol>
<li><p>é–‹å•Ÿ Google Play</p>
<img src="/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/1119_1.png" class="slug">
</li>
<li><p>é»é¸å·¦ä¸Šè§’çš„æ¼¢å ¡é¸å–®</p>
<img src="/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/1119_2.png" class="slug">
</li>
<li><p>æ‰¾åˆ°è¨­å®šï¼Œé»é–‹é€²å»</p>
<img src="/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/1119_3.png" class="slug">
</li>
<li><p>æ»‘åˆ°æœ€ä¸‹é¢ï¼Œæ‡‰è©²æœƒçœ‹åˆ°ã€ŒPlay å•†åº—ç‰ˆæœ¬ã€</p>
<img src="/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/1119_4.png" class="slug">
</li>
<li><p>é»å®ƒï¼Œä¸€ç›´é»åˆ°ã€Œä½ å·²å•Ÿç”¨é–‹ç™¼äººå“¡è¨­å®šã€çš„è¨Šæ¯è·³å‡º</p>
<img src="/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/1119_5.png" class="slug">
</li>
<li><p>æ¥è‘—æ‰¾åˆ°ã€Œå…§éƒ¨æ‡‰ç”¨ç¨‹å¼åˆ†äº«ã€ï¼Œé–‹å•Ÿå®ƒ</p>
<img src="/%E7%82%BA%E4%BB%80%E9%BA%BC-RD-%E7%B5%A6%E7%9A%84-Android-%E6%B8%AC%E8%A9%A6%E9%80%A3%E7%B5%90%E4%B8%8D%E8%83%BD%E7%94%A8%EF%BC%81/1119_6.png" class="slug">

</li>
</ol>
<p>å™¹å™¹ï½ æå®š</p>
<div class="note danger">
            <p>â€¼ï¸ ç‰¹åˆ¥æé†’ï¼Œé–‹å•Ÿå…§éƒ¨æ‡‰ç”¨ç¨‹å¼åˆ†äº«ï¼Œä»£è¡¨ä½ å¯ä»¥é€éé€£çµå®‰è£åˆ¥äººçš„ç¨‹å¼ã€‚æ‰€ä»¥å°å”¯é‚„æ˜¯è¦æé†’å„ä½ï¼Œä¸è¦é»é¸æˆ–å®‰è£ä½ ä¸çŸ¥é“çš„å®‰è£é€£çµï¼â€¼ï¸</p>
          </div>

<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-question-circle"></i> UI äººæ€§åŒ–æ¯”å¯¦è³ªåŠŸèƒ½æ›´é‡è¦å•Š -------------</p>
        </div>
    
</div>]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>ç‚ºä»€éº¼ Android è·³å‡ºæ–¹å¡Šé€šçŸ¥ï¼</title>
    <url>/%E8%B7%B3%E5%87%BA%E6%96%B9%E5%A1%8A%E7%9A%84-Android/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>è€çš®æ˜¯å°å”¯å…¬å¸è£¡çš„å¥½å‹ï¼Œå¹³å¸¸æœ€æ„›çš„å°±æ˜¯å·é–’çœ‹å¹¾æœ¬æ›¸ï¼Œå·¥ä½œä¼‘æ¯æ™‚ï¼Œå°±æœƒæ‹‰è‘—å°å”¯ï¼Œåˆ†äº«æœ€è¿‘åˆå¾æ›¸è£¡å­¸äº†å“ªæ‹›å“ªæ‹›ï¼Œæ‰¹è©•ä¸€ä¸‹å¸‚é¢ä¸Šç”¢å“ã€é›†åœ˜ç­–ç•¥â€¦ã€‚ä»Šå¤©ä¸€æ—©ï¼Œè€çš®ä¹Ÿæ˜¯å¾ˆèˆˆå¥®çš„è·‘ä¾†ï¼Œå°å”¯æœ¬ä»¥ç‚ºä»–åˆè¦è¬›æ›¸è£¡çš„å“ªæ‹›ï¼Œä½†æ²’æƒ³åˆ°è€çš®ç«Ÿç„¶æå‡ºä»–çš„ Pixel æ‰‹æ©Ÿï¼Œèªªé“ï¼šã€Œä½ çœ‹çœ‹ï¼Œæˆ‘æ”¶é›†åˆ°é€™éº¼å¤šçš„æ–¹å¡Šå’Œåœˆåœˆã€‚ã€</p>
<p>å°å”¯å¥½å¥‡å•ï¼šã€Œä»€éº¼ï¼ä»€éº¼æ–¹å¡Šå’Œåœˆåœˆã€</p>
<h2 id="App-é€šçŸ¥çš„-icon-ğŸŸ¥-ğŸ”µ-â¬›ï¸-ğŸŸ¤"><a href="#App-é€šçŸ¥çš„-icon-ğŸŸ¥-ğŸ”µ-â¬›ï¸-ğŸŸ¤" class="headerlink" title="App é€šçŸ¥çš„ icon ğŸŸ¥ ğŸ”µ â¬›ï¸ ğŸŸ¤"></a>App é€šçŸ¥çš„ icon ğŸŸ¥ ğŸ”µ â¬›ï¸ ğŸŸ¤</h2><p>è€çš®èˆˆå¥®åœ°æŒ‡è‘—ç•«é¢ä¸Šçš„æ–¹å¡Šå’Œåœˆåœˆï¼š</p>
<img src="/%E8%B7%B3%E5%87%BA%E6%96%B9%E5%A1%8A%E7%9A%84-Android/1120_1.png" class="slug" width="324" height="666">

<p>ã€Œé€™æ˜¯ä»€éº¼ï¼ï¼Ÿã€å°å”¯æ€è€ƒè‘— ğŸ¤”ï¼Œæ¥è‘—è€çš®æŠŠç•«é¢è§£é–ï¼Œå¾ç•«é¢ä¸Šæ–¹æ‹‰ä¸‹äº†é€šçŸ¥åˆ—è¡¨</p>
<img src="/%E8%B7%B3%E5%87%BA%E6%96%B9%E5%A1%8A%E7%9A%84-Android/1119_7.png" class="blah" width="324" height="666">

<p>ã€Œå–”ï½ åŸä¾†å¦‚æ­¤ã€å°å”¯æš—è‡ªèªªé“ã€‚è€çš®æ¥è‘—èªªï¼šã€Œé‚„æœ‰ status bar ä¸Šçš„æ–¹å¡Šå’Œåœˆåœˆï¼Œä¹Ÿå¾ˆæœ‰è¶£ï¼š</p>
<img src="/%E8%B7%B3%E5%87%BA%E6%96%B9%E5%A1%8A%E7%9A%84-Android/1119_8.png" class="blah" width="324">

<p>é€™è®“å°å”¯æœƒå¿ƒä¸€ç¬‘ï¼Œé€™æç¬‘çš„ App é€šçŸ¥æ–¹å¡Šå’Œåœˆåœˆä»–ä¹‹å‰ä¹Ÿé‡éã€‚å°å”¯è¨˜å¾—è‡ªå¾ Android 5 é–‹å§‹å¾Œï¼Œå°±æ‡‰ä½¿ç”¨å–®è‰²é€æ˜èƒŒæ™¯çš„é€šçŸ¥ iconï¼Œå¦‚æœç›´æ¥æ‹¿æ¡Œé¢ç”¨çš„ iconï¼Œæˆ–æ˜¯å…¶ä»–å…¨å½© iconï¼Œåªæœƒçœ‹åˆ°åƒä¸Šé¢æˆªåœ–ä¸€æ¨£ï¼Œç™½è‰²æˆ–é»‘è‰²ä¸€å¡Šä¸€å¡Šï¼Œå®Œå…¨ä¸çŸ¥é“æ˜¯å“ªå€‹ App ä¾†çš„é€šçŸ¥ã€‚</p>
<h2 id="è©²æ€éº¼åšâ”"><a href="#è©²æ€éº¼åšâ”" class="headerlink" title="è©²æ€éº¼åšâ”"></a>è©²æ€éº¼åšâ”</h2><p>é›–ç„¶ icon ä¸èƒ½ç”¨å…¨å½©çš„ï¼Œä½†æ˜¯ Android å…è¨±æˆ‘å€‘ä½¿ç”¨ä¸€å€‹å–®è‰²ï¼Œçµ¦ icon æ·»é»è‰²å½©ï¼Œä¸€èˆ¬é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¼æ¥­æˆ–ç”¢å“çš„å“ç‰Œè‰²ã€‚</p>
<p>æ‰€ä»¥æ­£ç¢ºæ­¥é©Ÿï¼š</p>
<ol>
<li><p>ä½¿ç”¨å–®è‰²é€æ˜èƒŒæ™¯çš„ icon å¦‚ä¸‹ï¼ŒAndroid ç³»çµ±æœƒè‡ªå‹•åœ¨ä¸€èˆ¬æ¨¡å¼ã€å¤œæ™šæ¨¡å¼ä¸­å¹«æˆ‘å€‘èª¿æ•´é¡è‰²ï¼š</p>
<img src="/%E8%B7%B3%E5%87%BA%E6%96%B9%E5%A1%8A%E7%9A%84-Android/1119_9.png" class="blah">
</li>
<li><p>ä½¿ç”¨ NotificationCompat.Builder çš„ <a href="https://developer.android.com/reference/androidx/core/app/NotificationCompat.Builder#setColor(int)">setColor</a> æŒ‡å®šæƒ³è¦ç”¨çš„å–®è‰²ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> NotificationCompat.Builder(context, <span class="string">&quot;channelId&quot;</span>)</span><br><span class="line">     .setContentTitle(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">     .setContentText(<span class="string">&quot;message&quot;</span>)</span><br><span class="line">     .setSmallIcon(R.drawable.ic_notify_icon)</span><br><span class="line">     .setColor(Color.RED)</span><br><span class="line">     .setContentIntent(pendingIntent).build();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>å·®ä¸å¤šå°±é€™æ¨£ï½ icon ä¹Ÿæ˜¯ç”¢å“çš„é–€é¢ï¼Œå…±æ˜¯ä½¿ç”¨åœ¨é–é »ä»‹é¢ä¸­ï¼Œç”¨ä¾†åˆ¤æ–·é€šçŸ¥ä¾†æºçš„æ–¹å¼ï¼Œæ‰€ä»¥é‚„æ˜¯éœ€è¦å¥½å¥½é—œæ³¨ä¸€ä¸‹å•Š ğŸ˜</p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-meh-rolling-eyes"></i> æˆ‘ä¹Ÿè¦ä¸€å€‹å¥½ icon -------------</p>
        </div>
    
</div>
]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>é—œæ–¼ Android æ†‘è­‰éæœŸ</title>
    <url>/%E9%97%9C%E6%96%BCAndroid%E6%86%91%E8%AD%89%E9%81%8E%E6%9C%9F/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>æœ€è¿‘ç¶²è·¯æ–°èåœ¨æµå‚³è‘—ä¸€ç¯‡ã€ŒAndroid ä½¿ç”¨è€…æ³¨æ„ï¼7.1.1 å‰èˆŠæ©Ÿå°‡ä¸èƒ½æ­£å¸¸ç€è¦½ç¶²é ã€ï¼Œå°å”¯çš„å…¬å¸ä¹Ÿå°æ­¤åœ¨åšä¸€äº›å¯èƒ½çš„æº–å‚™å‹•ä½œã€‚ä¹‹æ‰€ä»¥æœƒå°é€™è­°é¡Œé€™éº¼æ•æ„Ÿï¼Œæ­£æ˜¯å› ç‚ºä¸ä¹…å‰ï¼Œå°å”¯å…¬å¸æ‰å› ç‚º <a href="https://support.sectigo.com/articles/Knowledge/Sectigo-AddTrust-External-CA-Root-Expiring-May-30-2020">AddTrust External Root CA éæœŸ</a>ï¼Œæ›äº†è‡ªå·±ç¶²ç«™çš„ç°½ç½² root CA æ†‘è­‰ï¼Œé€ æˆåœ¨ Android 5 ä»¥ä¸‹çš„æ‰‹æ©Ÿï¼Œä½¿ç”¨ WebView æ™‚ç™¼ç”ŸéŒ¯èª¤â€¦</p>
<h2 id="ä¸å»ºè­°çš„è§£æ±ºè¾¦æ³•"><a href="#ä¸å»ºè­°çš„è§£æ±ºè¾¦æ³•" class="headerlink" title="ä¸å»ºè­°çš„è§£æ±ºè¾¦æ³•"></a>ä¸å»ºè­°çš„è§£æ±ºè¾¦æ³•</h2><p>å°å”¯å°é€™ä»¶äº‹ä»æ˜¯è¨˜æ†¶çŒ¶æ–°ï¼Œç•¶æ™‚çš„è§£æ±ºè¾¦æ³•æ˜¯ï¼ŒæŠŠæ–°æ†‘è­‰ä¸€èµ·æ‰“åŒ…é€² App ä¸­ï¼Œä½¿ç”¨ Android æ›´æ›¿ <a href="https://developer.android.com/reference/javax/net/ssl/X509TrustManager">X509TrustManager</a> çš„æ–¹å¼ï¼Œå°‡éœ€è¦å…è¨±é€£ç·šçš„æ†‘è­‰åŒ…é€²å»ã€‚</p>
<p>éç¨‹ä¸­ï¼Œæœ‰å€‹éŒ¯èª¤åšæ³•å€¼å¾—ä¸€æï¼Œå› ç‚ºç¶²è·¯ä¸Šæœƒæœå°‹åˆ°é€™ç¨®åšæ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// &quot;ä¿¡ä»»å…¨éƒ¨çš„&quot; X509TrustManager</span></span><br><span class="line"><span class="keyword">final</span> TrustManager[] tm =</span><br><span class="line">  <span class="keyword">new</span> TrustManager[] &#123;</span><br><span class="line">    <span class="keyword">new</span> X509TrustManager() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkClientTrusted</span><span class="params">(java.security.cert.X509Certificate[] chain, String authType)</span> <span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸åšäº‹å°±æ˜¯é»˜èªä¿¡ä»»</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkServerTrusted</span><span class="params">(java.security.cert.X509Certificate[] chain, String authType)</span> <span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸åšäº‹å°±æ˜¯é»˜èªä¿¡ä»»</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> java.security.cert.X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> java.security.cert.X509Certificate[] &#123;&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> SSLContext sslContext = SSLContext.getInstance(<span class="string">&quot;TLS&quot;</span>);</span><br><span class="line">sslContext.init(<span class="keyword">null</span>, tm, <span class="keyword">new</span> java.security.SecureRandom());</span><br><span class="line"><span class="keyword">final</span> SSLSocketFactory sslSocketFactory = sslContext.getSocketFactory();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æº–å‚™å»ºç«‹ OkHttpClient</span></span><br><span class="line">OkHttpClient.Builder builder = ...</span><br><span class="line">builder.sslSocketFactory(sslSocketFactory, (X509TrustManager) tm[<span class="number">0</span>]);</span><br><span class="line">OkHttpClient = builder.build();</span><br></pre></td></tr></table></figure>

<p>é€™æ˜¯ç¶²è·¯å¸¸è¦‹çš„åšæ³•ä¹‹ä¸€ï¼Œä¸å»ºè­°çš„åŸå› æ˜¯é‚„æ˜¯å®‰å…¨æ€§è€ƒé‡ï¼Œé»˜èªç›¸ä¿¡æ‰€æœ‰æ†‘è­‰æœƒè®“æƒ¡æ„ç¶²é æœ‰æ©Ÿå¯ä¹˜ã€‚</p>
<h2 id="æ›´å¥½çš„åšæ³•"><a href="#æ›´å¥½çš„åšæ³•" class="headerlink" title="æ›´å¥½çš„åšæ³•"></a>æ›´å¥½çš„åšæ³•</h2><p>å°å”¯åœ˜éšŠä½¿ç”¨çš„åšæ³•æ˜¯ï¼Œå»ºç«‹ä¸€å€‹å…¨æ–°çš„éˆç‹€ <code>X509TrustManager</code> å¦‚ä¸‹ï¼Œå®ƒæœƒå…ˆæª¢æŸ¥ Android ç³»çµ±æ†‘è­‰ï¼Œå†æª¢æŸ¥å…¬å¸çš„æ–°æ†‘è­‰ï¼Œé™¤æ­¤ä¹‹å¤–çš„ä¸€ç‡ä¸æ”¾è¡Œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomX509TrustManager</span> <span class="keyword">implements</span> <span class="title">X509TrustManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å»ºç«‹æ†‘è­‰éˆï¼Œæœƒä¾åºæª¢æŸ¥æ˜¯å¦ç¬¦åˆæ†‘è­‰</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> List&lt;X509TrustManager&gt; trustManagers;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> TrustManager[] getTrustManagers(KeyStore keyStore) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TrustManager[] &#123;<span class="keyword">new</span> CustomX509TrustManager(keyStore)&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CustomX509TrustManager</span><span class="params">(KeyStore keystore)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.trustManagers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">// åŠ å…¥åŸæœ¬çš„ TrustManager</span></span><br><span class="line">    <span class="keyword">this</span>.trustManagers.add(getDefaultTrustManager());</span><br><span class="line">    <span class="comment">// åŠ å…¥æŒ‡å®š keystore TrustManager</span></span><br><span class="line">    <span class="keyword">this</span>.trustManagers.add(getTrustManager(keystore));</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.trustManagers.add(trustManagerForCertificates(trustedCertificatesInputStream()));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      <span class="comment">// ç„¡æ³•æ·»åŠ æˆ‘å€‘è‡ªå·±çš„ certï¼Œä½¿ç”¨ç³»çµ±é è¨­çš„</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkClientTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (X509TrustManager trustManager : trustManagers) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        trustManager.checkClientTrusted(chain, authType);</span><br><span class="line">        <span class="keyword">return</span>; <span class="comment">// æœ‰å…¶ä¸­ä¸€å€‹ cert é€šéï¼Œå°±ç•¶ä½œé€šé</span></span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateException e) &#123;</span><br><span class="line">        <span class="comment">// é€™å€‹ä¸é€šéï¼Œæ›ä¸‹ä¸€å€‹</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> CertificateException(<span class="string">&quot;None of the TrustManagers trust this certificate chain&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkServerTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (X509TrustManager trustManager : trustManagers) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        trustManager.checkServerTrusted(chain, authType);</span><br><span class="line">        <span class="keyword">return</span>; <span class="comment">// æœ‰å…¶ä¸­ä¸€å€‹ cert é€šéï¼Œå°±ç•¶ä½œé€šé</span></span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateException e) &#123;</span><br><span class="line">        <span class="comment">// é€™å€‹ä¸é€šéï¼Œæ›ä¸‹ä¸€å€‹</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> CertificateException(<span class="string">&quot;None of the TrustManagers trust this certificate chain&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">    List&lt;X509Certificate&gt; certificates = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (X509TrustManager trustManager : trustManagers) &#123;</span><br><span class="line">      certificates.addAll(Arrays.asList(trustManager.getAcceptedIssuers()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> certificates.toArray(<span class="keyword">new</span> X509Certificate[<span class="number">0</span>]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> X509TrustManager <span class="title">getDefaultTrustManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getTrustManager(<span class="keyword">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> X509TrustManager <span class="title">getTrustManager</span><span class="params">(KeyStore keystore)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getTrustManager(TrustManagerFactory.getDefaultAlgorithm(), keystore);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åªå–å‡º keystore ä¸­ X509 TrustManager</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> X509TrustManager <span class="title">getTrustManager</span><span class="params">(String algorithm, KeyStore keystore)</span> </span>&#123;</span><br><span class="line">    TrustManagerFactory factory;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      factory = TrustManagerFactory.getInstance(algorithm);</span><br><span class="line">      factory.init(keystore);</span><br><span class="line">      List&lt;TrustManager&gt; trustManagerList = Arrays.asList(factory.getTrustManagers());</span><br><span class="line">      List&lt;X509TrustManager&gt; x509TrustManagerList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      <span class="keyword">if</span> (trustManagerList != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (TrustManager tm : trustManagerList) &#123;</span><br><span class="line">          <span class="keyword">if</span> (tm <span class="keyword">instanceof</span> X509TrustManager) &#123;</span><br><span class="line">            x509TrustManagerList.add((X509TrustManager) tm);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (x509TrustManagerList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x509TrustManagerList.get(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException | KeyStoreException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å°‡æŒ‡å®š InputStream çš„çš„æ†‘è­‰å»ºæˆ TrustManager</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> X509TrustManager <span class="title">trustManagerForCertificates</span><span class="params">(InputStream in)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> GeneralSecurityException </span>&#123;</span><br><span class="line">    CertificateFactory certificateFactory = CertificateFactory.getInstance(<span class="string">&quot;X.509&quot;</span>);</span><br><span class="line">    Collection&lt;? extends Certificate&gt; certificates = certificateFactory.generateCertificates(in);</span><br><span class="line">    <span class="keyword">if</span> (certificates.isEmpty()) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Unexpected empty InputStream&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»ºç«‹ keystore</span></span><br><span class="line">    <span class="keyword">char</span>[] password = <span class="string">&quot;password&quot;</span>.toCharArray(); <span class="comment">// Any password will work.</span></span><br><span class="line">    KeyStore keyStore = newEmptyKeyStore(password);</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Certificate certificate : certificates) &#123;</span><br><span class="line">      String certificateAlias = Integer.toString(index++);</span><br><span class="line">      keyStore.setCertificateEntry(certificateAlias, certificate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ keystore å»ºç«‹ TrustManager</span></span><br><span class="line">    KeyManagerFactory keyManagerFactory =</span><br><span class="line">        KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());</span><br><span class="line">    keyManagerFactory.init(keyStore, password);</span><br><span class="line">    TrustManagerFactory trustManagerFactory =</span><br><span class="line">        TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());</span><br><span class="line">    trustManagerFactory.init(keyStore);</span><br><span class="line">    List&lt;TrustManager&gt; trustManagerList = Arrays.asList(trustManagerFactory.getTrustManagers());</span><br><span class="line">    List&lt;X509TrustManager&gt; x509TrustManagerList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (trustManagerList != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (TrustManager tm : trustManagerList) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tm <span class="keyword">instanceof</span> X509TrustManager) &#123;</span><br><span class="line">          x509TrustManagerList.add((X509TrustManager) tm);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x509TrustManagerList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> x509TrustManagerList.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> KeyStore <span class="title">newEmptyKeyStore</span><span class="params">(<span class="keyword">char</span>[] password)</span> <span class="keyword">throws</span> GeneralSecurityException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());</span><br><span class="line">      InputStream in = <span class="keyword">null</span>; <span class="comment">// By convention, &#x27;null&#x27; creates an empty key store.</span></span><br><span class="line">      keyStore.load(in, password);</span><br><span class="line">      <span class="keyword">return</span> keyStore;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> InputStream <span class="title">trustedCertificatesInputStream</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ†‘è­‰ä¹Ÿèƒ½æ”¾åœ¨ resource å…§ï¼Œdemo æ”¾é€™å®¹æ˜“çœ‹</span></span><br><span class="line">    String cert =</span><br><span class="line">        <span class="string">&quot;&quot;</span></span><br><span class="line">            + <span class="string">&quot;-----BEGIN CERTIFICATE-----\n&quot;</span></span><br><span class="line">            <span class="comment">// æ†‘è­‰å…§å®¹æ”¾é€™</span></span><br><span class="line">            + <span class="string">&quot;-----END CERTIFICATE-----\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Buffer().writeUtf8(cert).inputStream();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šå¾ <a href="https://square.github.io/okhttp/https/#customizing-trusted-certificates-kt-java">https://square.github.io/okhttp/https/#customizing-trusted-certificates-kt-java</a> è®ŠåŒ–è€Œä¾†</p>
<h2 id="å…¶ä»–åšæ³•"><a href="#å…¶ä»–åšæ³•" class="headerlink" title="å…¶ä»–åšæ³•"></a>å…¶ä»–åšæ³•</h2><p>å°å”¯ä¹‹å¾Œåˆç™¼ç¾ï¼Œokhttp å®˜æ–¹ github ä¹Ÿæœ‰é¡ä¼¼çš„ sampleï¼Œä¹‹å¾Œä¹Ÿè¨±ä¹Ÿèƒ½è©¦è©¦</p>
<p><a href="https://github.com/square/okhttp/blob/master/samples/guide/src/main/java/okhttp3/recipes/CustomTrust.java">okhttp å®˜æ–¹ github CustomTrust.java</a></p>
<h2 id="é—œæ–¼-Android-7-1-1"><a href="#é—œæ–¼-Android-7-1-1" class="headerlink" title="é—œæ–¼ Android 7.1.1"></a>é—œæ–¼ Android 7.1.1</h2><p>è‡³æ–¼ Android 7.1.1 ç‰ˆæœ¬ä¹‹å‰çš„è£ç½®å‘¢ï¼Ÿå› ç‚ºè¨±å¤šç¶²ç«™ç°½ç½²çš„æ†‘è­‰å³å°‡åˆ°æœŸï¼Œå‹¢å¿…æœƒæ›æˆæ–°çš„æ†‘è­‰ï¼Œé€ æˆèˆŠæ©Ÿ WebView æˆ–ç€è¦½å™¨å¯èƒ½ä¸æ”¯æ´æ–°çš„æ†‘è­‰ï¼Œè§£æ±ºæ–¹æ³•é‚„æ˜¯å»ºè­°æ›´æ–°ç³»çµ±ï¼ˆå¦‚æœå¯ä»¥çš„è©±ï¼‰ï¼Œè¦ä¸å°±æ˜¯ App è¦æº–å‚™è™•ç†éæœŸæ†‘è­‰çš„éŒ¯èª¤ï¼Œé©æ™‚æé†’ä½¿ç”¨è€…æ†‘è­‰å•é¡Œï¼Œä»¥åŠå»ºè­°çš„è§£æ±ºæ–¹å¼ï¼Œé¿å…ä¸€é–‹å•Ÿç¶²é å°±é‡åˆ°ä¸€ç‰‡ç©ºç™½ï¼Œç”šè‡³ App å¼·åˆ¶é—œé–‰ ğŸ˜–</p>
<p>å¦ä¸€å€‹å°å”¯åœ¨æ€ç´¢çš„äº‹æƒ…æ˜¯ï¼Œéè‡ªå·±ç”¢å“çš„ç›¸é—œçš„ç¶²é ï¼Œæ˜¯å¦è©²ç”¨ WebView é–‹å•Ÿï¼Ÿåš´æ ¼ä¾†èªªå…¶å¯¦ä¸æ‡‰è©²ï¼Œå› ç‚ºä¸æ¸…æ¥šå…¶ä»–äººæœƒåœ¨ç›¸é—œç¶²é å…§ï¼Œåšä»€éº¼äº‹æƒ…ï¼Œå°¤å…¶æ™‚ç•¶é–‹å•Ÿ JavaScript å¾Œï¼Œé€™å€‹å•é¡Œæ›´å€¼å¾—æ‰€æœ‰ç”¨ App WebView å»é–‹å•Ÿç¬¬ä¸‰æ–¹ç¶²é çš„åœ˜éšŠå»æ€ç´¢ï½</p>
<hr>
<p><strong>ç›¸é—œé€£çµï¼š</strong><a href="https://gist.github.com/HughJeffner/6eac419b18c6001aeadb"><i class="fab fa-github"></i> CompositeTrustManager</a>, <a href="https://square.github.io/okhttp/https/#customizing-trusted-certificates-kt-java"><i class="fas fa-code"></i> okhttp customizing trusted certificates</a>, <a href="https://square.github.io/okhttp/https/#customizing-trusted-certificates-kt-java"><i class="fab fa-github"></i> okhttp customizing trusted certificates</a></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-question-circle"></i> App minSdkVersion åˆ°åº•ä»€éº¼æ™‚å€™æ‰èƒ½æå‡å•Š -------------</p>
        </div>
    
</div>
]]></content>
      <categories>
        <category>å°å”¯çš„æ•…äº‹</category>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œåç¿¼æ£„å…µã€æ˜¯å¦‚ä½•èªªæ•…äº‹ - é¶å¿ƒäººå…¬å¼</title>
    <url>/%E9%9D%B6%E5%BF%83%E4%BA%BA%E5%85%AC%E5%BC%8F%E8%88%87%E5%90%8E%E7%BF%BC%E6%A3%84%E5%85%B5/</url>
    <content><![CDATA[<h2 id="å‰è¨€æ•…äº‹"><a href="#å‰è¨€æ•…äº‹" class="headerlink" title="å‰è¨€æ•…äº‹"></a>å‰è¨€æ•…äº‹</h2><p>æœ€è¿‘å¾ˆç«ç†±çš„ Netflix å½±é›†ã€Œåç¿¼æ£„å…µã€ï¼Œè€çš®çµ‚æ–¼ä¹Ÿåœ¨é€±æœ«æ™‚è¶æœ‰ç©ºæ™‚ï¼Œçœ‹å®Œäº†æ•´éƒ¨åŠ‡ã€‚èªªä¾†ä¹Ÿå‰›å¥½ï¼Œè€çš®æœ€è¿‘ä¹Ÿè®€äº†è¨±æ¦®å“²è€å¸«çš„ã€Œ3åˆ†é˜èªª18è¬å€‹æ•…äº‹ã€ï¼Œæ‰€ä»¥å½±é›†ä¸€çµæŸï¼Œè€çš®ç«‹åˆ»æ‹¿èµ·ç´™ç­†ï¼Œè©¦è‘—å°‡æ•…äº‹èª²ä¸­çš„æŠ€å·§ï¼Œé‡å°å½±ç‰‡å»åšä¸€å€‹åˆ†æï¼Œè¿«ä¸åŠå¾…çš„æƒ³é©—è­‰ï¼Œå¦‚æ­¤å¥½çœ‹çš„å½±é›†ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿéƒ½æ˜¯æ‰€è¬‚çš„å¥—è·¯ï½</p>
<h2 id="é¶å¿ƒäººå…¬å¼"><a href="#é¶å¿ƒäººå…¬å¼" class="headerlink" title="é¶å¿ƒäººå…¬å¼"></a>é¶å¿ƒäººå…¬å¼</h2><p>ä¾ç…§è¨±æ¦®å“²è€å¸«çš„ä»‹ç´¹ï¼Œæ‰€æœ‰éš±è—åœ¨æ•…äº‹è£¡çš„å…§åœ¨é‚è¼¯ï¼Œéƒ½æœ‰ä¸€å¼µå¤§åŒå°ç•°çš„ç›¸ä¼¼è‡‰å­”ã€‚é€™ä¹Ÿå°±æ˜¯ã€Œé¶å¿ƒäººå…¬å¼ã€çš„åŸºæœ¬å¥—è·¯ï¼Œä¹Ÿå«åšçš„ã€Œä¸ƒå€‹å•é¡Œçš„æ•…äº‹å…¬å¼ã€ï¼Œä¾ç…§é€™å€‹å¥—è·¯ï¼Œå°‡é€™äº›å…§åœ¨é‚è¼¯ï¼Œåˆ†è§£æˆä¸ƒå€‹éƒ¨åˆ†ï¼š</p>
<ol>
<li><p>ä¸»äººç¿çš„ã€Œç›®æ¨™ã€æ˜¯ä»€éº¼ï¼Ÿ</p>
</li>
<li><p>ä»–çš„ã€Œé˜»ç¤™ã€æ˜¯ä»€éº¼ï¼Ÿ</p>
</li>
<li><p>ä»–å¦‚ä½•ã€ŒåŠªåŠ›ã€ï¼Ÿ</p>
</li>
<li><p>ã€Œçµæœã€å¦‚ä½•ï¼Ÿï¼ˆé€šå¸¸æ˜¯ä¸å¥½çš„çµæœã€‚ï¼‰</p>
</li>
<li><p>å¦‚æœçµæœä¸ç†æƒ³ï¼Œä»£è¡¨åŠªåŠ›ç„¡æ•ˆï¼Œé‚£éº¼ï¼Œæœ‰è¶…è¶ŠåŠªåŠ›çš„ã€Œæ„å¤–ã€å¯ä»¥æ”¹è®Šé€™ä¸€åˆ‡å—ï¼Ÿ</p>
</li>
<li><p>æ„å¤–ç™¼ç”Ÿï¼Œæƒ…ç¯€æœƒå¦‚ä½•ã€Œè½‰å½ã€ï¼Ÿ</p>
</li>
<li><p>æœ€å¾Œçš„ã€Œçµå±€ã€æ˜¯ä»€éº¼ï¼Ÿ</p>
</li>
</ol>
<p>é‚£å¦‚æœå¥—ç”¨åœ¨ã€Œåç¿¼æ£„å…µã€ä¸Šï¼Ÿæœƒæ˜¯æ€æ¨£å‘¢ï¼Ÿè€çš®è©¦è‘—å›ç­”é€™ä¸ƒå€‹å•é¡Œã€‚</p>
<h3 id="1-ä¸»äººç¿çš„ã€Œç›®æ¨™ã€æ˜¯ä»€éº¼ï¼Ÿ"><a href="#1-ä¸»äººç¿çš„ã€Œç›®æ¨™ã€æ˜¯ä»€éº¼ï¼Ÿ" class="headerlink" title="1. ä¸»äººç¿çš„ã€Œç›®æ¨™ã€æ˜¯ä»€éº¼ï¼Ÿ"></a>1. ä¸»äººç¿çš„ã€Œç›®æ¨™ã€æ˜¯ä»€éº¼ï¼Ÿ</h3><p>ä¸»äººå…¬è²çµ²ï¼Œä¸€å ´æ„å¤–ä½¿å¥¹æˆç‚ºå­¤å…’ï¼Œè¢«é€åˆ°ä¸€æ‰€å­¤å…’é™¢ã€‚åœ¨å­¤å…’é™¢ä¸­ï¼Œå·¥å‹è–›æ³¢å…ˆç”Ÿå¸¶è‘—è²çµ²æ¥è§¸äº†è¥¿æ´‹æ£‹ï¼Œéš¨å³è²çµ²å±•ç¾äº†é©šäººçš„å¤©è³¦ï¼Œå¾å®Œå…¨ä¸æ‡‚è¥¿æ´‹æ£‹ï¼Œåˆ°æ²’å¤šä¹…å°±è¼•é¬†æ“Šæ•—è–›æ³¢å…ˆç”Ÿã€é™„è¿‘å­¸æ ¡çš„è¥¿æ´‹æ£‹æŒ‡å°è€å¸«ç­‰ã€‚éš¨è‘—åŠ‡æƒ…ä¹‹å¾Œè¢«è‰¾ç‘ªé ˜é¤Šï¼Œé–‹å§‹æ¥è§¸äº†æ›´å¤§çš„è¥¿æ´‹æ£‹è³½ä¸–ç•Œï¼Œç›®æ¨™æ˜¯èˆ‡é ‚å°–çš„è¥¿æ´‹æ£‹æ‰‹å°å¼ˆï¼Œä¸¦å–å¾—ç²å‹ã€‚</p>
<h3 id="2-ä»–çš„ã€Œé˜»ç¤™ã€æ˜¯ä»€éº¼ï¼Ÿ"><a href="#2-ä»–çš„ã€Œé˜»ç¤™ã€æ˜¯ä»€éº¼ï¼Ÿ" class="headerlink" title="2. ä»–çš„ã€Œé˜»ç¤™ã€æ˜¯ä»€éº¼ï¼Ÿ"></a>2. ä»–çš„ã€Œé˜»ç¤™ã€æ˜¯ä»€éº¼ï¼Ÿ</h3><p>å¾ä¸€é–‹å§‹çš„ç„¡ç©åˆ†æ£‹å£«ï¼Œè²çµ²æ˜¯æ²’æœ‰è³‡æ ¼èˆ‡é«˜ç­‰æ£‹å£«å°å¼ˆï¼Œå¥¹å¿…é ˆä¸€è·¯å–å¾—å‹åˆ©ï¼Œç²å¾—ç©åˆ†ï¼Œæ‰èƒ½èˆ‡æ›´é«˜æ®µä½çš„æ£‹å£«å°å¼ˆï¼Œå¾åœ°å€çš„å·å† å±…ã€å„è¯è³½å† å±…ã€å…¨ç¾å† è»ï¼Œæ¥è‘—æ‰èƒ½ç²å¾—èˆ‡ä¸–ç•Œå† è»å°å¼ˆçš„è³‡æ ¼ã€‚</p>
<h3 id="3-ä»–å¦‚ä½•ã€ŒåŠªåŠ›ã€ï¼Ÿ"><a href="#3-ä»–å¦‚ä½•ã€ŒåŠªåŠ›ã€ï¼Ÿ" class="headerlink" title="3. ä»–å¦‚ä½•ã€ŒåŠªåŠ›ã€ï¼Ÿ"></a>3. ä»–å¦‚ä½•ã€ŒåŠªåŠ›ã€ï¼Ÿ</h3><p>è²çµ²é™¤äº†å¤©ç”Ÿçš„æ£‹è—å¤–ï¼Œè‡ªå·±å°è¥¿æ´‹æ£‹è·¯çš„æ¸´æ±‚ï¼Œä¹Ÿé©…ä½¿å¥¹ä¸æ–·çš„é€²æ­¥ï¼Œå¾ä¸€é–‹å§‹åœ¨åœ°ä¸‹å®¤èˆ‡å·¥å‹è–›æ³¢å…ˆç”Ÿçš„å°å¼ˆï¼Œåˆ°å·ã€å…¨ç¾è³½äº‹ï¼Œå°å‹åˆ©çš„æ¸´æ±‚éƒ½é©…ä½¿å¥¹ä¸æ–·ç²¾é€²è‡ªå·±çš„æ£‹è—ï¼Œç”šè‡³è—‰ç”±é…’ç²¾è—¥ç‰©ï¼Œè®“è‡ªå·±çš„ç²¾ç¥æ›´ç‚ºå°ˆæ³¨çš„æ€è€ƒæ£‹å±€ï¼ˆå¤©èŠ±æ¿ä¸­çš„ç§»å‹•æ£‹è·¯ï¼‰ã€‚</p>
<h3 id="4-ã€Œçµæœã€å¦‚ä½•ï¼Ÿ"><a href="#4-ã€Œçµæœã€å¦‚ä½•ï¼Ÿ" class="headerlink" title="4.ã€Œçµæœã€å¦‚ä½•ï¼Ÿ"></a>4.ã€Œçµæœã€å¦‚ä½•ï¼Ÿ</h3><p>è²çµ²å…©åº¦ç²å¾—èˆ‡ä¸–ç´€ç¬¬ä¸€çš„è˜‡è¯æ£‹å£«åšæˆˆå¤«äº¤æ‰‹çš„æ©Ÿæœƒï¼Œå»éƒ½å¤§æ•—è€Œæ­¸ï¼Œå°¤å…¶æ˜¯åœ¨å·´é»çš„é‚£ä¸€å±€ï¼Œè²çµ²æ›´æ˜¯å—åˆ°éåº¦çš„é…’ç²¾å½±éŸ¿ï¼Œåœ¨å®¿é†‰çš„ç‹€æ…‹ä¸‹èˆ‡åšæˆˆå¤«å°å¼ˆã€‚é€™ä¸€å ´è®“è²æ–¯å¤§å—æ‰“æ“Šï¼Œå³ä½¿å›åœ‹å¾Œï¼Œä»å°é–‰è‡ªå·±èˆ‡éå¾€å¹«åŠ©éä»–çš„äººï¼Œæ•´æ—¥èˆ‡é…’ç²¾è—¥ç‰©ç‚ºä¼ã€‚</p>
<h3 id="5-æœ‰è¶…è¶ŠåŠªåŠ›çš„ã€Œæ„å¤–ã€å¯ä»¥æ”¹è®Šé€™ä¸€åˆ‡å—ï¼Ÿ"><a href="#5-æœ‰è¶…è¶ŠåŠªåŠ›çš„ã€Œæ„å¤–ã€å¯ä»¥æ”¹è®Šé€™ä¸€åˆ‡å—ï¼Ÿ" class="headerlink" title="5. æœ‰è¶…è¶ŠåŠªåŠ›çš„ã€Œæ„å¤–ã€å¯ä»¥æ”¹è®Šé€™ä¸€åˆ‡å—ï¼Ÿ"></a>5. æœ‰è¶…è¶ŠåŠªåŠ›çš„ã€Œæ„å¤–ã€å¯ä»¥æ”¹è®Šé€™ä¸€åˆ‡å—ï¼Ÿ</h3><p>æœ‰ä¸€å¤©ï¼Œè²çµ²å®¶çš„é–€è¢«æ•²éŸ¿äº†ï¼Œé–‹äº†é–€æ„å¤–çš„æ˜¯æ•²é–€ä¹‹äººæ­£æ˜¯è²çµ²åœ¨å­¤å…’é™¢ä¸­çš„å¥½å‹å–¬ç³ã€‚èˆ‡è¨±ä¹…ä¸è¦‹çš„å¥½å‹å†åº¦ç›¸è¦‹ï¼Œè²çµ²é †é–“ç¨å¾®é†’äº†éä¾†ï¼Œå¾—çŸ¥å–¬ç³é›¢é–‹å­¤å…’é™¢å¾Œï¼Œåˆ°ç¾åœ¨æˆå°±èˆ‡ç¶“æ­·ï¼Œè²çµ²å¾ˆæ˜¯é–‹å¿ƒï¼Œä½†çœŸæ­£è®“è²çµ²é†’éä¾†çš„æ˜¯ï¼Œå­¤å…’é™¢å·¥å‹è–›æ³¢å…ˆç”Ÿçš„æ­»è¨Šã€‚</p>
<h3 id="6-æ„å¤–ç™¼ç”Ÿï¼Œæƒ…ç¯€æœƒå¦‚ä½•ã€Œè½‰å½ã€ï¼Ÿ"><a href="#6-æ„å¤–ç™¼ç”Ÿï¼Œæƒ…ç¯€æœƒå¦‚ä½•ã€Œè½‰å½ã€ï¼Ÿ" class="headerlink" title="6. æ„å¤–ç™¼ç”Ÿï¼Œæƒ…ç¯€æœƒå¦‚ä½•ã€Œè½‰å½ã€ï¼Ÿ"></a>6. æ„å¤–ç™¼ç”Ÿï¼Œæƒ…ç¯€æœƒå¦‚ä½•ã€Œè½‰å½ã€ï¼Ÿ</h3><p>å–¬ç³å¸¶è‘—è²çµ²å»äº†è–›æ³¢å…ˆç”Ÿçš„éˆå‰ï¼Œè²çµ²çš„å¿ƒå½·å½¿åˆå›åˆ°äº†åœ¨å­¤å…’é™¢æ™‚æœŸï¼Œå†åº¦å›åˆ°å­¤å…’é™¢ï¼Œé€™è£¡çš„ä¸€åˆ‡è®“ä»–æ„Ÿæ…¨ä¸å·²ï¼Œèµ°å…¥æ›¾ç¶“èˆ‡è–›æ³¢å…ˆç”Ÿä¸€èµ·å°å¼ˆçš„åœ°ä¸‹å®¤ï¼Œè²çµ²çœ‹åˆ°çš„æ˜¯ç‰†ä¸Šï¼Œå¾å ±ç´™ã€é›œèªŒä¸Šä¸€ç¯‡ç¯‡å‰ªè²¼ä¸‹ä¾†ï¼Œæ‰€æœ‰é—œæ–¼è‡ªå·±çš„å ±å°ã€‚åŸä¾†è–›æ³¢å…ˆç”Ÿå°±ç®—åœ¨è²çµ²é›¢é–‹å­¤å…’é™¢å¾Œï¼Œä»æ˜¯é—œæ³¨å¥¹çš„æ‰€æœ‰è¥¿æ´‹æ£‹è³½äº‹ã€‚è²çµ²å¾ç‰†ä¸Šæ‹¿ä¸‹ä¾†ä¸€å¼µç…§ç‰‡ï¼Œé‚£å¼µç…§ç‰‡æ˜¯è–›æ³¢å…ˆç”Ÿç‰¹åœ°å¾é™„è¿‘ä¸­å­¸è«‹ä¾†çš„è¥¿æ´‹æ£‹æŒ‡å°è€å¸«ï¼Œåœ¨åœ°ä¸‹å®¤å¹«ä»–å€‘æ‹ä¸‹ä¾†çš„åˆç…§ã€‚å›åˆ°å–¬ç³çš„è»Šä¸Šï¼Œé€™ä¸€åˆ‡è®“è²çµ²å¤§å“­äº†èµ·ä¾†ï¼Œå¾é€™é‚£ä¸€åˆ»èµ·ï¼Œè²çµ²æœ‰è½‰è®Šäº†ã€‚</p>
<h3 id="7-æœ€å¾Œçš„ã€Œçµå±€ã€æ˜¯ä»€éº¼ï¼Ÿ"><a href="#7-æœ€å¾Œçš„ã€Œçµå±€ã€æ˜¯ä»€éº¼ï¼Ÿ" class="headerlink" title="7. æœ€å¾Œçš„ã€Œçµå±€ã€æ˜¯ä»€éº¼ï¼Ÿ"></a>7. æœ€å¾Œçš„ã€Œçµå±€ã€æ˜¯ä»€éº¼ï¼Ÿ</h3><p>å›åˆ°å®¶ä¸­å¾Œï¼Œè²çµ²ä¸å†é…’ç²¾æ‰€å›°ï¼Œå››è™•ç±Œé›†è³‡é‡‘å‰å¾€è«æ–¯ç§‘èˆ‡è˜‡è¯è¥¿æ´‹æ£‹é«˜æ‰‹å†æˆ°ï¼Œå¥¹æ“ºè„«äº†é…’ç²¾èˆ‡è—¥ç‰©ï¼Œåœ¨å¥½å‹å€‘çš„æ”¯æŒèˆ‡å”åŠ©ä¸‹ï¼Œèˆ‡åšæˆˆå¤«åšæœ€æ±ºè³½çš„å°å¼ˆï¼Œè²çµ²æ“Šæ•—äº†åšæˆˆå¤«ï¼Œå–å¾—äº†å‹åˆ©ã€‚è³½å¾Œï¼Œè²çµ²ç”©é–‹äº†è·Ÿéš¨äººå“¡ï¼Œç¨è‡ªä¸€äººåœ¨è«æ–¯ç§‘å…¬åœ’ä¸­æ•£æ­¥ï¼Œèµ°åˆ°äº†å…¬åœ’è€å¹´äººèšé›†çš„è¥¿æ´‹æ£‹æ¡Œå€ï¼Œå°±åƒç•¶å¹´èˆ‡è–›æ³¢å…ˆç”Ÿå°å¼ˆä¸€èˆ¬ï¼Œè²çµ²èˆ‡å°æ–¹æ“ºé–‹äº†æ£‹å±€â€¦</p>
<h2 id="æ›´å¤šçš„å¯èƒ½æ€§"><a href="#æ›´å¤šçš„å¯èƒ½æ€§" class="headerlink" title="æ›´å¤šçš„å¯èƒ½æ€§"></a>æ›´å¤šçš„å¯èƒ½æ€§</h2><p>è€çš®å¾ˆèˆˆå¥®ï¼Œé€™è­‰æ˜äº†è¨±æ¦®å“²è€å¸«èªªçš„ï¼Œæ‰€æœ‰çš„å¥½æ•…äº‹éƒ½æœ‰å¥—è·¯çš„ã€‚è€Œä¸”ä»¥ä¸Šçš„ã€Œé¶å¿ƒäººå…¬å¼ã€åªæ˜¯åŸºæœ¬å¥—è·¯ï¼Œé‚„æœ‰å…¶ä»–18è¬ç¨®è®ŠåŒ–çš„å¯èƒ½æ€§ï½ ğŸ¤©</p>
<hr>
<p><strong>ç›¸é—œé€£çµï¼š</strong></p>
<img src="/%E9%9D%B6%E5%BF%83%E4%BA%BA%E5%85%AC%E5%BC%8F%E8%88%87%E5%90%8E%E7%BF%BC%E6%A3%84%E5%85%B5/book.jpeg" class="book cover">
<p><a href="https://tpml.gov.taipei/News_Content.aspx?n=D4B1C88D10A4B867&s=B6F2F362D2B63DD7">æ•…äº‹èª²ï¼š3åˆ†é˜èªª18è¬å€‹æ•…äº‹ï¼Œæ‰“é€ å½±éŸ¿åŠ›</a><br><br/></p>
<div>
    
        <div style="text-align:left;font-size:1em;">
<p style="text-align:center;color: #ccc;">------------- æœ¬æ–‡ç»“æŸ <i class="far fa-question-circle"></i> æ”¹å¤©ä¹Ÿè¦ä¾†ç©è¥¿æ´‹æ£‹ -------------</p>
        </div>
    
</div>]]></content>
      <categories>
        <category>è€çš®çš„æ•…äº‹</category>
        <category>è®€æ›¸å¿ƒå¾—</category>
      </categories>
      <tags>
        <tag>è®€æ›¸å¿ƒå¾—</tag>
      </tags>
  </entry>
</search>
